{"version":3,"file":"webPlay.js","sources":["../../../../../../packages/extension/WhichWay/src/audio/webPlay.ts"],"sourcesContent":["import { whichWayUtil } from \"../utill.js\";\r\nimport { whichWayAudio } from \"./index.ts\";\r\nimport { whichWayToast } from \"../toast/index.ts\";\r\n\r\nexport class whichWayWebPlay {\r\n\t/**\r\n\t * 创建webPlay组件\r\n\t * @param {string} skill 配音技能名\r\n\t * @param {string} char 角色名\r\n\t * @param {string[]} [voices] 配音标题\r\n\t */\r\n\tconstructor(skill: string, char: string, voices: string[] = []) {\r\n\t\tthis.skill = skill;\r\n\t\tthis.char = char;\r\n\t\tthis.voicesTitle = voices.length > 0 ? voices : this.randomGetVoicesTilte();\r\n\t}\r\n\t/**\r\n\t * PRTS路径\r\n\t */\r\n\tresourceUrl: string = `https://torappu.prts.wiki/`;\r\n\tskill: string;\r\n\tchar: string;\r\n\tvoicesTitle: string[] = [];\r\n\tdefaultVoicesTitle: string[] = [\"选中干员1\", \"选中干员2\", \"部署1\", \"部署2\", \"作战中1\", \"作战中2\", \"作战中3\", \"作战中4\"];\r\n\r\n\tget useLocalAudio(): boolean {\r\n\t\treturn whichWayUtil.config(\"useLocalAudio\") || false;\r\n\t}\r\n\r\n\tget lang(): string {\r\n\t\treturn whichWayAudio.getSkillLang(this.skill, this.char);\r\n\t}\r\n\r\n\tget voiceUrl(): string[] {\r\n\t\treturn this.voicesTitle.map(title => whichWayAudio.compileVoicePath(this.char, this.lang, title));\r\n\t}\r\n\r\n\tget autoDownloadAudio():boolean {\r\n\t\treturn whichWayUtil.config(\"autoDownloadAudio\") || false;\r\n\t}\r\n\r\n\tplay(): HTMLAudioElement {\r\n\t\tconst audio = new Audio(this.voiceUrl.randomGet());\r\n\t\taudio.play();\r\n\r\n\t\tif (!whichWayUtil.config(\"noTipUseWeb\")) {\r\n\t\t\twhichWayToast.showToast(`[驶舰之向] 正在使用网络!`);\r\n\t\t}\r\n\r\n\t\tif(this.autoDownloadAudio){\r\n\t\t\twhichWayAudio.downloadAudio(this.skill,this.char,this.voiceUrl,this.lang);\r\n\t\t}\r\n\r\n\t\treturn audio;\r\n\t}\r\n\r\n\trandomGetVoicesTilte(): string[] {\r\n\t\tconst audioConfig = window.whichWaySave.audioConfig;\r\n\t\tif (audioConfig.onlineVoicesTitle[this.skill]) return audioConfig.onlineVoicesTitle[this.skill];\r\n\t\tlet titles = this.defaultVoicesTitle.randomGets(2);\r\n\t\taudioConfig.onlineVoicesTitle[this.skill] = titles;\r\n\t\treturn titles;\r\n\t}\r\n}\r\n"],"names":[],"mappings":";;;AAIO,MAAM,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAO5B,YAAY,OAAe,MAAc,SAAmB,CAAA,GAAI;AAC/D,SAAK,QAAQ;AACb,SAAK,OAAO;AACZ,SAAK,cAAc,OAAO,SAAS,IAAI,SAAS,KAAK,qBAAA;AAAA,EACtD;AAAA;AAAA;AAAA;AAAA,EAIA,cAAsB;AAAA,EACtB;AAAA,EACA;AAAA,EACA,cAAwB,CAAA;AAAA,EACxB,qBAA+B,CAAC,SAAS,SAAS,OAAO,OAAO,QAAQ,QAAQ,QAAQ,MAAM;AAAA,EAE9F,IAAI,gBAAyB;AAC5B,WAAO,aAAa,OAAO,eAAe,KAAK;AAAA,EAChD;AAAA,EAEA,IAAI,OAAe;AAClB,WAAO,cAAc,aAAa,KAAK,OAAO,KAAK,IAAI;AAAA,EACxD;AAAA,EAEA,IAAI,WAAqB;AACxB,WAAO,KAAK,YAAY,IAAI,CAAA,UAAS,cAAc,iBAAiB,KAAK,MAAM,KAAK,MAAM,KAAK,CAAC;AAAA,EACjG;AAAA,EAEA,IAAI,oBAA4B;AAC/B,WAAO,aAAa,OAAO,mBAAmB,KAAK;AAAA,EACpD;AAAA,EAEA,OAAyB;AACxB,UAAM,QAAQ,IAAI,MAAM,KAAK,SAAS,WAAW;AACjD,UAAM,KAAA;AAEN,QAAI,CAAC,aAAa,OAAO,aAAa,GAAG;AACxC,oBAAc,UAAU,gBAAgB;AAAA,IACzC;AAEA,QAAG,KAAK,mBAAkB;AACzB,oBAAc,cAAc,KAAK,OAAM,KAAK,MAAK,KAAK,UAAS,KAAK,IAAI;AAAA,IACzE;AAEA,WAAO;AAAA,EACR;AAAA,EAEA,uBAAiC;AAChC,UAAM,cAAc,OAAO,aAAa;AACxC,QAAI,YAAY,kBAAkB,KAAK,KAAK,EAAG,QAAO,YAAY,kBAAkB,KAAK,KAAK;AAC9F,QAAI,SAAS,KAAK,mBAAmB,WAAW,CAAC;AACjD,gBAAY,kBAAkB,KAAK,KAAK,IAAI;AAC5C,WAAO;AAAA,EACR;AACD;"}