{"version":3,"file":"legend2SJZX.js","sources":["../../../../../../../../packages/extension/WhichWay/src/character/packs/legend/legend2SJZX.js"],"sourcesContent":["import { lib, game, ui, get, ai, _status } from \"noname\";\r\nimport { skillCustomFunc } from \"../../../nonameEx/custom/skill.ts\";\r\nimport { whichWayTips } from \"../../../tips/index.ts\";\r\n\r\n/**\r\n * 六星武将的第二部分\r\n */\r\nconst tmpSave = window.whichWaySave.tmpSave;\r\n\r\n/** @type {WhichWayCharacterPack} */\r\nexport default {\r\n\tcharacter: {\r\n\t\tyindelaiximrfz: [\"female\", \"samrfz\", 4, [\"pingyimrfz\", \"beinuomrfz\"], []],\r\n\t\taibulanamrfz: [\"female\", \"weimrfz\", 4, [\"yizhamrfz\", \"kumianmrfz\"], []],\r\n\t\tmon3trmrfz: [\"female\", \"luomrfz\", 4, [\"shulimrfz\", \"ronghuimrfz\"], []],\r\n\t\tspnengtianshimrfz: [\"female\", \"lamrfz\", 3, [\"youhuomrfz\", \"letianmrfz\"], []],\r\n\t\tleimiuanmrfz: [\"female\", \"lamrfz\", 3, [\"feiyimrfz\", \"mingzhengmrfz\", \"zhuijimrfz\"], []],\r\n\t\txinyangjiaobanjimrfz: [\"male\", \"lamrfz\", 4, [\"daoweimrfz\", \"chongzhoumrfz\", \"shiyimrfz\"], []],\r\n\t\tjiushenmrfz: [\"male\", \"weimrfz\", \"1/3\", [\"xinyunmrfz\", \"zongyinmrfz\", \"zhanwangmrfz\"], []],\r\n\t\tspjingzhemrfz: [\"female\", \"yanmrfz\", 4, [\"xiuyuanmrfz\", \"zhengningmrfz\"], []],\r\n\t\tdianhumrfz: [\"female\", \"luomrfz\", 4, [\"gandianmrfz\"], []],\r\n\t\tziyeyaomrfz: {\r\n\t\t\tsex: \"female\",\r\n\t\t\tgroup: \"dongmrfz\",\r\n\t\t\thp: 3,\r\n\t\t\tskills: [\"youlinmrfz\", \"miaomengmrfz\", \"fuyingmrfz\"],\r\n\t\t},\r\n\t\tspxingxiongmrfz: {\r\n\t\t\tsex: \"female\",\r\n\t\t\tgroup: \"yanmrfz\",\r\n\t\t\thp: 3,\r\n\t\t\tmaxHp: 4,\r\n\t\t\tskills: [\"wozhimrfz\", \"guishimrfz\", \"zhanyemrfz\"],\r\n\t\t},\r\n\t\tcuoemrfz: {\r\n\t\t\tsex: \"female\",\r\n\t\t\tgroup: \"dongmrfz\",\r\n\t\t\thp: 4,\r\n\t\t\tskills: [\"huanyoumrfz\", \"wenxinmrfz\"],\r\n\t\t},\r\n\t\tfengchuanxiangzimrfz: {\r\n\t\t\tsex: \"female\",\r\n\t\t\tgroup: \"othermrfz\",\r\n\t\t\thp: 3,\r\n\t\t\tskills: [\"songyuemrfz\", \"yuxiangmrfz\", \"wuweimrfz\"],\r\n\t\t\tclans: [\"AveMujica\"],\r\n\t\t},\r\n\t\tyeyingmrfz: {\r\n\t\t\tsex: \"female\",\r\n\t\t\thp: 3,\r\n\t\t\tgroup: \"shimrfz\",\r\n\t\t\tskills: [\"guqiumrfz\", \"newpolongmrfz\"],\r\n\t\t},\r\n\t\ttifengmrfz: {\r\n\t\t\tsex: \"female\",\r\n\t\t\thp: 4,\r\n\t\t\tgroup: \"samrfz\",\r\n\t\t\tskills: [\"lieqiongmrfz\", \"tifengmrfz_lieshimrfz\"],\r\n\t\t},\r\n\t},\r\n\tskill: {\r\n\t\t//新提丰\r\n\t\tlieqiongmrfz: {\r\n\t\t\taudio: \"ruiyamrfz\",\r\n\t\t\tderivation: [\"wangong\", \"xinliegong\"],\r\n\t\t\ttrigger: {\r\n\t\t\t\tplayer: \"useCard\",\r\n\t\t\t},\r\n\t\t\tforced: true,\r\n\t\t\tfirstDo: true,\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn (\r\n\t\t\t\t\tevent.card &&\r\n\t\t\t\t\tget.name(event.card) === \"sha\" &&\r\n\t\t\t\t\tevent.card.cards &&\r\n\t\t\t\t\tevent.card.cards.some(card => [\"red\", \"black\"].includes(get.color(card) || \"\"))\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tlet color = [\"red\", \"black\"];\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\ttrigger.card.cards.forEach(card => {\r\n\t\t\t\t\tlet colorx = get.color(card) || \"\";\r\n\t\t\t\t\tif (color.includes(colorx)) {\r\n\t\t\t\t\t\tcolor.remove(colorx);\r\n\t\t\t\t\t\tswitch (colorx) {\r\n\t\t\t\t\t\t\tcase \"red\":\r\n\t\t\t\t\t\t\t\tplayer.addSkill(\"wangong2\");\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase \"black\":\r\n\t\t\t\t\t\t\t\tplayer\r\n\t\t\t\t\t\t\t\t\t.when({\r\n\t\t\t\t\t\t\t\t\t\tplayer: \"useCardAfter\",\r\n\t\t\t\t\t\t\t\t\t\tglobal: \"roundStart\",\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t.filter((event, player) => {\r\n\t\t\t\t\t\t\t\t\t\tif (event.name === \"phase\") return true;\r\n\t\t\t\t\t\t\t\t\t\treturn event.card.cardid === trigger.card.cardid;\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t.step(async (event, trigger, player) => {\r\n\t\t\t\t\t\t\t\t\t\tif (trigger.name === \"phase\") return;\r\n\t\t\t\t\t\t\t\t\t\tplayer.removeSkill(\"lieqiongmrfz_enchanting_liegong\");\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tplayer.storage.lieqiongmrfz_enchanting_liegong = trigger.card.cardid;\r\n\t\t\t\t\t\t\t\tplayer.addSkill(\"lieqiongmrfz_enchanting_liegong\");\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tsubSkill: {\r\n\t\t\t\tenchanting_liegong: {\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tplayer: \"useCardToTargeted\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonremove: true,\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\treturn event.card.cardid === player.storage.lieqiongmrfz_enchanting_liegong;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tlib.skill.xinliegong.content(event, trigger, player);\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\ttifengmrfz_lieshimrfz: {\r\n\t\t\taudio: \"shouliemrfz\",\r\n\t\t\tenable: \"phaseUse\",\r\n\t\t\tusable: 1,\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn player.countCards(\"h\") > 0 && player.hasUseTarget({ name: \"sha\", nature: \"stab\" }, false, false);\r\n\t\t\t},\r\n\t\t\tfilterTarget(card, player, target) {\r\n\t\t\t\tconst judge = () => player.canUse({ name: \"sha\", nature: \"stab\" }, target, false, false) && target !== player;\r\n\r\n\t\t\t\tif (judge()) whichWayTips.addPrompt(target, `摸${get.distance(player, target)}张牌`, \"tifengmrfz_lieshimrfz\", \"uncheckBegin\");\r\n\t\t\t\telse whichWayTips.addPrompt(target, `不是合法目标`, \"tifengmrfz_lieshimrfz\", \"uncheckBegin\");\r\n\t\t\t\treturn !!judge();\r\n\t\t\t},\r\n\t\t\tselectCard: () => {\r\n\t\t\t\tlet player = get.player();\r\n\t\t\t\treturn Math.max(1, Math.floor(player.countCards(\"h\") / 2));\r\n\t\t\t},\r\n\t\t\tfilterCard: () => true,\r\n\t\t\tprompt: \"你可以将一半的手牌（向下取整，至少为1）当作一张无距离和次数限制的刺【杀】对一名其他角色使用，然后你摸X张牌。（X=目标角色与你的距离）\",\r\n\t\t\tdiscard: false,\r\n\t\t\tlose: false,\r\n\t\t\tdelay: false,\r\n\t\t\tcheck(card) {\r\n\t\t\t\tlet num = 8 - get.value(card);\r\n\t\t\t\tif (!ui.selected.cards.map(i => get.color(i)).includes(get.color(card))) num += 2;\r\n\t\t\t\treturn num;\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tconst { cards, targets } = event;\r\n\t\t\t\tawait player\r\n\t\t\t\t\t.chooseUseTarget({ name: \"sha\", nature: \"stab\" }, cards)\r\n\t\t\t\t\t.set(\"forced\", true)\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t.set(\"filterTarget\", (card, player, target) => target === get.event().targetx)\r\n\t\t\t\t\t.set(\"targetx\", event.target)\r\n\t\t\t\t\t.set(\"nodistance\", true)\r\n\t\t\t\t\t.set(\"addCount\", false)\r\n\t\t\t\t\t.forResult();\r\n\t\t\t\tif (!cards || !targets) return;\r\n\t\t\t\tlet target = targets[0];\r\n\t\t\t\tif (get.distance(player, target) > 0) player.draw(get.distance(player, target));\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\torder: 3,\r\n\t\t\t\tresult: {\r\n\t\t\t\t\tplayer: function (player, target) {\r\n\t\t\t\t\t\tif (get.attitude2(target) > 0) return -1;\r\n\t\t\t\t\t\treturn get.distance(player, target) + Math.min(2, target.getDamagedHp());\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\t//新夜莺\r\n\t\tguqiumrfz: {\r\n\t\t\tmod: {\r\n\t\t\t\tcardnumber(card, player, num) {\r\n\t\t\t\t\tif (card.hasGaintag(\"guqiumrfz_number\")) return (num += 3);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tderivation: [\"shanzhuan\"],\r\n\t\t\taudio: \"qiulongmrfz\",\r\n\t\t\ttrigger: {\r\n\t\t\t\tglobal: \"roundStart\",\r\n\t\t\t},\r\n\t\t\tinit() {\r\n\t\t\t\tlib.translate[\"guqiumrfz_number\"] = `点数+3`;\r\n\t\t\t},\r\n\t\t\tforced: true,\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn game.hasPlayer(char => char !== player && char.inRange(player));\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tfor (let char of game.players) {\r\n\t\t\t\t\tif (char === player || !char.inRange(player)) continue;\r\n\t\t\t\t\tlet next = game.createEvent(\"guqiumrfz_shanzhuan\");\r\n\t\t\t\t\tnext.player = char;\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tnext._trigger = {\r\n\t\t\t\t\t\tplayer: player,\r\n\t\t\t\t\t};\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tawait next.setContent(lib.skill.shanzhuan.content);\r\n\t\t\t\t}\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tplayer.drawTo(5).set(\"gaintag\", [\"guqiumrfz_number\"]);\r\n\t\t\t},\r\n\t\t\tgroup: \"guqiumrfz_compare\",\r\n\t\t\tsubSkill: {\r\n\t\t\t\tcompare: {\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tplayer: \"compare\",\r\n\t\t\t\t\t\ttarget: \"compare\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tif (event.iwhile && event.player === player) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tplayer.getHistory(\"lose\", evt => {\r\n\t\t\t\t\t\t\t\tlet cardid = event[event.player === player ? \"card1\" : \"card2\"].cardid;\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\tevt.gaintag_map &&\r\n\t\t\t\t\t\t\t\t\tObject.keys(evt.gaintag_map).includes(cardid) &&\r\n\t\t\t\t\t\t\t\t\tevt.gaintag_map[cardid].includes(\"guqiumrfz_number\")\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}).length > 0\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tgame.log(player, `的拼点牌点数+3`);\r\n\t\t\t\t\t\ttrigger[trigger.player === player ? \"num1\" : \"num2\"] += 3;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\tcombo: \"newpolongmrfz\",\r\n\t\t\t},\r\n\t\t},\r\n\t\tnewpolongmrfz: {\r\n\t\t\tmod: {\r\n\t\t\t\tcardUsable: function (card, player, num) {\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tif (typeof num === \"number\" && card?.cards?.some(cardx => cardx.hasGaintag(\"newpolongmrfz\"))) return Infinity;\r\n\t\t\t\t},\r\n\t\t\t\ttargetInRange: function (card, player, target, now) {\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tif (card?.cards?.some(cardx => cardx.hasGaintag(\"newpolongmrfz\"))) return true;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\taudio: \"polongmrfz\",\r\n\t\t\ttrigger: { player: \"phaseZhunbeiBegin\" },\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn game.countPlayer(char => char.countCards(\"h\") > 0) > 1;\r\n\t\t\t},\r\n\t\t\tasync cost(event, trigger, player) {\r\n\t\t\t\tevent.result = await player\r\n\t\t\t\t\t.chooseTarget()\r\n\t\t\t\t\t.set(\"prompt\", get.prompt(\"newpolongmrfz\"))\r\n\t\t\t\t\t.set(\r\n\t\t\t\t\t\t\"prompt2\",\r\n\t\t\t\t\t\t`你可以令一名角色A与角色B(角色B不能为你)拼点，若角色A赢，你将判定区的牌翻面，然后摸2X张牌，且你因此获得的牌本回合无距离次数限制。（X=你因此翻面的牌数）`\r\n\t\t\t\t\t)\r\n\t\t\t\t\t.set(\"targetprompt\", [\"角色A\", \"角色B\"])\r\n\t\t\t\t\t.set(\"filterTarget\", (card, player, target) => {\r\n\t\t\t\t\t\tif (target.countCards(\"h\") < 1) return false;\r\n\t\t\t\t\t\tlet targets = ui.selected.targets;\r\n\t\t\t\t\t\treturn targets.length < 1 || (targets[0].canCompare(target) && target !== player);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.set(\"ai\", target => {\r\n\t\t\t\t\t\tlet targets = ui.selected.targets;\r\n\t\t\t\t\t\tlet player = get.player();\r\n\t\t\t\t\t\tif (player.countCards(\"j\", card => get.type(card) === \"delay\") < 1) {\r\n\t\t\t\t\t\t\treturn get.attitude2(target) < 0;\r\n\t\t\t\t\t\t} else if (targets.length < 1) {\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tif (player.countCards(\"h\", card => get.number(card) > 7) > 0) return target === player ? 114514 : -1;\r\n\t\t\t\t\t\t\treturn get.attitude2(target) < 0 || (get.attitude2(target) > 0 && target.countCards(\"h\") > 3);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn get.attitude2(target) < 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.set(\"complexTarget\", true)\r\n\t\t\t\t\t.set(\"selectTarget\", 2)\r\n\t\t\t\t\t.forResult();\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tconst [targetA, targetB] = event.targets;\r\n\t\t\t\tconst result = await targetA.chooseToCompare(targetB).forResult();\r\n\t\t\t\tif (result.winner === targetA) {\r\n\t\t\t\t\tconst cards = player.getCards(\"j\").filter(card => get.type(card) === \"delay\");\r\n\t\t\t\t\tgame.cardsGotoOrdering(cards);\r\n\t\t\t\t\tconst links = cards\r\n\t\t\t\t\t\t.map(card => {\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\treturn card.viewAs ? card.cards : get.autoViewAs(card);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.flat();\r\n\t\t\t\t\tconsole.log(links);\r\n\t\t\t\t\tlinks.forEach(card => {\r\n\t\t\t\t\t\tif (get.type(card, null, false) !== \"delay\") {\r\n\t\t\t\t\t\t\tcard.fix();\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tplayer.addJudge({ name: \"xumou_jsrg\" }, [card]);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tplayer.addJudge({ name: \"xumou_jsrg\" }, card.cards);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tplayer.draw(links.length * 2).set(\"gaintag\", [\"newpolongmrfz\"]);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgroup: \"newpolongmrfz_clear\",\r\n\t\t\tsubSkill: {\r\n\t\t\t\tclear: {\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\ttrigger: { player: \"phaseEnd\" },\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tplayer.removeGaintag(\"newpolongmrfz\", player.getCards(\"h\"));\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\t//丰川祥子\r\n\t\tsongyuemrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\ttrigger: { player: \"phaseZhunbeiBegin\" },\r\n\t\t\tfrequent: true,\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tfor (let t of [1, 2, 3]) {\r\n\t\t\t\t\tconst { color } = await player.judge().forResult();\r\n\t\t\t\t\tif (player.countCards(\"h\") < 1) continue;\r\n\t\t\t\t\tconst { cards } = await player\r\n\t\t\t\t\t\t.chooseCard(\"h\", true)\r\n\t\t\t\t\t\t.set(\r\n\t\t\t\t\t\t\t\"prompt\",\r\n\t\t\t\t\t\t\t`你可以重铸一张手牌，若重铸的牌与判定牌颜色(${get.translation(color)})一致，你摸${lib.skill.wuweimrfz.getNum(player, event.name)}张牌。`\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t.set(\"ai\", card => {\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tlet { player, color, num } = get.event();\r\n\t\t\t\t\t\t\treturn (get.color(card) === color ? 8 : 6) - get.value(card);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.set(\"color\", color)\r\n\t\t\t\t\t\t.set(\"num\", lib.skill.wuweimrfz.getNum(player, event.name))\r\n\t\t\t\t\t\t.forResult();\r\n\t\t\t\t\tif (!cards) return;\r\n\t\t\t\t\tlet card = cards[0];\r\n\t\t\t\t\tplayer.recast(card);\r\n\t\t\t\t\tif (!card || lib.skill.wuweimrfz.getNum(player, event.name) < 1) continue;\r\n\t\t\t\t\tif (get.color(card) === color) player.draw(lib.skill.wuweimrfz.getNum(player, event.name));\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\tyuxiangmrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\ttrigger: {\r\n\t\t\t\tglobal: \"phaseEnd\",\r\n\t\t\t},\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\tlet centralArea = get.discarded();\r\n\t\t\t\treturn (\r\n\t\t\t\t\tcentralArea.filter(card => {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\tgame.getGlobalHistory(\"changeHp\", evt => {\r\n\t\t\t\t\t\t\t\tlet evtx = evt.getParent();\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tif (evtx.name === \"damage\" && evtx.num > 0) return evtx.cards?.includes(card);\r\n\t\t\t\t\t\t\t}).length > 0\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}).length > 0\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tasync cost(event, trigger, player) {\r\n\t\t\t\tlet centralArea = get.discarded().filter(card => {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\tgame.getGlobalHistory(\"changeHp\", evt => {\r\n\t\t\t\t\t\t\tlet evtx = evt.getParent();\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tif (evtx.name === \"damage\" && evtx.num > 0) return evtx.cards?.includes(card);\r\n\t\t\t\t\t\t}).length > 0\r\n\t\t\t\t\t);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tconst result = await player\r\n\t\t\t\t\t.chooseButton()\r\n\t\t\t\t\t.set(\"createDialog\", [get.prompt(event.skill) + `选择你要${get.poptip(\"sjzx_byRecast\")}使用的牌`, centralArea])\r\n\t\t\t\t\t.set(\"ai\", button => {\r\n\t\t\t\t\t\tlet player = get.player();\r\n\t\t\t\t\t\treturn player.getUseValue(button);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.set(\"filterButton\", button => {\r\n\t\t\t\t\t\tlet player = get.player();\r\n\t\t\t\t\t\treturn player.hasUseTarget(button);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.forResult();\r\n\t\t\t\tevent.result = {\r\n\t\t\t\t\t...result,\r\n\t\t\t\t\tcost_data: {\r\n\t\t\t\t\t\tcards: result?.links,\r\n\t\t\t\t\t},\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tlet [card] = event.cost_data.cards;\r\n\t\t\t\tplayer.recast(card);\r\n\t\t\t\tplayer.chooseUseTarget(card, true);\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\twuweimrfz: {\r\n\t\t\taudioname: [\"ruoyemumrfz\", \"youtiansiruomaimrfz\", \"sanjiaochuhuamrfz\", \"bafanhailingmrfz\"],\r\n\t\t\taudio: 2,\r\n\t\t\tinit(player, skill) {\r\n\t\t\t\tplayer.storage[skill] = {};\r\n\r\n\t\t\t\t//添加动态翻译\r\n\t\t\t\tgame.broadcastAll(skills => {\r\n\t\t\t\t\tskills.forEach(skill => {\r\n\t\t\t\t\t\tlet info = get.skillInfoTranslation(skill);\r\n\t\t\t\t\t\tlib.dynamicTranslate[skill] = function (player) {\r\n\t\t\t\t\t\t\tif (!player.storage.wuweimrfz || lib.skill.wuweimrfz.getNum(player, skill) < 1) return info;\r\n\t\t\t\t\t\t\treturn info + `（X=你本轮触发过的${get.poptip(\"sjzx_cardUseType\")}数）`;\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tlib.dynamicTranslate[\"wuweimrfz\"] = function (player) {\r\n\t\t\t\t\t\tlet info = get.skillInfoTranslation(\"wuweimrfz\");\r\n\t\t\t\t\t\tif (!player.storage.wuweimrfz) return info;\r\n\t\t\t\t\t\tfor (let skill of skills) {\r\n\t\t\t\t\t\t\tif (lib.skill.wuweimrfz.getNum(player, skill) > 0)\r\n\t\t\t\t\t\t\t\treturn info.replace(`（X=你本轮触发过的${get.poptip(\"sjzx_cardUseType\")}数）`, \"\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn info;\r\n\t\t\t\t\t};\r\n\t\t\t\t}, lib.skill.wuweimrfz.validSkills);\r\n\t\t\t},\r\n\t\t\tclanSkill: true,\r\n\t\t\tgetNum(receiver, skill) {\r\n\t\t\t\tfor (let player of game.players) {\r\n\t\t\t\t\tlet storage = player.storage.wuweimrfz;\r\n\t\t\t\t\tif (!storage) continue;\r\n\t\t\t\t\tfor (let id in storage) {\r\n\t\t\t\t\t\tlet info = storage[id];\r\n\t\t\t\t\t\tif (info.receiver.playerid !== receiver.playerid) continue;\r\n\t\t\t\t\t\tif (info.skill === skill) {\r\n\t\t\t\t\t\t\tlet num = 0;\r\n\t\t\t\t\t\t\t//重铸\r\n\t\t\t\t\t\t\tif (receiver.getRoundHistory(\"lose\", evt => evt.getParent(2).name === \"recast\").length > 0) num++;\r\n\t\t\t\t\t\t\t//使用\r\n\t\t\t\t\t\t\tif (receiver.getRoundHistory(\"useCard\").length > 0) num++;\r\n\t\t\t\t\t\t\t//打出\r\n\t\t\t\t\t\t\tif (receiver.getRoundHistory(\"respond\").length > 0) num++;\r\n\t\t\t\t\t\t\t//弃置\r\n\t\t\t\t\t\t\tif (receiver.getRoundHistory(\"lose\", evt => evt.type === \"discard\").length > 0) num++;\r\n\t\t\t\t\t\t\treturn num;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn 0;\r\n\t\t\t},\r\n\t\t\ttrigger: {\r\n\t\t\t\tplayer: \"recastAfter\",\r\n\t\t\t},\r\n\t\t\tvalidSkills: [\r\n\t\t\t\t\"songyuemrfz\",\r\n\t\t\t\t\"yuxiangmrfz\",\r\n\t\t\t\t\"lingwomrfz\",\r\n\t\t\t\t\"pojianmrfz\",\r\n\t\t\t\t\"leigumrfz\",\r\n\t\t\t\t\"jiaoyingmrfz\",\r\n\t\t\t\t\"weimianmrfz\",\r\n\t\t\t\t\"weiquanmrfz\",\r\n\t\t\t\t\"chendiemrfz\",\r\n\t\t\t\t\"umiri_chenxianmrfz\",\r\n\t\t\t],\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn Object.keys(player.storage.wuweimrfz).length < 1;\r\n\t\t\t},\r\n\t\t\tasync cost(event, trigger, player) {\r\n\t\t\t\tconst { targets } = await player\r\n\t\t\t\t\t.chooseTarget()\r\n\t\t\t\t\t.set(\"prompt2\", `你可以将本技能句号之后的描述移至同族武将的武将牌上任意一个技能直到本轮结束`)\r\n\t\t\t\t\t.set(\"prompt\", `【毋畏】:请选择一名${get.poptip(\"sjzx_AveMujica\")}角色`)\r\n\t\t\t\t\t.set(\"filterTarget\", (card, player, target) => {\r\n\t\t\t\t\t\tlet flag = false;\r\n\t\t\t\t\t\tlet skills = target.getOriginalSkills().filter(skill => lib.skill.wuweimrfz.validSkills.includes(skill));\r\n\t\t\t\t\t\tfor (let skill of skills) {\r\n\t\t\t\t\t\t\tif (lib.skill.wuweimrfz.getNum(target, skill) < 1) {\r\n\t\t\t\t\t\t\t\tflag = true;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn flag && target.getClans(true).includes(\"AveMujica\");\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.set(\"ai\", target => get.attitude2(target) > 0)\r\n\t\t\t\t\t.forResult();\r\n\t\t\t\tif (!targets) return;\r\n\t\t\t\tlet target = targets[0];\r\n\t\t\t\tif (!target) {\r\n\t\t\t\t\tevent.result = {\r\n\t\t\t\t\t\tbool: false,\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet skills = target.getOriginalSkills().filter(skill => lib.skill.wuweimrfz.validSkills.includes(skill));\r\n\t\t\t\tif (skills.length < 1) {\r\n\t\t\t\t\tevent.result = {\r\n\t\t\t\t\t\tbool: false,\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst result = await player\r\n\t\t\t\t\t.chooseControl(skills.concat(\"cancel2\"))\r\n\t\t\t\t\t.set(\"prompt\", `为一个技能添加下列描述直到本轮结束：“（X=你本轮触发过的${get.poptip(\"sjzx_cardUseType\")}数）”`)\r\n\t\t\t\t\t.set(\"ai\", () => {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\treturn get.event().skills.randomGet();\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.set(\"skills\", skills)\r\n\t\t\t\t\t.forResult();\r\n\t\t\t\tevent.result = {\r\n\t\t\t\t\t...result,\r\n\t\t\t\t\tcost_data: result,\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tlet skill = event.cost_data.control;\r\n\t\t\t\tif (!player.storage.wuweimrfz) player.storage.wuweimrfz = {};\r\n\t\t\t\tif (player.playerid) {\r\n\t\t\t\t\tplayer.storage.wuweimrfz[player.playerid] = {\r\n\t\t\t\t\t\tskill: skill,\r\n\t\t\t\t\t\treceiver: player,\r\n\t\t\t\t\t};\r\n\t\t\t\t\tplayer.when({ global: \"roundStart\" }).then(() => {\r\n\t\t\t\t\t\tif (player.playerid) delete player.storage.wuweimrfz[player.playerid];\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\t//新嵯峨\r\n\t\t//默认技能组\r\n\t\thuanyoumrfz: {\r\n\t\t\taudio: \"chuemrfz\",\r\n\t\t\tforced: true,\r\n\t\t\ttrigger: {\r\n\t\t\t\tplayer: \"gainAfter\",\r\n\t\t\t},\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn !player.isPhaseUsing() && event.cards.length > 0 && event.getParent().name !== \"huanyoumrfz\";\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tplayer.gain(lib.card.ying.getYing(trigger.cards.length), \"gain2\");\r\n\t\t\t},\r\n\t\t\tgroup: [\"huanyoumrfz_hideHandCards\"],\r\n\t\t\tsubSkill: {\r\n\t\t\t\thideHandCards: {\r\n\t\t\t\t\taudio: \"huanyoumrfz\",\r\n\t\t\t\t\tforced: true,\r\n\t\t\t\t\ttrigger: { player: \"phaseUseBegin\" },\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tlet handcard = player.node.handcards1.parentElement;\r\n\t\t\t\t\t\tplayer.node.washTip = ui.create.div(handcard, \".washTip\");\r\n\t\t\t\t\t\tplayer.node.washTip.innerHTML = \"洗牌中...\";\r\n\r\n\t\t\t\t\t\tlet hs = [];\r\n\t\t\t\t\t\tlet origin = player.getCards(\"h\");\r\n\t\t\t\t\t\tfor (let i = 0; i < player.getCards(\"h\").length; i++) {\r\n\t\t\t\t\t\t\tlet r = origin.randomGet();\r\n\t\t\t\t\t\t\ths.push(r);\r\n\t\t\t\t\t\t\torigin.remove(r);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.broadcastAll(\r\n\t\t\t\t\t\t\tfunction (hs, player) {\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\ths.forEach(i => i.goto(ui.special));\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tplayer.directgain(hs, false);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\ths,\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tplayer\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tplayer.addTempSkill(\"huanyoumrfz_hideHandCards_eff\", { player: \"phaseEnd\" });\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\thideHandCards_eff: {\r\n\t\t\t\t\tmod: {\r\n\t\t\t\t\t\tcardname(card, player, name) {\r\n\t\t\t\t\t\t\tif (card.storage.huanyoumrfz) {\r\n\t\t\t\t\t\t\t\treturn \"cuoe_huanyoumrfzCard\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\tinit(player) {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tif (!player.node.handcards1.cardMod) {\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tplayer.node.handcards1.cardMod = {};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tif (!player.node.handcards2.cardMod) {\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tplayer.node.handcards2.cardMod = {};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar cardMod = function (card) {\r\n\t\t\t\t\t\t\treturn [\"幻有\", \"手牌对你不可见\"];\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tplayer.node.handcards1.cardMod.huanyoumrfz = cardMod;\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tplayer.node.handcards2.cardMod.huanyoumrfz = cardMod;\r\n\t\t\t\t\t\tplayer.node.handcards1.classList.add(\"huanyoumrfz\");\r\n\t\t\t\t\t\tplayer.node.handcards2.classList.add(\"huanyoumrfz\");\r\n\r\n\t\t\t\t\t\tplayer.getCards(\"h\").forEach(i => {\r\n\t\t\t\t\t\t\ti.storage.huanyoumrfz = true;\r\n\t\t\t\t\t\t\ti.dataset.skilltag = \"huanyoumrfz\";\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tplayer.node.washTip.remove();\r\n\t\t\t\t\t\t\tdelete player.node.washTip;\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonremove(player) {\r\n\t\t\t\t\t\tplayer.node.handcards1.classList.remove(\"huanyoumrfz\");\r\n\t\t\t\t\t\tplayer.node.handcards2.classList.remove(\"huanyoumrfz\");\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tdelete player.node.handcards1.cardMod.huanyoumrfz;\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tdelete player.node.handcards2.cardMod.huanyoumrfz;\r\n\t\t\t\t\t\tplayer.getCards(\"h\").forEach(i => {\r\n\t\t\t\t\t\t\tif (i.storage.huanyoumrfz) {\r\n\t\t\t\t\t\t\t\tdelete i.storage.huanyoumrfz;\r\n\t\t\t\t\t\t\t\tdelete i.dataset.skilltag;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tplayer: \"useCardAfter\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\tevent.card.storage?.huanyoumrfz &&\r\n\t\t\t\t\t\t\tevent.cards.length === 1 &&\r\n\t\t\t\t\t\t\t!event.card.failToUse &&\r\n\t\t\t\t\t\t\t!event.getParent().noTriggerHuanyoumrfz\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\ttrigger.cards.forEach(card => {\r\n\t\t\t\t\t\t\tif (card.storage.huanyoumrfz) player.draw();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\tneg: true,\r\n\t\t\t},\r\n\t\t},\r\n\t\twenxinmrfz: {\r\n\t\t\taudio: 3,\r\n\t\t\tderivation: \"zhishuimrfz\",\r\n\t\t\tgroup: [\"wenxinmrfz_achieve\", \"wenxinmrfz_turnOver\", \"wenxinmrfz_fail\"],\r\n\t\t\tsubSkill: {\r\n\t\t\t\tachieve: {\r\n\t\t\t\t\taudio: true,\r\n\t\t\t\t\tlogAudio() {\r\n\t\t\t\t\t\treturn skillCustomFunc.getSkillAudioPath(\"wenxinmrfz\", 1);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tforced: true,\r\n\t\t\t\t\tskillAnimation: true,\r\n\t\t\t\t\tanimationColor: \"metal\",\r\n\t\t\t\t\tlastDo: true,\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tplayer: \"phaseEnd\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\tlet useList = player\r\n\t\t\t\t\t\t\t.getHistory(\"useCard\", evt => evt.card.name === \"cuoe_huanyoumrfzCard\" || !evt.card.storage.huanyoumrfz)\r\n\t\t\t\t\t\t\t.map(evt => {\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\treturn evt.card.name === \"cuoe_huanyoumrfzCard\" ? get.name(evt.card.cards[0]) : evt.card.name;\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\tlet count = 0;\r\n\t\t\t\t\t\tfor (let name of useList) {\r\n\t\t\t\t\t\t\tif (name === \"ying\") {\r\n\t\t\t\t\t\t\t\tcount = 0;\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tcount++;\r\n\t\t\t\t\t\t\tif (count >= 3) return true;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tgame.log(player, \"成功完成使命\");\r\n\t\t\t\t\t\tplayer.awakenSkill(\"wenxinmrfz\");\r\n\t\t\t\t\t\tplayer.addSkills([\"zhishuimrfz\"]);\r\n\t\t\t\t\t\tplayer.loseMaxHp();\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tturnOver: {\r\n\t\t\t\t\taudio: true,\r\n\t\t\t\t\tlogAudio() {\r\n\t\t\t\t\t\treturn skillCustomFunc.getSkillAudioPath(\"wenxinmrfz\", 3);\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tplayer: \"useCardAfter\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tlastDo: true,\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\tplayer.countCards(\"h\", card => card.storage.huanyoumrfz) > 0 &&\r\n\t\t\t\t\t\t\tevent.card.storage?.huanyoumrfz &&\r\n\t\t\t\t\t\t\tevent.cards.length === 1 &&\r\n\t\t\t\t\t\t\t!event.getParent().noTriggerHuanyoumrfz\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync cost(event, trigger, player) {\r\n\t\t\t\t\t\tevent.result = await player\r\n\t\t\t\t\t\t\t.chooseCard(\"h\")\r\n\t\t\t\t\t\t\t.set(\"prompt\", get.prompt(\"wenxinmrfz\"))\r\n\t\t\t\t\t\t\t.set(\"prompt2\", `你可以令一张背面朝上的手牌正面朝上`)\r\n\t\t\t\t\t\t\t.set(\"filterCard\", card => card.storage.huanyoumrfz)\r\n\t\t\t\t\t\t\t.set(\"ai\", () => Math.random())\r\n\t\t\t\t\t\t\t.forResult();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tlet card = event.cards[0];\r\n\t\t\t\t\t\tdelete card.storage.huanyoumrfz;\r\n\t\t\t\t\t\tdelete card.dataset.skilltag;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tfail: {\r\n\t\t\t\t\taudio: true,\r\n\t\t\t\t\tlogAudio() {\r\n\t\t\t\t\t\treturn skillCustomFunc.getSkillAudioPath(\"wenxinmrfz\", 2);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tforced: true,\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tplayer: \"phaseEnd\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfirstDo: true,\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\tlet useList = player\r\n\t\t\t\t\t\t\t.getHistory(\"useCard\", evt => evt.card.name === \"cuoe_huanyoumrfzCard\" || !evt.card.storage.huanyoumrfz)\r\n\t\t\t\t\t\t\t.map(evt => {\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\treturn evt.card.name === \"cuoe_huanyoumrfzCard\" ? get.name(evt.card.cards[0]) : evt.card.name;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t(useList.length === 0 || (useList[0] === \"ying\" && new Set(useList).size === 1)) &&\r\n\t\t\t\t\t\t\t!player.getHistory(\"skipped\").includes(\"phaseUse\")\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tgame.log(player, \"使命失败\");\r\n\t\t\t\t\t\tplayer.awakenSkill(\"wenxinmrfz\");\r\n\t\t\t\t\t\tplayer.addSkill([\"wenxinmrfz_fail_buff\"]);\r\n\t\t\t\t\t\tplayer.markSkill(\"wenxinmrfz_fail_buff\");\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tfail_buff: {\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tplayer: \"phaseDrawBegin\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tintro: {\r\n\t\t\t\t\t\tcontent: \"·每个摸牌阶段开始时获得一张【影】<br>·如真似幻，扑朔迷离。\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tplayer.gain(lib.card.ying.getYing(1), \"gain2\");\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tzhishuimrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\tforced: true,\r\n\t\t\ttrigger: {\r\n\t\t\t\tplayer: \"useCardBegin\",\r\n\t\t\t},\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn (\r\n\t\t\t\t\tevent.card.storage?.huanyoumrfz &&\r\n\t\t\t\t\t!event.card.storage?.zhishuimrfz &&\r\n\t\t\t\t\tevent.card.cards.length === 1 &&\r\n\t\t\t\t\t!player.hasUseTarget(event.card.cards[0].name)\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tawait player.useCard(\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tname: \"dongzhuxianji\",\r\n\t\t\t\t\t\tsuit: trigger.card.suit,\r\n\t\t\t\t\t\tnumber: trigger.card.number,\r\n\t\t\t\t\t\tnature: trigger.card.nature,\r\n\t\t\t\t\t\tstorage: {\r\n\t\t\t\t\t\t\t...trigger.card.storage,\r\n\t\t\t\t\t\t\tzhishuimrfz: true,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tisCard: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttrigger.cards,\r\n\t\t\t\t\tplayer\r\n\t\t\t\t);\r\n\t\t\t\ttrigger.cancel();\r\n\t\t\t},\r\n\t\t},\r\n\t\t//模组：何处寻驼？\r\n\t\tqianxianmrfz: {\r\n\t\t\taudio: \"chuemrfz\",\r\n\t\t\ttrigger: {\r\n\t\t\t\tplayer: \"useCardToPlayered\",\r\n\t\t\t\ttarget: \"useCardToTargeted\",\r\n\t\t\t},\r\n\t\t\tforced: true,\r\n\t\t\tinit(player, skill) {\r\n\t\t\t\tplayer.storage[skill] = [];\r\n\t\t\t},\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\tif (![\"trick\", \"basic\"].includes(get.type(event.card))) return false;\r\n\t\t\t\treturn player === event.target || event.getParent().triggeredTargets3.length === 1;\r\n\t\t\t},\r\n\t\t\tmark: true,\r\n\t\t\tintro: {\r\n\t\t\t\tcontent(storage) {\r\n\t\t\t\t\treturn `记录的牌名：${get.translation(storage)}`;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tonremove: true,\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tif (player.storage.qianxianmrfz.includes(trigger.card.name)) {\r\n\t\t\t\t\tplayer.storage.qianxianmrfz.remove(trigger.card.name);\r\n\t\t\t\t\tplayer.draw();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tplayer.storage.qianxianmrfz.push(trigger.card.name);\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\ttrigger.getParent()?.excluded.add(...trigger.targets);\r\n\t\t\t\t\ttrigger.player.draw(2);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\tthreaten: 2,\r\n\t\t\t},\r\n\t\t},\r\n\t\tziwumrfz: {\r\n\t\t\taudio: \"wenxinmrfz\",\r\n\t\t\tderivation: \"dunkongmrfz\",\r\n\t\t\tforced: true,\r\n\t\t\tjuexingji: true,\r\n\t\t\tskillAnimation: true,\r\n\t\t\tanimationColor: \"thunder\",\r\n\t\t\tunique: true,\r\n\t\t\ttrigger: { player: \"phaseZhunbeiBegin\" },\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn player.storage.qianxianmrfz?.length >= 5;\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tplayer.awakenSkill(event.name);\r\n\t\t\t\tplayer.recoverTo(3);\r\n\t\t\t\tawait player.draw(player.storage.qianxianmrfz.length);\r\n\t\t\t\tplayer.storage.qianxianmrfz = [];\r\n\t\t\t\tplayer.addSkill(\"dunkongmrfz\");\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\tcombo: \"qianxianmrfz\",\r\n\t\t\t},\r\n\t\t},\r\n\t\tdunkongmrfz: {\r\n\t\t\taudio: \"zhishuimrfz\",\r\n\t\t\tenable: \"phaseUse\",\r\n\t\t\tusable: 1,\r\n\t\t\tonremove(player, skill) {\r\n\t\t\t\tplayer.enableSkill(skill);\r\n\t\t\t},\r\n\t\t\tintro: {\r\n\t\t\t\tcontent(_, player) {\r\n\t\t\t\t\tlet num = Math.min(5, player.storage.qianxianmrfz.length);\r\n\t\t\t\t\treturn `·使用【杀】的次数+${num}<br>·手牌上限+${num}<br>·计算与其他角色的距离-${num}`;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tlet numx = Math.min(5, player.storage.qianxianmrfz.length);\r\n\t\t\t\tplayer.draw(numx);\r\n\t\t\t\tplayer.disableSkill(\"dunkongmrfz\", \"qianxianmrfz\");\r\n\t\t\t\tplayer.markSkill(\"dunkongmrfz\");\r\n\t\t\t\tplayer\r\n\t\t\t\t\t.when(\"phaseEnd\")\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tplayer.enableSkill(\"dunkongmrfz\");\r\n\t\t\t\t\t\tplayer.unmarkSkill(\"dunkongmrfz\");\r\n\t\t\t\t\t\tif (player.storage.qianxianmrfz?.length > 0) {\r\n\t\t\t\t\t\t\tplayer.storage.qianxianmrfz.remove(player.storage.qianxianmrfz.randomGet());\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.assign({\r\n\t\t\t\t\t\tmod: {\r\n\t\t\t\t\t\t\tmaxHandcard(player, num) {\r\n\t\t\t\t\t\t\t\treturn num + numx;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tcardUsable(card, player, num) {\r\n\t\t\t\t\t\t\t\tif (card.name === \"sha\") return num + numx;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tglobalFrom(from, to, distance) {\r\n\t\t\t\t\t\t\t\treturn distance - numx;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\torder: 13,\r\n\t\t\t\tresult: {\r\n\t\t\t\t\tplayer(player) {\r\n\t\t\t\t\t\treturn player.storage.qianxianmrfz.length > 1;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\t//斩业星熊\r\n\t\t/** @type { Skill } */\r\n\t\twozhimrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\ttrigger: {\r\n\t\t\t\tplayer: [\"changeHp\"],\r\n\t\t\t},\r\n\t\t\tforced: true,\r\n\t\t\tlocked: true,\r\n\t\t\tmod: {\r\n\t\t\t\tmaxHandcardBase(player, num) {\r\n\t\t\t\t\treturn player.storage.zhanyemrfz ? player.maxHp : num;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tinit(player) {\r\n\t\t\t\t//@ts-ignore设置getter和setter来更新hp显示\r\n\t\t\t\tplayer._hp = player.hp;\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tplayer._maxHp = player.maxHp;\r\n\t\t\t\tlet isUpdateHp = false;\r\n\t\t\t\tlet isUpdateMaxHp = false;\r\n\t\t\t\tskillCustomFunc.defineAccessor(\r\n\t\t\t\t\tplayer,\r\n\t\t\t\t\t[\"hp\", \"maxHp\"],\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t[() => player._hp, () => player._maxHp],\r\n\t\t\t\t\t[\r\n\t\t\t\t\t\tvalue => {\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tplayer._hp = value;\r\n\t\t\t\t\t\t\tif (!isUpdateHp) {\r\n\t\t\t\t\t\t\t\tisUpdateHp = true;\r\n\t\t\t\t\t\t\t\tlib.skill.wozhimrfz.updateHp(player);\r\n\t\t\t\t\t\t\t\tisUpdateHp = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tvalue => {\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tplayer._maxHp = value;\r\n\t\t\t\t\t\t\tif (!isUpdateMaxHp) {\r\n\t\t\t\t\t\t\t\tisUpdateMaxHp = true;\r\n\t\t\t\t\t\t\t\tlib.skill.wozhimrfz.updateHp(player);\r\n\t\t\t\t\t\t\t\tisUpdateMaxHp = false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t]\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tintro: {\r\n\t\t\t\tcontent(storage, player) {\r\n\t\t\t\t\tlet str = [];\r\n\t\t\t\t\tif (player.storage.zhanyemrfz) str.push(\"我执已修改\");\r\n\t\t\t\t\tif (typeof storage !== \"number\" || storage === 0) str.push(\"体力值目前十分健康！\");\r\n\t\t\t\t\telse str.push(`额外体力：${player.maxHp - storage}/${player.maxHp}`);\r\n\t\t\t\t\treturn str.map(s => \"·\" + s).join(\"<br>\");\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tonremove(player, skill) {\r\n\t\t\t\tif (player.hp <= 0 && player.countMark(\"wozhimrfz\") > 0) {\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tplayer.die({});\r\n\t\t\t\t\tdelete player.storage[skill];\r\n\t\t\t\t}\r\n\t\t\t\tlib.skill.wozhimrfz.updateHp(player);\r\n\t\t\t},\r\n\t\t\tupdateHp(player) {\r\n\t\t\t\tlet num = player.countMark(\"wozhimrfz\");\r\n\r\n\t\t\t\tconst hp = player.querySelector(\".hp\");\r\n\t\t\t\tlet clone = player.querySelector(\".hpClone\") || tmpSave.spxingxiong_clone;\r\n\t\t\t\tconst cloneMaxhp = clone?.children?.length;\r\n\r\n\t\t\t\tif (cloneMaxhp !== player.maxHp && clone) {\r\n\t\t\t\t\tclone.remove();\r\n\t\t\t\t\tdelete tmpSave.spxingxiong_clone;\r\n\t\t\t\t\tlib.skill.wozhimrfz.updateHp(player);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (player.hp <= 0) {\r\n\t\t\t\t\tif (!clone) {\r\n\t\t\t\t\t\tconst parent = hp.parentNode;\r\n\t\t\t\t\t\tconst hpClone = ui.create.div(\".hp hpClone\", parent);\r\n\t\t\t\t\t\thpClone.style.zIndex = \"114514\";\r\n\t\t\t\t\t\thpClone.dataset.condition = \"low\";\r\n\r\n\t\t\t\t\t\tfor (let i = 0; i < player.maxHp; i++) {\r\n\t\t\t\t\t\t\tui.create.div(hpClone);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tclone = hpClone;\r\n\r\n\t\t\t\t\t\ttmpSave.spxingxiong_clone = clone;\r\n\t\t\t\t\t}\r\n\t\t\t\t\thp.style.display = \"none\";\r\n\t\t\t\t\tlet hps = Array.from(clone.childNodes);\r\n\t\t\t\t\tif (!hps) return;\r\n\t\t\t\t\tfor (let i = 0; i < hps.length; i++) {\r\n\t\t\t\t\t\tif (i < num) hps[i].classList.remove(\"lost\");\r\n\t\t\t\t\t\telse hps[i].classList.add(\"lost\");\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\thp.style.display = \"\";\r\n\t\t\t\t\tif (clone !== void 0) {\r\n\t\t\t\t\t\tclone.remove();\r\n\t\t\t\t\t\tdelete tmpSave.spxingxiong_clone;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.update();\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn player.hp <= 0 && event.num < 0;\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tconst evt = trigger;\r\n\t\t\t\tconst num = -evt.num - Math.max(player.hp - evt.num, 1) + 1;\r\n\t\t\t\tif (num > 0) player.addMark(\"wozhimrfz\", num);\r\n\r\n\t\t\t\tif (player.countMark(\"wozhimrfz\") < player.maxHp) {\r\n\t\t\t\t\t/** @type { GameEvent } */\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tlet evt2 = evt.getParent();\r\n\t\t\t\t\tlet max = 3;\r\n\t\t\t\t\twhile (max--) {\r\n\t\t\t\t\t\tif (evt2.name === \"damage\" || evt2.name === \"loseHp\") {\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tevt2.nodying = true;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlib.skill.wozhimrfz.updateHp(player);\r\n\t\t\t},\r\n\t\t\tgroup: [\"wozhimrfz_recover\", \"wozhimrfz_change\"],\r\n\t\t\tsubSkill: {\r\n\t\t\t\tchange: {\r\n\t\t\t\t\taudio: \"wozhimrfz\",\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tplayer: \"phaseAfter\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tforced: true,\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\treturn player.hp < 1 && player.storage.zhanyemrfz;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tplayer.recover();\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\trecover: {\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tplayer: \"recoverAfter\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\treturn player.countMark(\"wozhimrfz\") > 0 && event.num > 0;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tforced: true,\r\n\t\t\t\t\tpopup: false,\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tawait player.removeMark(\"wozhimrfz\", trigger.num);\r\n\r\n\t\t\t\t\t\tif (player.countMark(\"wozhimrfz\") < player.maxHp) {\r\n\t\t\t\t\t\t\tif (player.isDying()) {\r\n\t\t\t\t\t\t\t\tconst histories = [event];\r\n\t\t\t\t\t\t\t\tlet evt = event;\r\n\t\t\t\t\t\t\t\twhile (true) {\r\n\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\t\tevt = event.getParent(\"dying\");\r\n\t\t\t\t\t\t\t\t\tif (!evt || evt.name !== \"dying\" || histories.includes(evt)) {\r\n\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\thistories.push(evt);\r\n\t\t\t\t\t\t\t\t\tif (evt.player === player) {\r\n\t\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\t\t\tevt.nodying = true;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tlib.skill.wozhimrfz.updateHp(player);\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\tmingzhi: true,\r\n\t\t\t\teffect: {\r\n\t\t\t\t\ttarget(card, player, target) {\r\n\t\t\t\t\t\tif (get.tag(card, \"damage\") || get.tag(card, \"losehp\")) {\r\n\t\t\t\t\t\t\tlet num = target.countMark(\"wozhimrfz\") || target.getHp();\r\n\t\t\t\t\t\t\treturn (num + 1) / 3;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tguishimrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\tlocked(skill, player) {\r\n\t\t\t\tif (!player || !player.storage.zhanyemrfz) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\ttrigger: {\r\n\t\t\t\tplayer: \"phaseUseBegin\",\r\n\t\t\t},\r\n\t\t\tasync cost(event, trigger, player) {\r\n\t\t\t\tif (!player.storage.zhanyemrfz) {\r\n\t\t\t\t\tevent.result = {\r\n\t\t\t\t\t\tbool: true,\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tevent.result = await player\r\n\t\t\t\t\t.chooseTarget()\r\n\t\t\t\t\t.set(\"prompt\", get.prompt(\"guishimrfz\"))\r\n\t\t\t\t\t.set(\r\n\t\t\t\t\t\t\"prompt2\",\r\n\t\t\t\t\t\t`你可以失去一点体力，然后令一名角色摸${get.cnNumber(Math.min(player.getDamagedHp(), 5))}张牌，若该角色不为你，你可以在结束阶段再次发动【鬼势】`\r\n\t\t\t\t\t)\r\n\t\t\t\t\t.set(\"ai\", target => {\r\n\t\t\t\t\t\tlet player = get.player();\r\n\t\t\t\t\t\tlet num = Math.max(player.hp, 0);\r\n\t\t\t\t\t\tif (player.hasSkill(\"wozhimrfz\")) {\r\n\t\t\t\t\t\t\tnum += player.maxHp - player.countMark(\"wozhimrfz\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn get.attitude2(target) > 0 && num >= 2;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.set(\"animate\", false)\r\n\t\t\t\t\t.forResult();\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tif (!player.storage.zhanyemrfz) {\r\n\t\t\t\t\tawait player.loseHp();\r\n\t\t\t\t\tplayer.draw(player.getDamagedHp());\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet target = event.targets[0];\r\n\t\t\t\t\tawait player.loseHp();\r\n\t\t\t\t\ttarget.draw(Math.min(5, player.getDamagedHp()));\r\n\t\t\t\t\tif (player !== target) {\r\n\t\t\t\t\t\tplayer.line(target);\r\n\t\t\t\t\t\tplayer\r\n\t\t\t\t\t\t\t.when({\r\n\t\t\t\t\t\t\t\tplayer: [\"phaseJieshuBegin\", \"phaseEnd\"],\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.step(async (event, trigger, player) => {\r\n\t\t\t\t\t\t\t\tif (trigger.name === \"phase\") return;\r\n\t\t\t\t\t\t\t\tconst { targets } = await player\r\n\t\t\t\t\t\t\t\t\t.chooseTarget()\r\n\t\t\t\t\t\t\t\t\t.set(\"prompt\", get.prompt(\"guishimrfz\"))\r\n\t\t\t\t\t\t\t\t\t.set(\"prompt2\", `你可以失去一点体力，然后令一名角色摸${get.cnNumber(Math.min(4, player.getDamagedHp()))}张牌`)\r\n\t\t\t\t\t\t\t\t\t.set(\"ai\", target => {\r\n\t\t\t\t\t\t\t\t\t\tlet player = get.player();\r\n\t\t\t\t\t\t\t\t\t\tlet num = Math.max(player.hp, 0);\r\n\t\t\t\t\t\t\t\t\t\tif (player.hasSkill(\"wozhimrfz\")) {\r\n\t\t\t\t\t\t\t\t\t\t\tnum += player.maxHp - player.countMark(\"wozhimrfz\");\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\treturn get.attitude2(target) > 0 && num >= 2;\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t.set(\"animate\", false)\r\n\t\t\t\t\t\t\t\t\t.forResult();\r\n\t\t\t\t\t\t\t\tif (!targets) return;\r\n\t\t\t\t\t\t\t\tawait player.loseHp();\r\n\t\t\t\t\t\t\t\ttargets[0].draw(Math.min(4, player.getDamagedHp()));\r\n\t\t\t\t\t\t\t\tplayer.line(targets[0]);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\t\tzhanyemrfz: {\r\n\t\t\taudio: 4,\r\n\t\t\tderivation: [\"wozhimrfz_rewrite\", \"guishimrfz_rewrite\"],\r\n\t\t\tdutySkill: true,\r\n\t\t\tgroup: [\"zhanyemrfz_revenge\", \"zhanyemrfz_achieve\", \"zhanyemrfz_fail\"],\r\n\t\t\tsubSkill: {\r\n\t\t\t\trevenge: {\r\n\t\t\t\t\taudio: true,\r\n\t\t\t\t\tlogAudio() {\r\n\t\t\t\t\t\tlet path = lib.skill.zhanyemrfz.logAudio ? lib.skill.zhanyemrfz.logAudio() : lib.skill.zhanyemrfz.audio;\r\n\t\t\t\t\t\tpath = path.replace(path.slice(-2), \"\");\r\n\t\t\t\t\t\treturn [1, 2].map(i => path + `/zhanyemrfz${i}.mp3`);\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tglobal: \"phaseBefore\",\r\n\t\t\t\t\t\tplayer: \"enterGame\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonremove: true,\r\n\t\t\t\t\tmod: {\r\n\t\t\t\t\t\ttargetInRange(card, player, target) {\r\n\t\t\t\t\t\t\tif (player.getStorage(\"zhanyemrfz_revenge\").includes(target)) {\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcardUsableTarget(card, player, target) {\r\n\t\t\t\t\t\t\tif (player.getStorage(\"zhanyemrfz_revenge\").includes(target)) {\r\n\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tintro: {\r\n\t\t\t\t\t\tmark(dialog, content, player) {\r\n\t\t\t\t\t\t\tlet targets = player.storage.zhanyemrfz_revenge;\r\n\t\t\t\t\t\t\tif (targets) {\r\n\t\t\t\t\t\t\t\ttargets.forEach(target => {\r\n\t\t\t\t\t\t\t\t\tdialog.addSmall([target]);\r\n\t\t\t\t\t\t\t\t\tdialog.addText(`<font color=\"red\">向${get.translation(target)}复仇！</font>`);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tdialog.addText(\"无“业”角色\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tlocked: true,\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\treturn game.hasPlayer(current => current !== player) && (event.name !== \"phase\" || game.phaseNumber === 0);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync cost(event, trigger, player) {\r\n\t\t\t\t\t\tevent.result = await player\r\n\t\t\t\t\t\t\t.chooseTarget()\r\n\t\t\t\t\t\t\t.set(\"filterTarget\", lib.filter.notMe)\r\n\t\t\t\t\t\t\t.set(\"prompt\", \"游戏开始时，你令一名其他角色获得“业”标记，你对有“业”标记的角色使用牌无次数和距离限制。\")\r\n\t\t\t\t\t\t\t.set(\"forced\", true)\r\n\t\t\t\t\t\t\t.set(\"ai\", function (target) {\r\n\t\t\t\t\t\t\t\tlet att = get.attitude(_status.event.player, target);\r\n\t\t\t\t\t\t\t\tif (att > 0) {\r\n\t\t\t\t\t\t\t\t\treturn -att - 1;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tif (att === 0) {\r\n\t\t\t\t\t\t\t\t\treturn Math.random();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn -att;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.set(\"animate\", false)\r\n\t\t\t\t\t\t\t.forResult();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tlet targets = event.targets;\r\n\t\t\t\t\t\tif (!player.storage.zhanyemrfz_revenge) player.storage.zhanyemrfz_revenge = [];\r\n\t\t\t\t\t\tplayer.storage.zhanyemrfz_revenge.add(...targets);\r\n\t\t\t\t\t\tplayer.line(targets);\r\n\t\t\t\t\t\tplayer.markSkill(\"zhanyemrfz_revenge\");\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tfail: {\r\n\t\t\t\t\taudio: true,\r\n\t\t\t\t\tlogAudio() {\r\n\t\t\t\t\t\tlet path = lib.skill.zhanyemrfz.logAudio ? lib.skill.zhanyemrfz.logAudio() : lib.skill.zhanyemrfz.audio;\r\n\t\t\t\t\t\tpath = path.replace(path.slice(-2), \"\");\r\n\t\t\t\t\t\treturn path + `/zhanyemrfz3.mp3`;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tforced: true,\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tglobal: \"dieAfter\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tgame.log(player, \"使命失败\");\r\n\t\t\t\t\t\tplayer.awakenSkill(\"zhanyemrfz\");\r\n\t\t\t\t\t\tplayer.unmarkSkill(\"zhanyemrfz_revenge\");\r\n\r\n\t\t\t\t\t\tlet copy = game.players.filter(c => c !== player);\r\n\t\t\t\t\t\tfor (let i = 0; i < 5; i++) {\r\n\t\t\t\t\t\t\tlet targets = game.filterPlayer(c => isMinHp(c, copy) && c !== player);\r\n\t\t\t\t\t\t\tawait player\r\n\t\t\t\t\t\t\t\t.chooseUseTarget({ name: \"sha\", isCard: true })\r\n\t\t\t\t\t\t\t\t.set(\"filterTarget\", (card, player, target) => {\r\n\t\t\t\t\t\t\t\t\treturn targets.includes(target);\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t.set(\"forced\", true)\r\n\t\t\t\t\t\t\t\t.set(\"nodistance\", true)\r\n\t\t\t\t\t\t\t\t.set(\"addCount\", false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tplayer.loseMaxHp(2);\r\n\r\n\t\t\t\t\t\tfunction isMinHp(player, players, only, raw) {\r\n\t\t\t\t\t\t\treturn players.every(value => {\r\n\t\t\t\t\t\t\t\tif (value.isOut() || value == player) {\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\treturn only ? value.getHp(raw) > player.getHp(raw) : value.getHp(raw) >= player.getHp(raw);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tachieve: {\r\n\t\t\t\t\taudio: true,\r\n\t\t\t\t\tlogAudio() {\r\n\t\t\t\t\t\tlet path = lib.skill.zhanyemrfz.logAudio ? lib.skill.zhanyemrfz.logAudio() : lib.skill.zhanyemrfz.audio;\r\n\t\t\t\t\t\tpath = path.replace(path.slice(-2), \"\");\r\n\t\t\t\t\t\treturn path + `/zhanyemrfz4.mp3`;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tforced: true,\r\n\t\t\t\t\tskillAnimation: true,\r\n\t\t\t\t\tanimationColor: \"metal\",\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tsource: \"damageEnd\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\treturn player.getStorage(\"zhanyemrfz_revenge\").includes(event.player) && event.player.isAlive() && event.player.hp === 1;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tgame.log(player, \"成功完成使命\");\r\n\t\t\t\t\t\tplayer.awakenSkill(\"zhanyemrfz\");\r\n\t\t\t\t\t\tplayer.unmarkSkill(\"zhanyemrfz_revenge\");\r\n\t\t\t\t\t\tplayer.storage.zhanyemrfz = true;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\t//遥 羽生萌萌香 紫野遥\r\n\t\tyoulinmrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\tenable: \"phaseUse\",\r\n\t\t\tusable(skill, player) {\r\n\t\t\t\treturn player.hasSkill(\"youlinmrfz_addCount\") ? 2 : 1;\r\n\t\t\t},\r\n\t\t\tfilterCard: true,\r\n\t\t\tselectCard: [0, 3],\r\n\t\t\tfilterTarget: true,\r\n\t\t\tselectTarget: [1, 3],\r\n\t\t\tdiscard: false,\r\n\t\t\tlose: false,\r\n\t\t\tdelay: 0,\r\n\t\t\tmultitarget: true,\r\n\t\t\tmultiline: true,\r\n\t\t\tcheck(card) {\r\n\t\t\t\tif (ui.selected.cards.length < 1) return true;\r\n\t\t\t\tlet num = 0;\r\n\t\t\t\tfor (let i of [\"type2\", \"number\", \"suit\"]) {\r\n\t\t\t\t\tif (!isInclude(i)) {\r\n\t\t\t\t\t\tnum++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn num;\r\n\r\n\t\t\t\tfunction isInclude(method) {\r\n\t\t\t\t\treturn ui.selected.cards.map(cardx => get[method](cardx)).includes(get[method](card));\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tlet { cards, targets } = event,\r\n\t\t\t\t\tpileCards = [],\r\n\t\t\t\t\tshowCards = [];\r\n\t\t\t\tlet duplicateRemove = (arr, method) => Array.from(new Set(arr.map(card => get[method](card))));\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tif (cards.length < 3) pileCards.push(...get.cards(3 - cards.length));\r\n\t\t\t\tshowCards = [...cards, ...pileCards];\r\n\t\t\t\tlet execute = [];\r\n\t\t\t\tif (duplicateRemove(showCards, \"number\").length === 3) execute.push(\"number\");\r\n\t\t\t\tif (duplicateRemove(showCards, \"suit\").length === 3) execute.push(\"suit\");\r\n\t\t\t\tif (duplicateRemove(showCards, \"type2\").length === 3) execute.push(\"type\");\r\n\t\t\t\tlet num = execute.length;\r\n\t\t\t\tlet tips = {\r\n\t\t\t\t\tnumber: \"<font color='red'>点数均不同</font>\",\r\n\t\t\t\t\tsuit: \"<font color='yellow'>花色均不同</font>\",\r\n\t\t\t\t\ttype: \"<font color='green'>类型均不同</font>\",\r\n\t\t\t\t};\r\n\t\t\t\tlet str = [];\r\n\t\t\t\tfor (let i of execute) {\r\n\t\t\t\t\tstr.push(tips[i]);\r\n\t\t\t\t}\r\n\t\t\t\tawait player.showCards(showCards, `${get.translation(player)}【游鳞】展示的牌<br>${str.join(\"<br>\")}`);\r\n\t\t\t\tgame.delay(2);\r\n\t\t\t\tif (num > 0) {\r\n\t\t\t\t\tfor (let name of execute) {\r\n\t\t\t\t\t\tswitch (name) {\r\n\t\t\t\t\t\t\tcase \"number\":\r\n\t\t\t\t\t\t\t\ttargets.forEach(t => t.changeHujia());\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase \"suit\":\r\n\t\t\t\t\t\t\t\ttargets.forEach(t => t.draw(num));\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase \"type\":\r\n\t\t\t\t\t\t\t\tplayer.addTempSkill(\"youlinmrfz_addCount\", { player: [\"phaseUseEnd\", \"phaseEnd\"] });\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (num - cards.length > 0) targets.forEach(t => t.addMark(\"fuyingmrfz\", num - cards.length));\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\torder: 13,\r\n\t\t\t\tresult: {\r\n\t\t\t\t\tplayer: 1,\r\n\t\t\t\t\ttarget: 1,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tsubSkill: {\r\n\t\t\t\taddCount: {\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tmiaomengmrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\ttrigger: {\r\n\t\t\t\tplayer: \"phaseZhunbeiBegin\",\r\n\t\t\t},\r\n\t\t\tprompt(event, player) {\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tlet num = Math.min(5, Math.max(game.countMark(\"fuyingmrfz\"), 1));\r\n\t\t\t\treturn `【渺梦】:你可以观看牌堆顶${num}张牌，并可以将游戏外随机的三张不同花色、类型的牌（进入弃牌堆后销毁之）插入到这些牌之中，然后你获得等同与你插入的牌的数量的个“沫”标记。`;\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tconst num = Math.min(5, Math.max(game.countMark(\"fuyingmrfz\"), 1));\r\n\t\t\t\tlet suits = [...lib.suit],\r\n\t\t\t\t\ttypes = [\"basic\", \"trick\", \"equip\"];\r\n\t\t\t\tlet outCards = [];\r\n\t\t\t\tlet pileCards = get.cards(num);\r\n\t\t\t\tfor (let type of types) {\r\n\t\t\t\t\tlet name = lib.inpile.filter(n => get.type2(n) === type).randomGet();\r\n\t\t\t\t\tlet suit = suits.randomGet();\r\n\t\t\t\t\tsuits.remove(suit);\r\n\t\t\t\t\toutCards.push(game.createCard(name, suit, [1, 3, 5, 8, 12].randomGet()));\r\n\t\t\t\t}\r\n\t\t\t\tlet { moved } = await player\r\n\t\t\t\t\t.chooseToMove()\r\n\t\t\t\t\t.set(\"list\", [\r\n\t\t\t\t\t\t[\"牌堆顶\", pileCards],\r\n\t\t\t\t\t\t[\"游戏外的牌\", outCards],\r\n\t\t\t\t\t])\r\n\t\t\t\t\t.set(\"prompt\", `你可以将游戏外随机的三张不同花色、类型的牌（进入弃牌堆后销毁之）插入到这些牌之中`)\r\n\t\t\t\t\t.set(\"filterMove\", (from, to, moved) => {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tlet pile = get.event().pileCards;\r\n\t\t\t\t\t\tlet fakeMoved = [moved[0].slice(), moved[1].slice()];\r\n\t\t\t\t\t\tif (typeof to !== \"number\") {\r\n\t\t\t\t\t\t\tlet fromPos = findElementPosition(fakeMoved, from.link);\r\n\t\t\t\t\t\t\tlet toPos = findElementPosition(fakeMoved, to.link);\r\n\r\n\t\t\t\t\t\t\tif (fromPos && toPos) {\r\n\t\t\t\t\t\t\t\t[fakeMoved[fromPos.arrayIndex][fromPos.elementIndex], fakeMoved[toPos.arrayIndex][toPos.elementIndex]] = [\r\n\t\t\t\t\t\t\t\t\tfakeMoved[toPos.arrayIndex][toPos.elementIndex],\r\n\t\t\t\t\t\t\t\t\tfakeMoved[fromPos.arrayIndex][fromPos.elementIndex],\r\n\t\t\t\t\t\t\t\t];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (fakeMoved[0].includes(from.link)) fakeMoved[0].remove(from.link);\r\n\t\t\t\t\t\t\tif (fakeMoved[1].includes(from.link)) fakeMoved[1].remove(from.link);\r\n\t\t\t\t\t\t\tfakeMoved[to].push(from.link);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlet adjusted = fakeMoved[0].filter(card => pile.includes(card));\r\n\t\t\t\t\t\treturn JSON.stringify(pile) === JSON.stringify(adjusted);\r\n\r\n\t\t\t\t\t\tfunction findElementPosition(arrays, element) {\r\n\t\t\t\t\t\t\tfor (let i = 0; i < arrays.length; i++) {\r\n\t\t\t\t\t\t\t\tlet index = arrays[i].indexOf(element);\r\n\t\t\t\t\t\t\t\tif (index !== -1) {\r\n\t\t\t\t\t\t\t\t\treturn { arrayIndex: i, elementIndex: index };\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.set(\"filterOk\", () => {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tlet outs = get.event().outCards;\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tlet buttons = Array.from(get.event().buttonss[0].children).concat(Array.from(get.event().buttonss[1].children));\r\n\t\t\t\t\t\tbuttons.forEach(button => {\r\n\t\t\t\t\t\t\tlet link = button.link;\r\n\t\t\t\t\t\t\tif (!outs.includes(link)) {\r\n\t\t\t\t\t\t\t\tlet tag = button.querySelector(\".info\");\r\n\t\t\t\t\t\t\t\tif (tag) tag.innerHTML = \"不可改变顺序\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.set(\"processAI\", list => {\r\n\t\t\t\t\t\tconst player = get.event().player;\r\n\t\t\t\t\t\tlet pile = [...list[0][1]];\r\n\t\t\t\t\t\tlet outs = [...list[1][1]];\r\n\t\t\t\t\t\tfor (let card of outs) {\r\n\t\t\t\t\t\t\tlet insertIndex = pile.findIndex(cardx => get.value(cardx) < get.value(card));\r\n\t\t\t\t\t\t\tif (insertIndex === -1) {\r\n\t\t\t\t\t\t\t\tpile.push(card);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tpile.insert(insertIndex, card, false);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlet moved = [pile, outs];\r\n\t\t\t\t\t\treturn moved;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.set(\"outCards\", outCards)\r\n\t\t\t\t\t.set(\"pileCards\", pileCards)\r\n\t\t\t\t\t.forResult();\r\n\t\t\t\tif (!moved) return;\r\n\t\t\t\tlet top = moved[0];\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tlet count = top.length - pileCards.length;\r\n\r\n\t\t\t\tplayer.addMark(\"fuyingmrfz\", count);\r\n\r\n\t\t\t\ttop.reverse();\r\n\t\t\t\tfor (let i = 0; i < top.length; i++) {\r\n\t\t\t\t\tui.cardPile.insertBefore(top[i], ui.cardPile.firstChild);\r\n\t\t\t\t}\r\n\t\t\t\tgame.log(player, \"将\" + get.cnNumber(top.length) + \"张牌置于牌堆顶\");\r\n\t\t\t\tgame.updateRoundNumber();\r\n\t\t\t\tgame.delayx();\r\n\t\t\t},\r\n\t\t},\r\n\t\tfuyingmrfz: {\r\n\t\t\tforced: true,\r\n\t\t\taudio: 2,\r\n\t\t\tmark: true,\r\n\t\t\tmarktext: \"沫\",\r\n\t\t\tintro: {\r\n\t\t\t\tname: \"沫\",\r\n\t\t\t\tcontent: '有#个“沫”标记<br><span style=\"color:rgb(138,43,226);font-family:yuanli\">人生五十年，如梦亦如幻。</span>',\r\n\t\t\t},\r\n\t\t\ttrigger: {\r\n\t\t\t\tglobal: \"dying\",\r\n\t\t\t},\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn event.player.isAlive() && event.player.hasMark(\"fuyingmrfz\");\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tplayer.$fullscreenpop(\"泡泡破裂了...\", \"thunder\");\r\n\t\t\t\tfor (let target of game.players.sortBySeat(trigger.player).filter(c => c.hasMark(\"fuyingmrfz\"))) {\r\n\t\t\t\t\tconst { bool } =\r\n\t\t\t\t\t\ttarget.countMark(\"fuyingmrfz\") > target.countCards(\"he\")\r\n\t\t\t\t\t\t\t? { bool: false }\r\n\t\t\t\t\t\t\t: await target\r\n\t\t\t\t\t\t\t\t\t.chooseToDiscard(\"he\")\r\n\t\t\t\t\t\t\t\t\t.set(\"filterCard\", card => {\r\n\t\t\t\t\t\t\t\t\t\tlet cards = ui.selected.cards;\r\n\t\t\t\t\t\t\t\t\t\tif (cards.length > 1) {\r\n\t\t\t\t\t\t\t\t\t\t\treturn cards.every(cardx => get.suit(card) !== get.suit(cardx));\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t.set(\"ai\", card => {\r\n\t\t\t\t\t\t\t\t\t\treturn Math.abs(get.value(card, player) - 10000);\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t.set(\"complexCard\", true)\r\n\t\t\t\t\t\t\t\t\t.set(\"selectCard\", target.countMark(\"fuyingmrfz\"))\r\n\t\t\t\t\t\t\t\t\t.set(\r\n\t\t\t\t\t\t\t\t\t\t\"prompt\",\r\n\t\t\t\t\t\t\t\t\t\t`请弃置${target.countMark(\"fuyingmrfz\")}张花色不同的牌或失去${target.countMark(\"fuyingmrfz\")}点体力`\r\n\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t.forResult();\r\n\t\t\t\t\tif (bool === false) target.loseHp(target.countMark(\"fuyingmrfz\"));\r\n\t\t\t\t\ttarget.removeMark(\"fuyingmrfz\", target.countMark(\"fuyingmrfz\"));\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\tneg: true,\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\t// 电弧\r\n\t\tgandianmrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\tforced: true,\r\n\t\t\ttrigger: {\r\n\t\t\t\tglobal: \"roundStart\",\r\n\t\t\t},\r\n\t\t\tinit(player) {\r\n\t\t\t\tgame.broadcastAll(() => {\r\n\t\t\t\t\tlib.translate[\"gandianmrfz_zhou\"] = \"小轴\";\r\n\t\t\t\t\tlib.translate[\"gandianmrfz_shu\"] = \"小树\";\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t_status.gandianmrfz_ig = [];\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tmark: true,\r\n\t\t\tonremove(player) {\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tdelete _status.gandianmrfz_ig;\r\n\t\t\t\tdelete player.storage.gandianmrfz;\r\n\t\t\t\tfor (let char of game.players) {\r\n\t\t\t\t\tchar.removeGaintag(\"gandianmrfz_zhou\");\r\n\t\t\t\t\tchar.removeGaintag(\"gandianmrfz_shu\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tintro: {\r\n\t\t\t\tcontent(storage) {\r\n\t\t\t\t\tlet shu = Object.keys(lib.color).remove(storage);\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\treturn `·小树:${get.translation(shu)}<br>·小轴:${get.translation(storage)}<br>·不受影响的角色:${get.translation(_status.gandianmrfz_ig)}`;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tglobal: [\"gandianmrfz_effect\", \"gandianmrfz_effect2\"],\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tfor (let char of game.players) {\r\n\t\t\t\t\tchar.removeGaintag(\"gandianmrfz_zhou\");\r\n\t\t\t\t\tchar.removeGaintag(\"gandianmrfz_shu\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst { control } = await player\r\n\t\t\t\t\t.chooseControl(\"red\", \"black\")\r\n\t\t\t\t\t.set(\"prompt\", \"【感电】：请选择令一种颜色的牌称之为“小轴”，其余颜色的牌则称之为“小树”\")\r\n\t\t\t\t\t.set(\"ai\", () => {\r\n\t\t\t\t\t\treturn \"red\";\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.forResult();\r\n\r\n\t\t\t\tif (control) player.storage.gandianmrfz = control;\r\n\r\n\t\t\t\tgame.broadcastAll(color => {\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t_status.gandianmrfzColor = color;\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t_status.gandianmrfz_ig = [];\r\n\t\t\t\t}, player.storage.gandianmrfz);\r\n\r\n\t\t\t\tfor (let char of game.players) {\r\n\t\t\t\t\tchar.addGaintag(char.getCards(\"h\", { color: player.storage.gandianmrfz }), \"gandianmrfz_zhou\");\r\n\t\t\t\t\tchar.addGaintag(\r\n\t\t\t\t\t\tchar.getCards(\"h\", card => get.color(card) !== player.storage.gandianmrfz),\r\n\t\t\t\t\t\t\"gandianmrfz_shu\"\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst result = await player\r\n\t\t\t\t\t.chooseCardTarget({\r\n\t\t\t\t\t\tprompt: `【感电】:弃置N张牌并令N-1名角色不受【感电①】的影响且本轮第一个出牌阶段开始时摸X张牌（X=其手牌中“小树”的数量和“小轴”的数量中的最小值）`,\r\n\t\t\t\t\t\tfilterTarget(card, player, target) {\r\n\t\t\t\t\t\t\treturn ui.selected.targets.length - 1 < ui.selected.cards.length;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tselectTarget: [0, Infinity],\r\n\t\t\t\t\t\tfilterCard: true,\r\n\t\t\t\t\t\tselectCard: [0, Infinity],\r\n\t\t\t\t\t\tcomplexCard: true,\r\n\t\t\t\t\t\tcomplexTarget: true,\r\n\t\t\t\t\t\tai1(card) {\r\n\t\t\t\t\t\t\tlet player = get.player();\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tlet num = game.countPlayer(char => get.attitude2(char > 0));\r\n\t\t\t\t\t\t\tif (ui.selected.cards.length >= num) return false;\r\n\t\t\t\t\t\t\treturn 6 - get.value(card, player);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tai2(target) {\r\n\t\t\t\t\t\t\tlet player = get.player();\r\n\t\t\t\t\t\t\tif (target === player) return 114514;\r\n\t\t\t\t\t\t\treturn get.attitude2(target) > 2;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.forResult();\r\n\t\t\t\tlet { targets, cards } = result;\r\n\t\t\t\tgame.broadcastAll(arr => {\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t_status.gandianmrfz_ig.push(...arr);\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t}, targets);\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\ttargets.forEach(target => {\r\n\t\t\t\t\ttarget\r\n\t\t\t\t\t\t.when({\r\n\t\t\t\t\t\t\tplayer: \"phaseUseBegin\",\r\n\t\t\t\t\t\t\tglobal: \"phaseBefore\",\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\tif (trigger.name === \"phaseUse\") {\r\n\t\t\t\t\t\t\t\tlet shu = player.countCards(\"h\", card => card.hasGaintag(\"gandianmrfz_shu\"));\r\n\t\t\t\t\t\t\t\tlet zhou = player.countCards(\"h\", card => card.hasGaintag(\"gandianmrfz_zhou\"));\r\n\t\t\t\t\t\t\t\tlet num = Math.min(shu, zhou, 5);\r\n\t\t\t\t\t\t\t\tif (num > 0) {\r\n\t\t\t\t\t\t\t\t\tplayer.draw(num);\r\n\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\t\tplayer.logSkill(\"gandianmrfz\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t\tplayer.discard(cards);\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\tviewHandcard: true,\r\n\t\t\t\tskillTagFilter(player, tag, arg) {\r\n\t\t\t\t\tif (player == arg) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tsubSkill: {\r\n\t\t\t\teffect: {\r\n\t\t\t\t\tmod: {\r\n\t\t\t\t\t\tcardRespondable(card, player) {\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tlet ig = _status.gandianmrfz_ig || [];\r\n\t\t\t\t\t\t\tlet evt = _status.event.parent;\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tlet color = _status.gandianmrfzColor;\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tlet isZhou = get.color(evt.card) === color;\r\n\t\t\t\t\t\t\tif ((isZhou && get.color(card) !== color) || ig.includes(player)) return true;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\ttrigger: { player: \"gainAfter\" },\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tlet color = player.storage.gandianmrfz;\r\n\t\t\t\t\t\tfor (let card of trigger.cards) {\r\n\t\t\t\t\t\t\tif (get.color(card) === color) card.addGaintag(\"gandianmrfz_zhou\");\r\n\t\t\t\t\t\t\telse card.addGaintag(\"gandianmrfz_shu\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\teffect2: {\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tplayer: \"useCardToPlayered\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tlet ig = _status.gandianmrfz_ig || [];\r\n\t\t\t\t\t\treturn !ig.includes(event.target);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tconst target = trigger.target;\r\n\t\t\t\t\t\ttarget.addTempSkill(\"gandianmrfz_block\");\r\n\t\t\t\t\t\ttarget.markAuto(\"gandianmrfz_block\", [trigger.card]);\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tblock: {\r\n\t\t\t\t\tmod: {\r\n\t\t\t\t\t\tcardEnabled(card, player) {\r\n\t\t\t\t\t\t\tif (!player.storage.gandianmrfz_block) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconst storage = player.getStorage(\"gandianmrfz_block\");\r\n\t\t\t\t\t\t\tlet evt = get.event();\r\n\t\t\t\t\t\t\tif (evt.name != \"chooseToUse\") {\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tevt = evt.getParent(\"chooseToUse\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tif (!evt || !evt.respondTo || !storage.some(i => i.cardid == evt.respondTo[1].cardid)) {\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconst color = get.color(card);\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tlet zhouColor = _status.gandianmrfzColor;\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\treturn get.color(evt.respondTo[1]) === zhouColor && color !== zhouColor;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tonremove(player) {\r\n\t\t\t\t\t\tdelete player.storage.gandianmrfz_block;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tplayer: [\"damageBefore\", \"damageCancelled\", \"damageZero\"],\r\n\t\t\t\t\t\ttarget: [\"shaMiss\", \"useCardToExcluded\", \"useCardToEnd\"],\r\n\t\t\t\t\t\tglobal: [\"useCardEnd\"],\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\tconst evt = event.getParent(\"useCard\", true, true);\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tif (evt && evt.effectedCount < evt.effectCount) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!event.card || !player.storage.gandianmrfz_block) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn player.getStorage(\"gandianmrfz_block\").includes(event.card);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tforced: true,\r\n\t\t\t\t\tpopup: false,\r\n\t\t\t\t\tfirstDo: true,\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tplayer.unmarkAuto(event.name, [trigger.card]);\r\n\t\t\t\t\t\tif (!player.getStorage(event.name).length) {\r\n\t\t\t\t\t\t\tplayer.removeSkill(event.name);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\t//司霆惊蛰 小姨\r\n\t\txiuyuanmrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\tforced: true,\r\n\t\t\ttrigger: {\r\n\t\t\t\tplayer: \"useCardToPlayered\",\r\n\t\t\t\ttarget: \"useCardToTargeted\",\r\n\t\t\t},\r\n\t\t\tinit() {\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tgame.broadcastAll(() => {\r\n\t\t\t\t\tlib.translate[\"visible_xiuyuanmrfz\"] = \"明置\";\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\tif (!get.tag(event.card, \"damage\") || player.countCards(\"h\", \"ying\") > player.maxHp) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\treturn player === event.target || event.getParent().triggeredTargets3.length === 1;\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tawait player.gain(lib.card.ying.getYing(1), \"gain2\");\r\n\t\t\t\tlet needShown = player.getCards(\"h\", card => get.name(card) === \"ying\" && !get.is.shownCard(card));\r\n\t\t\t\tif (needShown.length > 0) player.addShownCards(needShown, \"visible_xiuyuanmrfz\");\r\n\t\t\t},\r\n\t\t\tmod: {\r\n\t\t\t\tignoredHandcard: function (card, player) {\r\n\t\t\t\t\tif (card.hasGaintag(\"visible_xiuyuanmrfz\")) return true;\r\n\t\t\t\t},\r\n\t\t\t\tcardDiscardable: function (card, player, name) {\r\n\t\t\t\t\tif (name === \"phaseDiscard\" && card.hasGaintag(\"visible_xiuyuanmrfz\")) return false;\r\n\t\t\t\t},\r\n\t\t\t\tglobalTo(from, to, distance) {\r\n\t\t\t\t\tlet num = to.countCards(\"h\", \"ying\");\r\n\t\t\t\t\treturn distance + num;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tzhengningmrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\ttrigger: { player: \"phaseJieshuBegin\" },\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn player.countCards(\"h\", \"ying\") > 0 || game.countPlayer(char => char.isLinked()) > 0;\r\n\t\t\t},\r\n\t\t\tasync cost(event, trigger, player) {\r\n\t\t\t\tlet result = {\r\n\t\t\t\t\tnum: 0,\r\n\t\t\t\t\tdiscards: [],\r\n\t\t\t\t\tlinks: [],\r\n\t\t\t\t};\r\n\t\t\t\tif (player.countCards(\"h\", \"ying\") > 0) {\r\n\t\t\t\t\tconst { cards } = await player\r\n\t\t\t\t\t\t.chooseCard(\"h\")\r\n\t\t\t\t\t\t.set(\"prompt\", get.prompt(\"zhengningmrfz\"))\r\n\t\t\t\t\t\t.set(\r\n\t\t\t\t\t\t\t\"prompt2\",\r\n\t\t\t\t\t\t\t\"<font color = red>选择“确定”即不弃置【影】</font><br>你可以弃置任意张【影】、横置至多等量角色并摸等量张牌，然后你展示所有手牌并令一名横置且本回合未以此法选择过的角色进行判定，若你手牌中有与判定牌花色相同的牌，你可以弃置之并对其造成一点雷属性伤害，若其受到伤害，你可以重复此流程。\"\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t.set(\"filterCard\", card => get.name(card) === \"ying\")\r\n\t\t\t\t\t\t.set(\"selectCard\", [0, Infinity])\r\n\t\t\t\t\t\t.set(\"ai\", card => {\r\n\t\t\t\t\t\t\tlet player = get.player();\r\n\t\t\t\t\t\t\tlet num = game.countPlayer(char => !char.isLinked() && get.effect(char, { name: \"tiesuo\" }, player, player) > -1);\r\n\t\t\t\t\t\t\treturn ui.selected.cards.length < num ? 1 : -1;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.forResult();\r\n\t\t\t\t\tif (cards?.length) {\r\n\t\t\t\t\t\tresult.num = cards.length;\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tresult.discards = cards;\r\n\t\t\t\t\t} else return;\r\n\t\t\t\t}\r\n\t\t\t\tif (result.num > 0) {\r\n\t\t\t\t\tconst { targets } = await player\r\n\t\t\t\t\t\t.chooseTarget()\r\n\t\t\t\t\t\t.set(\"prompt\", get.prompt(\"zhengningmrfz\"))\r\n\t\t\t\t\t\t.set(\"prompt2\", `<font color = red>选择“确定”即不横置角色</font><br>你可以至多横置${get.cnNumber(result.num)}名角色`)\r\n\t\t\t\t\t\t.set(\"filterTarget\", (card, player, target) => !target.isLinked())\r\n\t\t\t\t\t\t.set(\"selectTarget\", [0, result.num])\r\n\t\t\t\t\t\t.set(\"ai\", target => {\r\n\t\t\t\t\t\t\tlet player = get.player();\r\n\t\t\t\t\t\t\treturn get.effect(target, { name: \"tiesuo\" }, player, player) > -1;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.forResult();\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tif (targets && targets.length) result.links = targets;\r\n\t\t\t\t}\r\n\t\t\t\tevent.result = await player\r\n\t\t\t\t\t.chooseTarget()\r\n\t\t\t\t\t.set(\"prompt\", get.prompt(\"zhengningmrfz\"))\r\n\t\t\t\t\t.set(\"prompt2\", `令一名被横置的角色进行判定，然后你可能对其造成一点雷属性伤害`)\r\n\t\t\t\t\t.set(\"filterTarget\", (card, player, target) => {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tlet links = get.event().links;\r\n\t\t\t\t\t\tfor (let char of links) {\r\n\t\t\t\t\t\t\tchar.showPrompt(\"即将被横置\", undefined, true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn target.isLinked() || links.includes(target);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.set(\"ai\", target => {\r\n\t\t\t\t\t\tlet player = get.player();\r\n\t\t\t\t\t\treturn get.damageEffect(target, player, player, \"thunder\") > 0;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.set(\"links\", result.links)\r\n\t\t\t\t\t.forResult();\r\n\t\t\t\tevent.result.cost_data = result;\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tconst target = event.targets[0];\r\n\t\t\t\tconst { discards, links, num } = event.cost_data;\r\n\r\n\t\t\t\tif (num > 0) {\r\n\t\t\t\t\tawait player.discard(discards);\r\n\t\t\t\t\tawait player.draw(num);\r\n\t\t\t\t\tfor (let i of links) await i.link(true);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!target.isLinked()) return;\r\n\r\n\t\t\t\tconst { suit } = await target.judge().forResult();\r\n\t\t\t\tif (player.countCards(\"h\", { suit: suit }) < 1) return;\r\n\t\t\t\tconst { bool } = await player\r\n\t\t\t\t\t.chooseToDiscard()\r\n\t\t\t\t\t.set(\"prompt\", `【震佞】:你可以弃置一张${get.translation(suit)}的牌并对${get.translation(target)}造成一点雷属性伤害`)\r\n\t\t\t\t\t.set(\"ai\", card => 8 - get.value(card))\r\n\t\t\t\t\t.set(\"filterCard\", card => get.suit(card) === suit)\r\n\t\t\t\t\t.forResult();\r\n\t\t\t\tif (bool === true) {\r\n\t\t\t\t\tawait target.damage(\"thunder\", player).set(\"zhengningmrfz\", true);\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tplayer.hasHistory(\"sourceDamage\", evt => {\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\treturn (evt.zhengningmrfz = true);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tlet next = game.createEvent(\"zhengningmrfz\");\r\n\t\t\t\t\t\tnext.player = player;\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tnext.event = event;\r\n\t\t\t\t\t\tnext.setContent(async (event, trigger, player) => {\r\n\t\t\t\t\t\t\tevent.result = {};\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tawait lib.skill.zhengningmrfz.cost(event, trigger, player);\r\n\t\t\t\t\t\t\tif (event.result.bool) {\r\n\t\t\t\t\t\t\t\tevent.targets = event.result.targets;\r\n\t\t\t\t\t\t\t\tevent.cost_data = event.result.cost_data;\r\n\t\t\t\t\t\t\t\tplayer.logSkill(\"zhengningmrfz\");\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tawait lib.skill.zhengningmrfz.content(event, trigger, player);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\t//黍\r\n\t\tkenyemrfz: {\r\n\t\t\tinit: player => {\r\n\t\t\t\tplayer.storage.kenyemrfz = [];\r\n\t\t\t},\r\n\t\t\tmarktext: \"黍\",\r\n\t\t\tintro: {\r\n\t\t\t\tcontent: \"expansion\",\r\n\t\t\t\tmarkcount: \"expansion\",\r\n\t\t\t},\r\n\t\t\tonremove: function (player, skill) {\r\n\t\t\t\tvar cards = player.getExpansions(skill);\r\n\t\t\t\tif (cards.length) player.loseToDiscardpile(cards);\r\n\t\t\t},\r\n\t\t\taudio: 2,\r\n\t\t\ttrigger: { global: \"useCard\" },\r\n\t\t\tfilter: function (event, player) {\r\n\t\t\t\tvar bool = false,\r\n\t\t\t\t\ttype = get.type2(event.card);\r\n\t\t\t\tfor (var i of [\"basic\", \"trick\", \"equip\"]) {\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\ttype === i &&\r\n\t\t\t\t\t\tevent.player\r\n\t\t\t\t\t\t\t.getHistory(\"useCard\", evt => {\r\n\t\t\t\t\t\t\t\treturn get.type2(evt.card) === i;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.indexOf(event) === 0\r\n\t\t\t\t\t) {\r\n\t\t\t\t\t\tbool = true;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (event.cards.length < 1) return false;\r\n\t\t\t\treturn event.cards.filterInD().length > 0 && bool;\r\n\t\t\t},\r\n\t\t\tprompt: function (event, player) {\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\treturn `【垦野】:是否将${get.translation(event.cards)}置于${get.translation(event.player)}的武将牌上?`;\r\n\t\t\t},\r\n\t\t\tprompt2: function () {\r\n\t\t\t\treturn get.skillInfoTranslation(\"kenyemrfz\").replace(/<\\/br>[\\s\\S]*/, \"\");\r\n\t\t\t},\r\n\t\t\tcheck: function (event, player) {\r\n\t\t\t\tif (get.attitude2(event.player) < 0) return false;\r\n\t\t\t\treturn !get.tag(event.card, \"damage\");\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tvar target = trigger.player;\r\n\t\t\t\tif (!player.storage.kenyemrfz) player.storage.kenyemrfz = [];\r\n\t\t\t\tif (!player.storage.kenyemrfz.includes(target)) player.storage.kenyemrfz.add(target);\r\n\r\n\t\t\t\ttarget\r\n\t\t\t\t\t.when({\r\n\t\t\t\t\t\tglobal: [\"damageBegin\", \"phaseEnd\"],\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.filter((event, player) => {\r\n\t\t\t\t\t\tif (event.name === \"phase\") return true;\r\n\t\t\t\t\t\treturn event.cards && event.cards.some(card => cardsx.includes(card));\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.step(async (event, trigger, player) => {\r\n\t\t\t\t\t\tif (trigger.name === \"phase\") return;\r\n\t\t\t\t\t\ttrigger.num = 0;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\tlet cardsx = trigger.cards;\r\n\t\t\t\ttarget\r\n\t\t\t\t\t.when({\r\n\t\t\t\t\t\tglobal: [\"cardsDiscardAfter\", \"phaseEnd\"],\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.filter((event, player) => {\r\n\t\t\t\t\t\tif (event.name === \"phase\") return true;\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tlet bool = event.cards && event.cards.some(card => cardsx.includes(card)) && !event.kenyemrfz_checked;\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tif (bool) event.kenyemrfz_checked = true;\r\n\t\t\t\t\t\treturn bool;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.step(async (event, trigger, player) => {\r\n\t\t\t\t\t\tif (trigger.name === \"phase\") return;\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tplayer.addToExpansion(trigger.cards, player, \"give\").gaintag.add(\"kenyemrfz\");\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.vars({\r\n\t\t\t\t\t\tcardsx: cardsx,\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tglobal: \"kenyemrfz_use\",\r\n\t\t\tsubSkill: {\r\n\t\t\t\tuse: {\r\n\t\t\t\t\ttrigger: { player: \"phaseEnd\" },\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\tdirect: true,\r\n\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\tif (player.getExpansions(\"kenyemrfz\").length < 1) return false;\r\n\t\t\t\t\t\treturn player.canUse(\"wuzhong\", player) || player.canUse(\"tao\", player);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tlet result;\r\n\r\n\t\t\t\t\t\twhile (player.getExpansions(\"kenyemrfz\").length > 0) {\r\n\t\t\t\t\t\t\t// step 0\r\n\t\t\t\t\t\t\tconst list = [];\r\n\t\t\t\t\t\t\tif (player.hasUseTarget(\"tao\")) list.add(\"tao\");\r\n\t\t\t\t\t\t\tif (player.hasUseTarget(\"wuzhong\")) list.add(\"wuzhong\");\r\n\r\n\t\t\t\t\t\t\tif (list.length === 1) {\r\n\t\t\t\t\t\t\t\tawait player.useCard({ name: list[0] }, [player.getExpansions(\"kenyemrfz\")[0]], player);\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tplayer.logSkill(\"kenyemrfz\");\r\n\t\t\t\t\t\t\t} else if (list.length > 1) {\r\n\t\t\t\t\t\t\t\tresult = await player\r\n\t\t\t\t\t\t\t\t\t.chooseBool(\"【垦野】:选择'确定'使用【桃】，选择'取消'使用【无中生有】\")\r\n\t\t\t\t\t\t\t\t\t.set(\"ai\", () => {\r\n\t\t\t\t\t\t\t\t\t\tconst aiPlayer = _status.event.player;\r\n\t\t\t\t\t\t\t\t\t\tif (aiPlayer.hp < 3) return 0;\r\n\t\t\t\t\t\t\t\t\t\treturn [0, 1].randomGet();\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t.forResult();\r\n\r\n\t\t\t\t\t\t\t\t// step 3 (内联，因原流程中 step 3 仅在 chooseBool 后执行)\r\n\t\t\t\t\t\t\t\tif (result.bool) {\r\n\t\t\t\t\t\t\t\t\tawait player.useCard({ name: \"tao\" }, [player.getExpansions(\"kenyemrfz\")[0]], player);\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tawait player.useCard({ name: \"wuzhong\" }, [player.getExpansions(\"kenyemrfz\")[0]], player);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tplayer.logSkill(\"kenyemrfz\");\r\n\t\t\t\t\t\t\t\t// goto(0): while 循环自动回到开头\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tbreak; // 无可用卡牌，结束流程\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// step 1 (原 goto(0) 由 while 循环条件控制)\r\n\t\t\t\t\t\t\t// 循环条件 player.getExpansions(\"kenyemrfz\").length > 0 已隐含此判断\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// 循环条件不满足时自动结束，等价于 event.finish()\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\theyingmrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\ttrigger: { global: \"gainAfter\" },\r\n\t\t\tfilter: function (event, player) {\r\n\t\t\t\tvar evt = event.getParent(\"phaseDraw\");\r\n\t\t\t\tif (evt && evt.player == event.player) return false;\r\n\t\t\t\tif (!event.cards || event.cards.length < 2) return false;\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tif (event.getParent(1).name != \"draw\") return false;\r\n\t\t\t\treturn event.player.hasUseTarget(\"wugu\");\r\n\t\t\t},\r\n\t\t\tusable: 1,\r\n\t\t\tdirect: true,\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tlet result;\r\n\r\n\t\t\t\t// step 0\r\n\t\t\t\tconst target = trigger.player;\r\n\t\t\t\tconst cards = trigger.cards;\r\n\t\t\t\tconst type = [];\r\n\t\t\t\tfor (const card of cards) {\r\n\t\t\t\t\tif (type.includes(get.type2(card))) continue;\r\n\t\t\t\t\ttype.add(get.type2(card));\r\n\t\t\t\t}\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tevent.type = type;\r\n\r\n\t\t\t\tlet skipToStep2 = false;\r\n\t\t\t\tif (target === player) {\r\n\t\t\t\t\tresult = await player\r\n\t\t\t\t\t\t.chooseTarget(\r\n\t\t\t\t\t\t\t`【禾盈】:你可以将${get.translation(trigger.cards)}当做至多指定${get.cnNumber(type.length)}角色且结算${get.cnNumber(type.length)}次的【五谷丰登】使用`\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t.set(\"selectTarget\", [1, type.length])\r\n\t\t\t\t\t\t.set(\"filterTarget\", (card, player, target) => {\r\n\t\t\t\t\t\t\treturn player.canUse(\"wugu\", target);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.set(\"prompt2\", get.skillInfoTranslation(\"heyingmrfz\").replace(/<\\/br>[\\s\\S]*/, \"\"))\r\n\t\t\t\t\t\t.set(\"ai\", target => {\r\n\t\t\t\t\t\t\tconst aiPlayer = _status.event.player;\r\n\t\t\t\t\t\t\tconst aiCards = _status.event.cards;\r\n\t\t\t\t\t\t\tconst num = _status.event.num;\r\n\t\t\t\t\t\t\tif (aiCards.length >= num * 2) return false;\r\n\t\t\t\t\t\t\tif (get.value(aiCards) > 8) return false;\r\n\t\t\t\t\t\t\treturn get.effect(target, get.autoViewAs({ name: \"wugu\" }, aiCards), aiPlayer, aiPlayer);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.set(\"cards\", trigger.cards)\r\n\t\t\t\t\t\t.set(\"num\", event.type.length)\r\n\t\t\t\t\t\t.forResult();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tskipToStep2 = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// step 1 (only if target === player)\r\n\t\t\t\tif (!skipToStep2) {\r\n\t\t\t\t\tif (result && result.targets) {\r\n\t\t\t\t\t\ttrigger.player\r\n\t\t\t\t\t\t\t.when(\"useCard\")\r\n\t\t\t\t\t\t\t.filter((event, player) => {\r\n\t\t\t\t\t\t\t\treturn event.card && get.name(event.card) === \"wugu\" && event.card.storage.heyingmrfz === true;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.step(async (event, trigger, player) => {\r\n\t\t\t\t\t\t\t\ttrigger.effectCount = type.length;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.vars({ type: event.type });\r\n\t\t\t\t\t\tawait trigger.player.useCard({ name: \"wugu\", storage: { heyingmrfz: true } }, trigger.cards, result.targets);\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tplayer.logSkill(\"heyingmrfz\", result.targets);\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tplayer.storage.counttrigger.heyingmrfz--;\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// step 2\r\n\t\t\t\tresult = await player\r\n\t\t\t\t\t.chooseBool(`【禾盈】:是否令${get.translation(trigger.player)}选择是否将此次摸的牌当做五谷丰登使用？`)\r\n\t\t\t\t\t.set(\"ai\", () => {\r\n\t\t\t\t\t\tconst aiPlayer = _status.event.player;\r\n\t\t\t\t\t\tconst aiTarget = _status.event.target;\r\n\t\t\t\t\t\treturn get.attitude(aiTarget, aiPlayer) > 0;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.set(\"prompt2\", get.skillInfoTranslation(\"heyingmrfz\").replace(/<\\/br>[\\s\\S]*/, \"\"))\r\n\t\t\t\t\t.set(\"target\", trigger.player)\r\n\t\t\t\t\t.forResult();\r\n\r\n\t\t\t\t// step 3\r\n\t\t\t\tif (result.bool) {\r\n\t\t\t\t\tresult = await trigger.player\r\n\t\t\t\t\t\t.chooseTarget(\r\n\t\t\t\t\t\t\t`【禾盈】:你可以将${get.translation(trigger.cards)}当做至多指定${get.cnNumber(event.type.length)}角色且结算${get.cnNumber(event.type.length)}次的【五谷丰登】使用`\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t.set(\"selectTarget\", [1, event.type.length])\r\n\t\t\t\t\t\t.set(\"filterTarget\", (card, player, target) => {\r\n\t\t\t\t\t\t\treturn player.canUse(\"wugu\", target);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.set(\"prompt2\", get.skillInfoTranslation(\"heyingmrfz\").replace(/<\\/br>[\\s\\S]*/, \"\"))\r\n\t\t\t\t\t\t.set(\"ai\", target => {\r\n\t\t\t\t\t\t\tconst aiPlayer = _status.event.playerx;\r\n\t\t\t\t\t\t\tconst aiCards = _status.event.cards;\r\n\t\t\t\t\t\t\tconst num = _status.event.num;\r\n\t\t\t\t\t\t\tif (aiCards.length >= num * 2) return false;\r\n\t\t\t\t\t\t\tif (get.value(aiCards) > 8) return false;\r\n\t\t\t\t\t\t\treturn get.effect(target, get.autoViewAs({ name: \"wugu\" }, aiCards), aiPlayer, aiPlayer);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.set(\"cards\", trigger.cards)\r\n\t\t\t\t\t\t.set(\"playerx\", trigger.player)\r\n\t\t\t\t\t\t.set(\"num\", event.type.length)\r\n\t\t\t\t\t\t.forResult();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tplayer.storage.counttrigger.heyingmrfz--;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// step 4\r\n\t\t\t\tif (result.targets) {\r\n\t\t\t\t\ttrigger.player\r\n\t\t\t\t\t\t.when(\"useCard\")\r\n\t\t\t\t\t\t.filter((event, player) => {\r\n\t\t\t\t\t\t\treturn event.card && get.name(event.card) === \"wugu\" && event.card.storage.heyingmrfz === true;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.step(async (event, trigger, player) => {\r\n\t\t\t\t\t\t\ttrigger.effectCount = type.length;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.vars({ type: event.type });\r\n\t\t\t\t\tawait trigger.player.useCard({ name: \"wugu\", storage: { heyingmrfz: true } }, trigger.cards, result.targets);\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\ttrigger.player.logSkill(\"heyingmrfz\", result.targets);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tplayer.storage.counttrigger.heyingmrfz--;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\t\trancuimrfz: {\r\n\t\t\tderivation: \"liangtianmrfz\",\r\n\t\t\taudio: 2,\r\n\t\t\ttrigger: {\r\n\t\t\t\tplayer: \"die\",\r\n\t\t\t},\r\n\t\t\tdirect: true,\r\n\t\t\tskillAnimation: true,\r\n\t\t\tanimationColor: \"wood\",\r\n\t\t\tforceDie: true,\r\n\t\t\tcontent: async function (event, trigger, player) {\r\n\t\t\t\tvar list = player.storage.kenyemrfz;\r\n\t\t\t\tfor (var i of game.players) {\r\n\t\t\t\t\tif (i == player || !list.includes(i)) continue;\r\n\t\t\t\t\ti.addSkill(\"liangtianmrfz\");\r\n\t\t\t\t\ti.line(\"liangtianmrfz\");\r\n\t\t\t\t}\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tplayer.logSkill(\"liangtianmrfz\");\r\n\t\t\t},\r\n\t\t},\r\n\t\tliangtianmrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\tforced: true,\r\n\t\t\ttrigger: { player: \"drawAfter\" },\r\n\t\t\tfilter: function (event, player) {\r\n\t\t\t\tif (player.hasSkill(\"liangtianmrfz_ban\")) return false;\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\treturn event.getParent(2).name != \"liangtianmrfz\";\r\n\t\t\t},\r\n\t\t\tcontent: async function (event, trigger, player) {\r\n\t\t\t\tvar list = [\"phaseZhunbei\", \"phaseJudge\", \"phaseDraw\", \"phaseUse\", \"phaseDiscard\", \"phaseJieshu\"],\r\n\t\t\t\t\tphase;\r\n\t\t\t\tfor (var i of list) {\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tvar evt = trigger.getParent(i).name;\r\n\t\t\t\t\tif (evt == i) {\r\n\t\t\t\t\t\tphase = i;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tvar phase = phase + \"After\";\r\n\t\t\t\tplayer.draw();\r\n\t\t\t\tplayer.addTempSkill(\"liangtianmrfz_ban\", { global: phase });\r\n\t\t\t},\r\n\t\t\tsubSkill: {\r\n\t\t\t\tban: {\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\t//新煌\r\n\t\tnewyanxunmrfz: {\r\n\t\t\taudio: \"yanxunmrfz\",\r\n\t\t\tintro: {\r\n\t\t\t\tcontent: \"本回合手牌上限+#\",\r\n\t\t\t},\r\n\t\t\ttrigger: {\r\n\t\t\t\tplayer: lib.phaseName.map(c => `${c}Skipped`),\r\n\t\t\t},\r\n\t\t\tforced: true,\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tplayer.addMark(\"newyanxunmrfz\", 1, false);\r\n\t\t\t\tplayer.draw();\r\n\t\t\t\tif (!player.storage.newyanxunmrfz_addTempSkill) {\r\n\t\t\t\t\tgame.broadcastAll(player => {\r\n\t\t\t\t\t\tplayer.storage.newyanxunmrfz_addTempSkill = true;\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t}, player);\r\n\t\t\t\t\tplayer\r\n\t\t\t\t\t\t.when({ player: \"phaseEnd\" })\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\tplayer.removeMark(\"newyanxunmrfz\", player.countMark(\"newyanxunmrfz\"), false);\r\n\t\t\t\t\t\t\tgame.broadcastAll(player => {\r\n\t\t\t\t\t\t\t\tdelete player.storage.newyanxunmrfz_addTempSkill;\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t}, player);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.assign({\r\n\t\t\t\t\t\t\tmod: {\r\n\t\t\t\t\t\t\t\tmaxHandcard(player, num) {\r\n\t\t\t\t\t\t\t\t\treturn (num += player.countMark(\"newyanxunmrfz\"));\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\t\tnewfeixuemrfz: {\r\n\t\t\taudio: \"feixuemrfz\",\r\n\t\t\ttrigger: {\r\n\t\t\t\tplayer: \"useCard2\",\r\n\t\t\t},\r\n\t\t\tmark: true,\r\n\t\t\tintro: {\r\n\t\t\t\tcontent(_, player) {\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\treturn _status.currentPhase === player ? `被跳过的阶段：${get.translation(player.skipList)}` : \"不是你的回合\";\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\tlet next = lib.skill.newfeixuemrfz.getNextPhase(event, player);\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\treturn get.tag(event.card, \"damage\") && event.targets && next && _status.currentPhase === player;\r\n\t\t\t},\r\n\t\t\tgetNextPhase(event, player) {\r\n\t\t\t\tlet name;\r\n\t\t\t\tif (lib.phaseName.indexOf(event.name) === -1) {\r\n\t\t\t\t\tlet evt = event;\r\n\t\t\t\t\twhile (true) {\r\n\t\t\t\t\t\tif (lib.phaseName.includes(evt.name)) {\r\n\t\t\t\t\t\t\tname = evt.name;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevt = evt.parent;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tname = event.name;\r\n\t\t\t\t}\r\n\t\t\t\tlet i = lib.phaseName.indexOf(name) + 1;\r\n\t\t\t\twhile (true) {\r\n\t\t\t\t\tif (i > lib.phaseName.length) return;\r\n\t\t\t\t\tlet phase = lib.phaseName[i];\r\n\t\t\t\t\tif (player.skipList.includes(phase)) {\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn phase;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tprompt2(event, player) {\r\n\t\t\t\tlet next = lib.skill.newfeixuemrfz.getNextPhase(event, player);\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\treturn `你可以跳过本回合下个没有被跳过的阶段(${get.translation(next)})，然后此牌的目标角色(${get.translation(event.targets)})需要打出一张【闪】才能响应此牌。`;\r\n\t\t\t},\r\n\t\t\tcheck(event, player) {\r\n\t\t\t\tlet next = lib.skill.newfeixuemrfz.getNextPhase(event, player);\r\n\t\t\t\tif ([\"phaseUse\", \"phaseDraw\"].includes(next)) return false;\r\n\t\t\t\tlet val = 0;\r\n\t\t\t\tevent.targets.forEach(target => {\r\n\t\t\t\t\tval += get.effect(target, event.card, player, player);\r\n\t\t\t\t});\r\n\t\t\t\treturn val > 0;\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tplayer.skip(lib.skill.newfeixuemrfz.getNextPhase(event, player));\r\n\t\t\t\tplayer.draw();\r\n\t\t\t\tfor (let target of trigger.targets) {\r\n\t\t\t\t\tconst { bool } = await target\r\n\t\t\t\t\t\t.chooseToRespond()\r\n\t\t\t\t\t\t.set(\"prompt\", `请打出一张【闪】，否则${get.translation(trigger.card)}不可响应`)\r\n\t\t\t\t\t\t.set(\"filterCard\", function (card, player) {\r\n\t\t\t\t\t\t\tif (get.name(card) !== \"shan\") return false;\r\n\t\t\t\t\t\t\treturn lib.filter.cardRespondable(card, player);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.set(\"ai\", card => {\r\n\t\t\t\t\t\t\tlet evt = _status.event.getParent(4);\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tlet player = get.event().targetx;\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tlet target = get.event().targetxx;\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tlet cardx = get.event().cardx;\r\n\t\t\t\t\t\t\tif (player.hasSkillTag(\"freeShan\")) return 1;\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tplayer.countCards(\"hs\", c => {\r\n\t\t\t\t\t\t\t\t\treturn get.canRespond(cardx, player).includes(c.name);\r\n\t\t\t\t\t\t\t\t}) <\r\n\t\t\t\t\t\t\t\t\tcardx.name ===\r\n\t\t\t\t\t\t\t\t\"sha\"\r\n\t\t\t\t\t\t\t\t\t? 2\r\n\t\t\t\t\t\t\t\t\t: 1\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t\t\tif (get.damageEffect(player, target, player) >= 0) return 0;\r\n\t\t\t\t\t\t\treturn get.order(card);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.set(\"targetx\", target)\r\n\t\t\t\t\t\t.set(\"targetxx\", player)\r\n\t\t\t\t\t\t.set(\"cardx\", trigger.card)\r\n\t\t\t\t\t\t.forResult();\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tif (bool === false) trigger.directHit.add(target);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\t//新铃兰\r\n\t\tnewhualaomrfz: {\r\n\t\t\taudio: \"hualaomrfz\",\r\n\t\t\ttrigger: {\r\n\t\t\t\tsource: \"damageBegin\",\r\n\t\t\t},\r\n\t\t\tmarktext: \"脆弱\",\r\n\t\t\tintro: {\r\n\t\t\t\tname: \"脆弱\",\r\n\t\t\t\tcontent: \"下次受到的伤害翻倍#次\",\r\n\t\t\t},\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn event.player !== player;\r\n\t\t\t},\r\n\t\t\tprompt2(event, player) {\r\n\t\t\t\treturn `是否令${get.translation(event.player)}下次受到的伤害翻倍？`;\r\n\t\t\t},\r\n\t\t\tcheck(event, player) {\r\n\t\t\t\tif (get.attitude(player, event.player) > 0) return false;\r\n\t\t\t\tif (event.num + event.player.countMark(\"newhualaomrfz\") - event.player.hp >= 0) return false;\r\n\t\t\t\treturn true;\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tvar target = trigger.player;\r\n\t\t\t\ttarget.addMark(\"newhualaomrfz\", 1, false);\r\n\t\t\t\ttarget.addTempSkill(\"newhualaomrfz_eff\", { player: \"damageEnd\" });\r\n\t\t\t\ttrigger.num = 0;\r\n\t\t\t},\r\n\t\t\tsubSkill: {\r\n\t\t\t\teff: {\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\ttrigger: { player: \"damageBegin4\" },\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\treturn event.num > 0 && player.countMark(\"newhualaomrfz\") > 0;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\ttrigger.num *= 2 ** player.countMark(\"newhualaomrfz\");\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tplayer.removeAllmark(\"newhualaomrfz\");\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tnewhemingmrfz: {\r\n\t\t\taudio: \"huhuomrfz\",\r\n\t\t\ttrigger: {\r\n\t\t\t\tsource: \"damageZero\",\r\n\t\t\t},\r\n\t\t\tusable: 1,\r\n\t\t\tasync cost(event, trigger, player) {\r\n\t\t\t\tlet num = Math.floor(game.players.filter(char => char !== player && char.inRangeOf(player)).length / 2);\r\n\t\t\t\tevent.result = await player\r\n\t\t\t\t\t.chooseTarget()\r\n\t\t\t\t\t.set(\"prompt\", get.prompt(\"newhemingmrfz\"))\r\n\t\t\t\t\t.set(\"prompt2\", `你可以令至多两名角色摸${get.cnNumber(num)}张牌`)\r\n\t\t\t\t\t.set(\"ai\", target => get.attitude2(target) > 0)\r\n\t\t\t\t\t.set(\"selectTarget\", [1, 2])\r\n\t\t\t\t\t.forResult();\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tlet num = Math.floor(game.players.filter(char => char !== player && char.inRangeOf(player)).length / 2);\r\n\t\t\t\tgame.asyncDraw(event.targets, num);\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\t//酒神\r\n\t\txinyunmrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\ttrigger: { global: \"dying\" },\r\n\t\t\tusable: 1,\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn !event.player.storage.xinyunmrfz_ban;\r\n\t\t\t},\r\n\t\t\tprompt(event, player) {\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\treturn `【欣殒】:是否令${event.player === player ? \"你\" : get.translation(event.player)}摸4张牌并使用其中能使用的牌？`;\r\n\t\t\t},\r\n\t\t\tcheck(event, player) {\r\n\t\t\t\treturn get.attitude(player, event.player) > 2;\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tlet target = trigger.player;\r\n\t\t\t\tconst result = await target.draw(4).forResult();\r\n\t\t\t\tif (!result) return;\r\n\t\t\t\tgame.broadcastAll(\r\n\t\t\t\t\t(target, cards) => {\r\n\t\t\t\t\t\ttarget.storage.xinyunmrfz = true;\r\n\t\t\t\t\t\ttarget.storage.xinyunmrfz_ban = true;\r\n\t\t\t\t\t\ttarget.storage.xinyunmrfz_cards = cards;\r\n\t\t\t\t\t},\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\ttarget,\r\n\t\t\t\t\tresult\r\n\t\t\t\t);\r\n\t\t\t\ttarget\r\n\t\t\t\t\t.when({\r\n\t\t\t\t\t\tsource: \"damageEnd\",\r\n\t\t\t\t\t\tplayer: \"dyingAfter\",\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.filter((event, player) => {\r\n\t\t\t\t\t\tif (event.name !== \"damage\") return true;\r\n\t\t\t\t\t\treturn player.hasHistory(\"sourceDamage\", evt => {\r\n\t\t\t\t\t\t\tif (evt.player && evt.player === player) return false;\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\treturn evt.cards && evt.cards.some(card => result.includes(card));\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tgame.broadcastAll(player => {\r\n\t\t\t\t\t\t\tdelete player.storage.xinyunmrfz;\r\n\t\t\t\t\t\t\tdelete player.storage.xinyunmrfz_ban;\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t}, player);\r\n\t\t\t\t\t});\r\n\t\t\t\twhile (true) {\r\n\t\t\t\t\tlet cards = target.getCards(\"h\", card => {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tif (!result.includes(card)) return false;\r\n\t\t\t\t\t\treturn target.hasUseTarget(card);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (cards.length < 1) break;\r\n\t\t\t\t\tawait target\r\n\t\t\t\t\t\t.chooseToUse()\r\n\t\t\t\t\t\t.set(\"filterCard\", function (card, player, event) {\r\n\t\t\t\t\t\t\tlet cards = player.storage.xinyunmrfz_cards;\r\n\t\t\t\t\t\t\tif (!cards.includes(card)) return false;\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\treturn lib.filter.filterCard.apply(this, arguments);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.set(\"prompt\", `请使用一张牌`)\r\n\t\t\t\t\t\t.set(\"forced\", true)\r\n\t\t\t\t\t\t.set(\"addCount\", false);\r\n\t\t\t\t}\r\n\t\t\t\tif (target.storage.xinyunmrfz) {\r\n\t\t\t\t\tawait target.loseHp();\r\n\t\t\t\t} else player.recoverTo(1);\r\n\t\t\t\tgame.broadcastAll(target => {\r\n\t\t\t\t\tdelete target.storage.xinyunmrfz_ban;\r\n\t\t\t\t\tdelete target.storage.xinyunmrfz_cards;\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t}, target);\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\tthreaten: 2,\r\n\t\t\t\tmaixie: true,\r\n\t\t\t\tmaixie_hp: true,\r\n\t\t\t\tskillTagFilter(player, tag, arg) {\r\n\t\t\t\t\treturn !!(player.getStat(\"skill\").xinyunmrfz && player.getStat(\"skill\").xinyunmrfz > 0);\r\n\t\t\t\t},\r\n\t\t\t\teffect: {\r\n\t\t\t\t\ttarget: function (card, player, target) {\r\n\t\t\t\t\t\tif (player.hp < 2 && get.tag(card, \"damage\")) return [1, 0.55];\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tzongyinmrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\tenable: \"chooseToUse\",\r\n\t\t\tmark: true,\r\n\t\t\tintro: {\r\n\t\t\t\tcontent(storage) {\r\n\t\t\t\t\treturn `本轮已使用的花色:${get.translation(storage)}`;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tinit: (player, skill) => (player.storage[skill] = []),\r\n\t\t\tposition: \"hes\",\r\n\t\t\tviewAs: {\r\n\t\t\t\tname: \"jiu\",\r\n\t\t\t},\r\n\t\t\tviewAsFilter(player) {\r\n\t\t\t\treturn player.countCards(\"he\", card => !player.storage.zongyinmrfz.includes(get.suit(card))) > 0;\r\n\t\t\t},\r\n\t\t\tfilterCard(card, player, target) {\r\n\t\t\t\treturn !player.storage.zongyinmrfz.includes(get.suit(card));\r\n\t\t\t},\r\n\t\t\tonuse(result, player) {\r\n\t\t\t\tlet card = result.card;\r\n\t\t\t\tgame.broadcastAll(\r\n\t\t\t\t\tfunction (card, player) {\r\n\t\t\t\t\t\tplayer.storage.zongyinmrfz.add(get.suit(card));\r\n\t\t\t\t\t},\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tcard,\r\n\t\t\t\t\tplayer\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\tcheck(card) {\r\n\t\t\t\tif (_status.event.type === \"dying\") return 1 / Math.max(0.1, get.value(card));\r\n\t\t\t\treturn 4 - get.value(card);\r\n\t\t\t},\r\n\t\t\tgroup: \"zongyinmrfz_clear\",\r\n\t\t\tsubSkill: {\r\n\t\t\t\tclear: {\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tglobal: \"roundStart\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\tcontent: async function (event, trigger, player) {\r\n\t\t\t\t\t\tplayer.storage.zongyinmrfz = [];\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\tthreaten: 1.5,\r\n\t\t\t\tbasic: {\r\n\t\t\t\t\tuseful: (card, i) => {\r\n\t\t\t\t\t\tif (_status.event.player.hp > 1) {\r\n\t\t\t\t\t\t\tif (i === 0) return 4;\r\n\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (i === 0) return 7.3;\r\n\t\t\t\t\t\treturn 3;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tvalue: (card, player, i) => {\r\n\t\t\t\t\t\tif (player.hp > 1) {\r\n\t\t\t\t\t\t\tif (i === 0) return 5;\r\n\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (i === 0) return 7.3;\r\n\t\t\t\t\t\treturn 3;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\torder(item, player) {\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tif (_status.event.dying) return 9;\r\n\t\t\t\t\tlet sha = get.order({ name: \"sha\" });\r\n\t\t\t\t\tif (sha <= 0) return 0;\r\n\t\t\t\t\tlet usable = player.getCardUsable(\"sha\");\r\n\t\t\t\t\tif (\r\n\t\t\t\t\t\tusable < 2 &&\r\n\t\t\t\t\t\tplayer.hasCard(i => {\r\n\t\t\t\t\t\t\treturn get.name(i, player) == \"zhuge\";\r\n\t\t\t\t\t\t}, \"hs\")\r\n\t\t\t\t\t)\r\n\t\t\t\t\t\tusable = Infinity;\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tlet shas = Math.min(usable, player.mayHaveSha(player, \"use\", item, \"count\"));\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tif (shas != 1 || (lib.config.mode === \"stone\" && !player.isMin() && player.getActCount() + 1 >= player.actcount)) return 0;\r\n\t\t\t\t\treturn sha + 0.2;\r\n\t\t\t\t},\r\n\t\t\t\tresult: {\r\n\t\t\t\t\ttarget: (player, target, card) => {\r\n\t\t\t\t\t\tif (target && target.isDying()) return 2;\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tif (!target || target._jiu_temp || !target.isPhaseUsing()) return 0;\r\n\t\t\t\t\t\tlet effs = { order: 0 },\r\n\t\t\t\t\t\t\ttemp;\r\n\t\t\t\t\t\ttarget.getCards(\"hs\", i => {\r\n\t\t\t\t\t\t\tif (get.name(i) !== \"sha\" || ui.selected.cards.includes(i)) return false;\r\n\t\t\t\t\t\t\ttemp = get.order(i, target);\r\n\t\t\t\t\t\t\tif (temp < effs.order) return false;\r\n\t\t\t\t\t\t\tif (temp > effs.order) effs = { order: temp };\r\n\t\t\t\t\t\t\teffs[i.cardid] = {\r\n\t\t\t\t\t\t\t\tcard: i,\r\n\t\t\t\t\t\t\t\ttarget: null,\r\n\t\t\t\t\t\t\t\teff: 0,\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tdelete effs.order;\r\n\t\t\t\t\t\tfor (let i in effs) {\r\n\t\t\t\t\t\t\tif (!lib.filter.filterCard(effs[i].card, target)) continue;\r\n\t\t\t\t\t\t\tgame.filterPlayer(current => {\r\n\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\tget.attitude(target, current) >= 0 ||\r\n\t\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\t\t!target.canUse(effs[i].card, current, null, true) ||\r\n\t\t\t\t\t\t\t\t\tcurrent.hasSkillTag(\"filterDamage\", null, {\r\n\t\t\t\t\t\t\t\t\t\tplayer: target,\r\n\t\t\t\t\t\t\t\t\t\tcard: effs[i].card,\r\n\t\t\t\t\t\t\t\t\t\tjiu: true,\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\ttemp = get.effect(current, effs[i].card, target, player);\r\n\t\t\t\t\t\t\t\tif (temp <= effs[i].eff) return false;\r\n\t\t\t\t\t\t\t\teffs[i].target = current;\r\n\t\t\t\t\t\t\t\teffs[i].eff = temp;\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tif (!effs[i].target) continue;\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\ttarget.hasSkillTag(\r\n\t\t\t\t\t\t\t\t\t\"directHit_ai\",\r\n\t\t\t\t\t\t\t\t\ttrue,\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\ttarget: effs[i].target,\r\n\t\t\t\t\t\t\t\t\t\tcard: i,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\ttrue\r\n\t\t\t\t\t\t\t\t) ||\r\n\t\t\t\t\t\t\t\t//(Math.min(target.getCardUsable(\"sha\"), target.mayHaveSha(player, \"use\", item, \"count\")) === 1 && (\r\n\t\t\t\t\t\t\t\ttarget.needsToDiscard() > Math.max(0, 3 - target.hp) ||\r\n\t\t\t\t\t\t\t\t!effs[i].target.mayHaveShan(\r\n\t\t\t\t\t\t\t\t\tplayer,\r\n\t\t\t\t\t\t\t\t\t\"use\",\r\n\t\t\t\t\t\t\t\t\teffs[i].target.getCards(i => {\r\n\t\t\t\t\t\t\t\t\t\treturn i.hasGaintag(\"sha_notshan\");\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t//))\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tdelete target._jiu_temp;\r\n\t\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tdelete target._jiu_temp;\r\n\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\ttag: {\r\n\t\t\t\t\tsave: 1,\r\n\t\t\t\t\trecover: 0.1,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tzhanwangmrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\ttrigger: { player: \"useCard2\" },\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn !event.targets.includes(player) && ![\"delay\", \"equip\"].includes(get.type(event.card));\r\n\t\t\t},\r\n\t\t\tforced: true,\r\n\t\t\tintro: {\r\n\t\t\t\tcontent: \"本回合手牌上限+#\",\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\ttrigger.targets.push(player);\r\n\t\t\t},\r\n\t\t\tgroup: \"zhanwangmrfz_handLimit\",\r\n\t\t\tsubSkill: {\r\n\t\t\t\thandLimit: {\r\n\t\t\t\t\taudio: false,\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\ttarget: \"useCardToTargeted\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\treturn event.card && get.tag(event.card, \"damage\") && event.targets.includes(player);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tplayer.addMark(\"zhanwangmrfz\", 1, false);\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\tplayer.getSkills().some(skill => {\r\n\t\t\t\t\t\t\t\tlet info = get.info(skill);\r\n\t\t\t\t\t\t\t\treturn info.zhanwangmrfz;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\tplayer\r\n\t\t\t\t\t\t\t.when({ global: \"phaseEnd\" })\r\n\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\tplayer.unmarkSkill(\"zhanwangmrfz\");\r\n\t\t\t\t\t\t\t\tplayer.removeMark(\"zhanwangmrfz\", player.countMark(\"zhanwangmrfz\"), false);\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.assign({\r\n\t\t\t\t\t\t\t\tzhanwangmrfz: true,\r\n\t\t\t\t\t\t\t\tmod: {\r\n\t\t\t\t\t\t\t\t\tmaxHandcard(player, num) {\r\n\t\t\t\t\t\t\t\t\t\treturn num + player.getStorage(\"zhanwangmrfz\");\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\t//信仰搅拌机\r\n\t\tdaoweimrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\ttrigger: { player: \"phaseDrawEnd\" },\r\n\t\t\tforced: true,\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\tlet cards = [];\r\n\t\t\t\tlet histories = player.getHistory(\"gain\", evt => {\r\n\t\t\t\t\tlet evtx = evt.getParent(2);\r\n\t\t\t\t\treturn evtx.name === \"phaseDraw\" || (evtx.triggername && evtx.triggername.includes(\"phaseDraw\"));\r\n\t\t\t\t});\r\n\t\t\t\tfor (let history of histories) {\r\n\t\t\t\t\tif (history.cards) cards.push(...history.cards);\r\n\t\t\t\t}\r\n\t\t\t\treturn cards.length > 0;\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tlet cards = [];\r\n\t\t\t\tlet histories = player.getHistory(\"gain\", evt => {\r\n\t\t\t\t\tlet evtx = evt.getParent(2);\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\treturn evtx.name === \"phaseDraw\" || (evtx.triggername && evtx.triggername.includes(\"phaseDraw\"));\r\n\t\t\t\t});\r\n\t\t\t\tfor (let history of histories) {\r\n\t\t\t\t\tif (history.cards) cards.push(...history.cards);\r\n\t\t\t\t}\r\n\t\t\t\tawait player.discard(cards);\r\n\t\t\t\tplayer.draw(cards.length * 2);\r\n\t\t\t\tplayer.storage.daoweimrfz_ban = Array.from(new Set(cards.map(card => card.name)));\r\n\t\t\t\tplayer.addTempSkill(\"daoweimrfz_ban\", { player: \"phaseEnd\" });\r\n\t\t\t},\r\n\t\t\tsubSkill: {\r\n\t\t\t\tban: {\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\tonremove: true,\r\n\t\t\t\t\tmark: true,\r\n\t\t\t\t\tintro: {\r\n\t\t\t\t\t\tcontent(_, player) {\r\n\t\t\t\t\t\t\treturn `·无法使用或打出${get.translation(player.storage.daoweimrfz_ban)}`;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmod: {\r\n\t\t\t\t\t\tcardEnabled2(card, player) {\r\n\t\t\t\t\t\t\tif (player.storage.daoweimrfz_ban.includes(card.name)) return false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tchongzhoumrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\tenable: [\"chooseToUse\", \"chooseToRespond\"],\r\n\t\t\tusable: 1,\r\n\t\t\tintro: {\r\n\t\t\t\tname: \"铳胄\",\r\n\t\t\t\tcontent: \"本回合手牌上限+2\",\r\n\t\t\t},\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\tif (event.type == \"wuxie\") return false;\r\n\t\t\t\tfor (var name of [\"sha\", \"shan\"]) {\r\n\t\t\t\t\tif (event.filterCard({ name: name, isCard: true }, player, event)) return true;\r\n\t\t\t\t}\r\n\t\t\t\treturn false;\r\n\t\t\t},\r\n\t\t\tchooseButton: {\r\n\t\t\t\tdialog(event, player) {\r\n\t\t\t\t\tvar vcards = [];\r\n\t\t\t\t\tfor (var name of [\"sha\", \"shan\"]) {\r\n\t\t\t\t\t\tvar card = { name: name, isCard: true };\r\n\t\t\t\t\t\tif (event.filterCard(card, player, event)) {\r\n\t\t\t\t\t\t\tif (name === \"sha\") {\r\n\t\t\t\t\t\t\t\tfor (var j of lib.inpile_nature) vcards.push([\"基本\", \"\", \"sha\", j]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvcards.push([\"基本\", \"\", name]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t/**@type {Dialog}*/\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tvar dialog = ui.create.dialog(\"铳胄\", [vcards, \"vcard\"], \"hidden\");\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tdialog.direct = true;\r\n\t\t\t\t\treturn dialog;\r\n\t\t\t\t},\r\n\t\t\t\tbackup(links, player) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\taudio: \"chongzhoumrfz\",\r\n\t\t\t\t\t\tfilterCard: () => true,\r\n\t\t\t\t\t\tselectCard: 1,\r\n\t\t\t\t\t\tviewAs: {\r\n\t\t\t\t\t\t\tname: links[0][2],\r\n\t\t\t\t\t\t\tnature: links[0][3],\r\n\t\t\t\t\t\t\tisCard: true,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tpopname: true,\r\n\t\t\t\t\t\tasync precontent(event, trigger, player) {\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tlet target = _status.currentPhase;\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\ttarget.getSkills().filter(skill => {\r\n\t\t\t\t\t\t\t\t\tlet info = get.info(skill);\r\n\t\t\t\t\t\t\t\t\treturn info.sourceSkill && info.sourceSkill === \"chongzhoumrfz\";\r\n\t\t\t\t\t\t\t\t}).length < 1\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\ttarget.markSkill(\"chongzhoumrfz\");\r\n\t\t\t\t\t\t\t\ttarget\r\n\t\t\t\t\t\t\t\t\t.when({ player: \"phaseEnd\" })\r\n\t\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\t\tplayer.unmarkSkill(\"chongzhoumrfz\");\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t.assign({\r\n\t\t\t\t\t\t\t\t\t\tmod: {\r\n\t\t\t\t\t\t\t\t\t\t\tmaxHandcard: function (player, num) {\r\n\t\t\t\t\t\t\t\t\t\t\t\treturn (num += 2);\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t};\r\n\t\t\t\t},\r\n\t\t\t\tprompt(links, player) {\r\n\t\t\t\t\treturn \"铳胄：视为使用一张\" + (links[0][3] ? get.translation(links[0][3]) : \"\") + \"【\" + get.translation(links[0][2]) + \"】\";\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\torder(item, player) {\r\n\t\t\t\t\tvar player = _status.event.player;\r\n\t\t\t\t\tvar event = _status.event;\r\n\t\t\t\t\tif (event.filterCard({ name: \"sha\" }, player, event)) {\r\n\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t!player.hasShan() &&\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t!game.hasPlayer(function (current) {\r\n\t\t\t\t\t\t\t\treturn player.canUse(\"sha\", current) && current.hp == 1 && get.effect(current, { name: \"sha\" }, player, player) > 0;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn 2.95;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar player = _status.event.player;\r\n\t\t\t\t\t\tif (player.hasSkill(\"qingzhong_give\")) return 2.95;\r\n\t\t\t\t\t\treturn 3.15;\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\trespondSha: true,\r\n\t\t\t\trespondShan: true,\r\n\t\t\t\tskillTagFilter(player, tag, arg) {\r\n\t\t\t\t\tif (arg === \"respond\") return false;\r\n\t\t\t\t},\r\n\t\t\t\tresult: {\r\n\t\t\t\t\tplayer: 1,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tshiyimrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\tderivation: [\"xiangle\"],\r\n\t\t\tinit(player, skill) {\r\n\t\t\t\tplayer.storage[skill] = false;\r\n\r\n\t\t\t\tlet info = get.info(\"xiangle\");\r\n\t\t\t\tif (!info.audioname2) info.audioname2 = {};\r\n\t\t\t\tinfo.audioname2[\"xinyangjiaobanjimrfz\"] = \"xiangle_xinyangjiaobanjimrfz\";\r\n\t\t\t},\r\n\t\t\ttrigger: {\r\n\t\t\t\tplayer: [\"dying\", \"loseAfter\"],\r\n\t\t\t\tglobal: [\"equipAfter\", \"addJudgeAfter\", \"gainAfter\", \"loseAsyncAfter\", \"addToExpansionAfter\"],\r\n\t\t\t},\r\n\t\t\tskillAnimation: true,\r\n\t\t\tanimationColor: \"wood\",\r\n\t\t\tjuexingji: true,\r\n\t\t\tunique: true,\r\n\t\t\tfilter: function (event, player) {\r\n\t\t\t\tif (event.name === \"dying\") return !player.storage.shiyimrfz;\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (player.countCards(\"h\")) return false;\r\n\t\t\t\t\tconst evt = event.getl(player);\r\n\t\t\t\t\treturn evt && evt.player == player && evt.hs && evt.hs.length > 0 && !player.storage.shiyimrfz;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tforced: true,\r\n\t\t\tcontent: async function (event, trigger, player) {\r\n\t\t\t\tplayer.loseMaxHp();\r\n\t\t\t\tplayer.recover();\r\n\t\t\t\tplayer.addSkill(\"xiangle\");\r\n\t\t\t\tplayer.removeSkill(\"daoweimrfz\");\r\n\t\t\t\tgame.log(player, \"获得了技能\", \"#g【享乐】\");\r\n\t\t\t\tplayer.awakenSkill(event.name);\r\n\t\t\t\tplayer.storage[event.name] = true;\r\n\r\n\t\t\t\tlet num = 5 - player.getAllHistory(\"useSkill\", evt => evt.skill === \"daoweimrfz\").length;\r\n\t\t\t\tnum = Math.max(num, 1);\r\n\t\t\t\tplayer.draw(num);\r\n\t\t\t\tplayer.storage.shiyimrfz_eff = num;\r\n\t\t\t\tplayer.addSkill(\"shiyimrfz_eff\");\r\n\t\t\t},\r\n\t\t\tsubSkill: {\r\n\t\t\t\teff: {\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\tonremove: true,\r\n\t\t\t\t\tmark: true,\r\n\t\t\t\t\tintro: {\r\n\t\t\t\t\t\tcontent(_, player) {\r\n\t\t\t\t\t\t\tlet num = player.storage.shiyimrfz_eff;\r\n\t\t\t\t\t\t\treturn `·手牌上限+${num}<br>·额定摸牌数+${num}`;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\ttrigger: { player: \"phaseDrawBegin2\" },\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\treturn !event.numFixed;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\ttrigger.num += player.storage.shiyimrfz_eff;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmod: {\r\n\t\t\t\t\t\tmaxHandcard: function (player, num) {\r\n\t\t\t\t\t\t\treturn num + player.storage.shiyimrfz_eff;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\txiangle_xinyangjiaobanjimrfz: { audio: 2 },\r\n\r\n\t\t//蕾缪安\r\n\t\tfeiyimrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\ttrigger: { player: \"phaseZhunbeiBegin\" },\r\n\t\t\tintro: {\r\n\t\t\t\tcontent(_, player) {\r\n\t\t\t\t\tlet index;\r\n\t\t\t\t\tplayer.getSkills().forEach(skill => {\r\n\t\t\t\t\t\tlet info = get.info(skill);\r\n\t\t\t\t\t\tif (typeof info.feiyimrfz === \"number\") {\r\n\t\t\t\t\t\t\tindex = info.feiyimrfz;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn `·回合内你的攻击距离${index === 0 ? \"+1\" : \"-1\"}<br>·其他角色计算与你的距离${index === 0 ? \"-1\" : \"+1\"}`;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tasync cost(event, trigger, player) {\r\n\t\t\t\tconst { index } = await player\r\n\t\t\t\t\t.chooseControl(\"选项一\", \"选项二\", \"cancel2\")\r\n\t\t\t\t\t.set(\"prompt\", get.prompt(\"feiyimrfz\"))\r\n\t\t\t\t\t.set(\"prompt2\", `1`)\r\n\t\t\t\t\t.set(\"choiceList\", [\r\n\t\t\t\t\t\t\"你可以令你本回合的攻击距离+1，然后直到下个准备阶段开始时，其他角色计算与你的距离-1。\",\r\n\t\t\t\t\t\t\"你可以令你本回合的攻击距离-1，然后直到下个准备阶段开始时，其他角色计算与你的距离+1。\",\r\n\t\t\t\t\t])\r\n\t\t\t\t\t.set(\"ai\", () => 1)\r\n\t\t\t\t\t.forResult();\r\n\t\t\t\tif (typeof index === \"number\")\r\n\t\t\t\t\tevent.result = {\r\n\t\t\t\t\t\tbool: true,\r\n\t\t\t\t\t\tcost_data: {\r\n\t\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t};\r\n\t\t\t\telse event.result = { bool: false };\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tconst { index } = event.cost_data;\r\n\t\t\t\tplayer.markSkill(\"feiyimrfz\");\r\n\t\t\t\tplayer\r\n\t\t\t\t\t.when({ player: \"phaseBegin\" })\r\n\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\tplayer.unmarkSkill(\"feiyimrfz\");\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.assign({\r\n\t\t\t\t\t\tmod: {\r\n\t\t\t\t\t\t\tglobalTo(from, to, distance) {\r\n\t\t\t\t\t\t\t\treturn distance + (index === 0 ? -1 : 1);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tattackRange: function (player, num) {\r\n\t\t\t\t\t\t\t\treturn (num += index === 0 ? 1 : -1);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfeiyimrfz: index,\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\tthreaten: 0.8,\r\n\t\t\t\tcombo: \"mingzhengmrfz\",\r\n\t\t\t},\r\n\t\t},\r\n\t\tmingzhengmrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\tenable: \"phaseUse\",\r\n\t\t\tusable: 1,\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn event.filterCard ? player.countCards(\"h\", card => event.filterCard(card, player, event)) > 0 : player.countCards(\"h\") > 0;\r\n\t\t\t},\r\n\t\t\tfilterCard: (card, player, event) => {\r\n\t\t\t\treturn !lib.filter.filterCard(card, player, event);\r\n\t\t\t},\r\n\t\t\tselectCard: () => {\r\n\t\t\t\tlet player = get.player();\r\n\t\t\t\tlet num = player.getCards(\"h\", card => lib.filter.filterCard(card, player)).length;\r\n\t\t\t\tnum = Math.max(num, 1);\r\n\t\t\t\treturn [0, num];\r\n\t\t\t},\r\n\t\t\tdiscard: false,\r\n\t\t\tlose: false,\r\n\t\t\tintro: {\r\n\t\t\t\tcontent: \"·使用牌无距离限制<br>·使用的牌无视防具\",\r\n\t\t\t},\r\n\t\t\tcheck(card) {\r\n\t\t\t\tlet player = get.player();\r\n\t\t\t\treturn get.value(card, player) < 6;\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tawait player.recast(event.cards);\r\n\t\t\t\tlet canUseCount = player.getCards(\"h\", card => lib.filter.filterCard(card, player)).length;\r\n\t\t\t\tlet cantUseCount = player.getCards(\"h\", card => !lib.filter.filterCard(card, player)).length;\r\n\t\t\t\tif (canUseCount > cantUseCount) {\r\n\t\t\t\t\tplayer.draw(2);\r\n\t\t\t\t\tplayer.markSkill(\"mingzhengmrfz\");\r\n\t\t\t\t\tplayer.addTempSkill(\"mingzhengmrfz_ig\", { player: \"phaseEnd\" });\r\n\t\t\t\t\tplayer\r\n\t\t\t\t\t\t.when({ player: \"phaseEnd\" })\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\tplayer.unmarkSkill(\"mingzhengmrfz\");\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.assign({\r\n\t\t\t\t\t\t\tmod: {\r\n\t\t\t\t\t\t\t\ttargetInRange: function () {\r\n\t\t\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tsubSkill: {\r\n\t\t\t\tig: {\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tplayer: \"useCardToPlayered\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\tlogTarget: \"target\",\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\ttrigger.target.addTempSkill(\"qinggang2\");\r\n\t\t\t\t\t\ttrigger.target.storage.qinggang2.add(trigger.card);\r\n\t\t\t\t\t\ttrigger.target.markSkill(\"qinggang2\");\r\n\t\t\t\t\t},\r\n\t\t\t\t\tai: {\r\n\t\t\t\t\t\tunequip_ai: true,\r\n\t\t\t\t\t\tskillTagFilter(player, tag, arg) {\r\n\t\t\t\t\t\t\tif (arg && arg.name == \"sha\") return true;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\torder: 13,\r\n\t\t\t\tresult: {\r\n\t\t\t\t\tplayer: 1,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tzhuijimrfz: {\r\n\t\t\taudio: 3,\r\n\t\t\ttrigger: { player: \"phaseUseBegin\" },\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\treturn game.countPlayer(c => c.countCards(\"h\") && c !== player && !player.inRange(c)) > 0;\r\n\t\t\t},\r\n\t\t\tprompt2(event, player) {\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tlet targets = game.filterPlayer(c => c.countCards(\"h\") && c !== player && !player.inRange(c));\r\n\t\t\t\treturn `你可以展示你攻击范围外所有角色（${get.translation(targets)}）的一张牌，所有因此展示了伤害类牌的角色本阶段成为你使用牌的目标时，你可以对其造成一点伤害或摸一张牌（每项每名角色每阶段限一次）。`;\r\n\t\t\t},\r\n\t\t\tintro: {\r\n\t\t\t\tcontent(_, player) {\r\n\t\t\t\t\treturn `成为通缉的目标`;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tlet targets = game.filterPlayer(c => c.countCards(\"h\") && c !== player && !player.inRange(c));\r\n\t\t\t\tlet obj = {\r\n\t\t\t\t\tcards: [],\r\n\t\t\t\t\ttargets: [],\r\n\t\t\t\t};\r\n\t\t\t\tfor (let target of targets) {\r\n\t\t\t\t\tconst { cards } = await player\r\n\t\t\t\t\t\t.choosePlayerCard(\"h\", true, target)\r\n\t\t\t\t\t\t.set(\"ai\", () => get.rand(0, 1))\r\n\t\t\t\t\t\t.set(\"prompt\", `展示${target}一张手牌`)\r\n\t\t\t\t\t\t.forResult();\r\n\t\t\t\t\tif (!cards) return;\r\n\t\t\t\t\tlet card = cards[0];\r\n\t\t\t\t\tif (card) {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tobj.cards.push(card);\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tobj.targets.push(target);\r\n\t\t\t\t\t\tif (get.suit(card) !== \"spade\") {\r\n\t\t\t\t\t\t\ttarget.storage.zhuijimrfz = [];\r\n\t\t\t\t\t\t\ttarget.markSkill(\"zhuijimrfz\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (obj.cards.length > 0) {\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tevent.videoId = lib.status.videoId++;\r\n\t\t\t\t\tgame.log(player, \"展示了\", obj.targets, \"的\", obj.cards);\r\n\t\t\t\t\tgame.broadcastAll(\r\n\t\t\t\t\t\tfunction (info, id, player) {\r\n\t\t\t\t\t\t\tlet { targets, cards } = info;\r\n\t\t\t\t\t\t\tvar dialog = ui.create.dialog(`因${get.translation(player)}的【追缉】而展示的牌`, cards);\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tdialog.videoId = id;\r\n\t\t\t\t\t\t\tvar getName = function (target) {\r\n\t\t\t\t\t\t\t\tif (target._tempTranslate) return target._tempTranslate;\r\n\t\t\t\t\t\t\t\tvar name = target.name;\r\n\t\t\t\t\t\t\t\tif (lib.translate[name + \"_ab\"]) return lib.translate[name + \"_ab\"];\r\n\t\t\t\t\t\t\t\treturn get.translation(name);\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tfor (var i = 0; i < targets.length; i++) {\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\tdialog.buttons[i].querySelector(\".info\").innerHTML = getName(targets[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\t\tdialog.show();\r\n\t\t\t\t\t\t\t}, 1);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tobj,\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tevent.videoId,\r\n\t\t\t\t\t\tplayer\r\n\t\t\t\t\t);\r\n\t\t\t\t\tgame.delay(3);\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tgame.broadcastAll(\"closeDialog\", event.videoId);\r\n\t\t\t\t\t}, 3000);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgroup: [\"zhuijimrfz_clear\", \"zhuijimrfz_eff\"],\r\n\t\t\tsubSkill: {\r\n\t\t\t\teff: {\r\n\t\t\t\t\tmod: {\r\n\t\t\t\t\t\tcardUsableTarget(card, player, target) {\r\n\t\t\t\t\t\t\tif (Array.isArray(target.storage.zhuijimrfz)) return true;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t\taudio: \"zhuijimrfz\",\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\ttrigger: { player: \"useCardToTargeted\" },\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\tlet storage = event.target.storage.zhuijimrfz;\r\n\t\t\t\t\t\treturn storage && storage.length < 2;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync cost(event, trigger, player) {\r\n\t\t\t\t\t\tlet storage = trigger.target.storage.zhuijimrfz;\r\n\t\t\t\t\t\tlet list = [\"摸一张牌\", `对${get.translation(trigger.target)}造成一点伤害`];\r\n\t\t\t\t\t\tif (storage.includes(\"damage\") || storage.includes(\"draw\")) {\r\n\t\t\t\t\t\t\tlet str = storage.includes(\"draw\") ? `是否对${get.translation(trigger.target)}造成一点伤害？` : `是否摸一张牌？`;\r\n\t\t\t\t\t\t\tlet aiBool = true;\r\n\t\t\t\t\t\t\tif (storage.includes(\"draw\") && get.damageEffect(trigger.target, player, player) < 0) aiBool = false;\r\n\t\t\t\t\t\t\tconst { bool } = await player\r\n\t\t\t\t\t\t\t\t.chooseBool()\r\n\t\t\t\t\t\t\t\t.set(\"prompt\", str)\r\n\t\t\t\t\t\t\t\t.set(\"ai\", () => aiBool)\r\n\t\t\t\t\t\t\t\t.forResult();\r\n\t\t\t\t\t\t\tevent.result = {\r\n\t\t\t\t\t\t\t\tbool: bool,\r\n\t\t\t\t\t\t\t\tcost_data: {\r\n\t\t\t\t\t\t\t\t\tindex: storage.includes(\"draw\") ? 1 : 0,\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconst { index } = await player\r\n\t\t\t\t\t\t\t\t.chooseControl(\"选项一\", \"选项二\", \"cancel2\")\r\n\t\t\t\t\t\t\t\t.set(\"choiceList\", list)\r\n\t\t\t\t\t\t\t\t.set(\"ai\", () => {\r\n\t\t\t\t\t\t\t\t\tlet player = get.player();\r\n\t\t\t\t\t\t\t\t\tlet target = get.event().target;\r\n\t\t\t\t\t\t\t\t\treturn get.damageEffect(target, player, player) > 0 ? 1 : 0;\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t.set(\"target\", trigger.target)\r\n\t\t\t\t\t\t\t\t.forResult();\r\n\t\t\t\t\t\t\tif (typeof index === \"number\") {\r\n\t\t\t\t\t\t\t\tevent.result = {\r\n\t\t\t\t\t\t\t\t\tbool: true,\r\n\t\t\t\t\t\t\t\t\tcost_data: {\r\n\t\t\t\t\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t} else event.result = { bool: false };\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tconst { index } = event.cost_data;\r\n\t\t\t\t\t\tif (index === 0) {\r\n\t\t\t\t\t\t\tplayer.draw();\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttrigger.target.damage(player);\r\n\t\t\t\t\t\t\tplayer.line(trigger.target);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\ttrigger.target.storage.zhuijimrfz.push(index === 0 ? \"draw\" : \"damage\");\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tclear: {\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\ttrigger: { player: \"phaseUseEnd\" },\r\n\t\t\t\t\tcontent() {\r\n\t\t\t\t\t\tfor (let char of game.players) {\r\n\t\t\t\t\t\t\tif (Array.isArray(char.storage.zhuijimrfz)) {\r\n\t\t\t\t\t\t\t\tchar.unmarkSkill(\"zhuijimrfz\");\r\n\t\t\t\t\t\t\t\tdelete char.storage.zhuijimrfz;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\t// 新约能天使\r\n\t\tyouhuomrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\ttrigger: { player: \"useCard\" },\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn event.card.name === \"sha\" && player.countCards(\"h\", card => player.canRecast(card)) > 0;\r\n\t\t\t},\r\n\t\t\tintro: {\r\n\t\t\t\tcontent(_, player) {\r\n\t\t\t\t\tlet addCount = player.getSkills().filter(skill => {\r\n\t\t\t\t\t\tlet info = get.info(skill);\r\n\t\t\t\t\t\treturn info.youhuomrfz;\r\n\t\t\t\t\t}).length;\r\n\t\t\t\t\treturn `·本回合可额外使用${addCount}张【杀】<br>·本回合剩余可使用【杀】的数量：${player.getCardUsable(\"sha\")}`;\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tasync cost(event, trigger, player) {\r\n\t\t\t\tlet num = player.getHistory(\"useSkill\", evt => evt.skill === \"youhuomrfz\").length + 1;\r\n\t\t\t\tevent.result = await player\r\n\t\t\t\t\t.chooseCard()\r\n\t\t\t\t\t.set(\"filterCard\", (card, player) => player.canRecast(card))\r\n\t\t\t\t\t.set(\"prompt\", get.prompt(\"youhuomrfz\"))\r\n\t\t\t\t\t.set(\r\n\t\t\t\t\t\t\"prompt2\",\r\n\t\t\t\t\t\t`你可以重铸一张手牌，若此牌为伤害类牌，此牌(${get.translation(trigger.card)})额外结算${num}次，且若此牌造成伤害，你本回合使用【杀】的次数+1`\r\n\t\t\t\t\t)\r\n\t\t\t\t\t.set(\"ai\", card => {\r\n\t\t\t\t\t\tlet num = 6 - get.value(card);\r\n\t\t\t\t\t\tif (get.tag(card, \"damage\")) num += 2;\r\n\t\t\t\t\t\treturn num;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.forResult();\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tlet num = player.getHistory(\"useSkill\", evt => evt.skill === \"youhuomrfz\").length;\r\n\t\t\t\tawait player.recast(event.cards);\r\n\t\t\t\tif (get.tag(event.cards[0], \"damage\") > 0) {\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\ttrigger.effectCount += num;\r\n\t\t\t\t\tplayer\r\n\t\t\t\t\t\t.when({\r\n\t\t\t\t\t\t\tsource: \"damageEnd\",\r\n\t\t\t\t\t\t\tglobal: lib.phaseName.map(i => i + \"End\"),\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.filter(event => {\r\n\t\t\t\t\t\t\treturn event.name !== \"damage\" || event.card === trigger.card;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\tif (trigger.name === \"damage\") {\r\n\t\t\t\t\t\t\t\tplayer.markSkill(\"youhuomrfz\");\r\n\t\t\t\t\t\t\t\tplayer\r\n\t\t\t\t\t\t\t\t\t.when({ player: \"phaseEnd\" })\r\n\t\t\t\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t\t\t\tplayer.unmarkSkill(\"youhuomrfz\");\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t.assign({\r\n\t\t\t\t\t\t\t\t\t\tmod: {\r\n\t\t\t\t\t\t\t\t\t\t\tcardUsable(card, player, num) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (card.name == \"sha\") return num + 1;\r\n\t\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tyouhuomrfz: true,\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\t\tletianmrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\tinit() {\r\n\t\t\t\tlib.translate[\"letianmrfz_tips\"] = \"旧约\";\r\n\t\t\t},\r\n\t\t\tforced: true,\r\n\t\t\ttrigger: { global: \"phaseEnd\" },\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn player.countCards(\"h\", card => card.hasGaintag(\"letianmrfz_tips\")) < 1;\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tplayer.drawTo(4);\r\n\t\t\t\tplayer.removeGaintag(\"letianmrfz_tips\");\r\n\t\t\t},\r\n\t\t\tgroup: [\"letianmrfz_begin\"],\r\n\t\t\tsubSkill: {\r\n\t\t\t\tbegin: {\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\tpriority: 114514,\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tglobal: \"phaseBegin\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tfor (let card of player.getCards(\"h\")) {\r\n\t\t\t\t\t\t\tcard.addGaintag(\"letianmrfz_tips\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\t//隐德莱希\r\n\t\tpingyimrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\ttrigger: { global: \"phaseEnd\" },\r\n\t\t\tgetCharacter() {\r\n\t\t\t\tlet result = {\r\n\t\t\t\t\tsourceDamage: [],\r\n\t\t\t\t\tdamage: [],\r\n\t\t\t\t\tall: [],\r\n\t\t\t\t};\r\n\t\t\t\tfor (let char of game.players) {\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tchar.getHistory(\"sourceDamage\", evt => {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tif (evt.player) result.damage.add(evt.player);\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tif (evt.source) result.sourceDamage.add(evt.source);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tresult.all = result.sourceDamage.concat(result.damage);\r\n\t\t\t\treturn result;\r\n\t\t\t},\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\tlet { sourceDamage, damage } = lib.skill.pingyimrfz.getCharacter();\r\n\t\t\t\treturn (sourceDamage.length > 0 || damage.length > 0) && event.player !== player;\r\n\t\t\t},\r\n\t\t\tasync cost(event, trigger, player) {\r\n\t\t\t\tevent.result = await player\r\n\t\t\t\t\t.chooseTarget()\r\n\t\t\t\t\t.set(\"prompt\", get.prompt(\"pingyimrfz\"))\r\n\t\t\t\t\t.set(\"prompt2\", get.prompt2(\"pingyimrfz\").replace(/###([^#]+)###/g, \"\"))\r\n\t\t\t\t\t.set(\"filterTarget\", (card, player, target) => {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tlet { sourceDamage, damage, all } = get.event().info;\r\n\t\t\t\t\t\t//技能提示\r\n\t\t\t\t\t\tfor (let char of game.players) {\r\n\t\t\t\t\t\t\tlet prompt = [];\r\n\t\t\t\t\t\t\tif (sourceDamage.includes(char)) prompt.push(\"使用【杀】\");\r\n\t\t\t\t\t\t\tif (damage.includes(char)) prompt.push(\"使用【桃】\");\r\n\t\t\t\t\t\t\tif (prompt.length > 0)\r\n\t\t\t\t\t\t\t\twhichWayTips.addPrompt(\r\n\t\t\t\t\t\t\t\t\tchar,\r\n\t\t\t\t\t\t\t\t\tprompt.length > 1 ? prompt.map(text => `<span class = \"promptTextSJZX\">${text}</span>`).join(\"<br>\") : prompt[0],\r\n\t\t\t\t\t\t\t\t\t\"pingyimrfz\",\r\n\t\t\t\t\t\t\t\t\t\"uncheckBegin\"\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn all.includes(target);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.set(\"info\", lib.skill.pingyimrfz.getCharacter())\r\n\t\t\t\t\t.forResult();\r\n\t\t\t},\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tlet { sourceDamage, damage, all } = lib.skill.pingyimrfz.getCharacter();\r\n\t\t\t\tlet target = event.targets[0];\r\n\t\t\t\tlet name = [];\r\n\t\t\t\tif (sourceDamage.includes(target)) name.add(\"sha\");\r\n\t\t\t\tif (damage.includes(target)) name.add(\"tao\");\r\n\t\t\t\tlet prompt = `对${get.translation(target)}使用一张`;\r\n\t\t\t\tif (name.length === 1) prompt = prompt + `【${get.translation(name[0])}】`;\r\n\t\t\t\telse prompt = prompt + `【${get.translation(name[0])}】或【${get.translation(name[1])}】`;\r\n\t\t\t\tawait player\r\n\t\t\t\t\t.chooseToUse(target)\r\n\t\t\t\t\t.set(\"prompt\", prompt)\r\n\t\t\t\t\t.set(\"filterCard\", (card, player, event) => {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\treturn get.event().namex.includes(get.name(card));\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.set(\"namex\", name);\r\n\t\t\t\tif (player.storage.pingyimrfz_check) {\r\n\t\t\t\t\tdelete player.storage.pingyimrfz_check;\r\n\t\t\t\t\tlet next = game.createEvent(\"pingyimrfz_repeat\");\r\n\t\t\t\t\tnext.player = player;\r\n\t\t\t\t\tnext.setContent(async function (event, trigger, player) {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tawait lib.skill.pingyimrfz.cost(event, trigger, player);\r\n\t\t\t\t\t\tif (event.result.bool !== true) return;\r\n\t\t\t\t\t\tevent.targets = event.result.targets;\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tawait lib.skill.pingyimrfz.content(event, trigger, player);\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgroup: [\"pingyimrfz_check\"],\r\n\t\t\tsubSkill: {\r\n\t\t\t\tcheck: {\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\taudio: false,\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tglobal: \"changeHp\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\treturn event.getParent(5).name === \"pingyimrfz\" || event.getParent(5).name === \"pingyimrfz_repeat\";\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tplayer.storage.pingyimrfz_check = true;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tbeinuomrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\tusable: 3,\r\n\t\t\t/*\r\n\t\t\t * false为最后获得，true为最先获得\r\n\t\t\t */\r\n\t\t\tgetCard(bool, debug) {\r\n\t\t\t\tlet player = get.player();\r\n\t\t\t\tlet cards = player.getCards(\"h\")?.filter(card => card.storage && typeof card.storage.beinuomrfz === \"number\");\r\n\t\t\t\tif (!cards) return;\r\n\t\t\t\treturn debug\r\n\t\t\t\t\t? cards.sort((a, b) => {\r\n\t\t\t\t\t\t\tlet num1 = a.storage.beinuomrfz;\r\n\t\t\t\t\t\t\tlet num2 = b.storage.beinuomrfz;\r\n\t\t\t\t\t\t\treturn num1 - num2;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t: cards.sort((a, b) => {\r\n\t\t\t\t\t\t\tlet num1 = a.storage.beinuomrfz;\r\n\t\t\t\t\t\t\tlet num2 = b.storage.beinuomrfz;\r\n\t\t\t\t\t\t\treturn num1 - num2;\r\n\t\t\t\t\t\t})[bool ? 0 : cards.length - 1];\r\n\t\t\t},\r\n\t\t\tinit() {\r\n\t\t\t\tlib.translate[\"beinuomrfz_last\"] = \"最后获得\";\r\n\t\t\t\tlib.translate[\"beinuomrfz_earliest\"] = \"最先获得\";\r\n\t\t\t},\r\n\t\t\tenable: \"chooseToUse\",\r\n\t\t\tfilterCard(card, player) {\r\n\t\t\t\treturn card === lib.skill.beinuomrfz.getCard(false);\r\n\t\t\t},\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\tlet name = lib.skill.beinuomrfz.getCard(true)?.name;\r\n\t\t\t\tif (!name) return false;\r\n\t\t\t\tlet card = get.autoViewAs({ name: name }, [lib.skill.beinuomrfz.getCard(false)]);\r\n\t\t\t\treturn event.filterCard(card, player, event);\r\n\t\t\t},\r\n\t\t\tviewAs(cards, player) {\r\n\t\t\t\tlet name = lib.skill.beinuomrfz.getCard(true).name;\r\n\t\t\t\treturn { name: name };\r\n\t\t\t},\r\n\t\t\tprompt() {\r\n\t\t\t\treturn `你可以将最后获得的牌(${get.translation(lib.skill.beinuomrfz.getCard(false).name)})当作最先获得的牌(${get.translation(lib.skill.beinuomrfz.getCard(true).name)})使用`;\r\n\t\t\t},\r\n\t\t\tasync precontent(event, trigger, player) {\r\n\t\t\t\tlet last = lib.skill.beinuomrfz.getCard(false);\r\n\t\t\t\tlet earliest = lib.skill.beinuomrfz.getCard(true);\r\n\t\t\t\tlet cards = event.result.cards;\r\n\t\t\t\tif (get.type2(last) !== get.type2(earliest)) {\r\n\t\t\t\t\tplayer\r\n\t\t\t\t\t\t.when({ player: \"useCardAfter\" })\r\n\t\t\t\t\t\t.filter((event, player) => {\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\treturn event.cards && event.cards[0] === cards[0];\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\tplayer.draw(2);\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t// let cards = player.getCards(\"h\")\r\n\t\t\t\t\t\t\t// \t.filter(card=>card.storage&&typeof card.storage.beinuomrfz === \"number\")\r\n\t\t\t\t\t\t\t// \t.sort((a,b)=>{\r\n\t\t\t\t\t\t\t// \t\treturn a.storage.beinuomrfz - b.storage.beinuomrfz;\r\n\t\t\t\t\t\t\t// \t});\r\n\t\t\t\t\t\t\t// let last = cards[cards.length-1].storage.beinuomrfz;\r\n\t\t\t\t\t\t\t// let earliest = cards[0].storage.beinuomrfz;\r\n\t\t\t\t\t\t\t// cards[0].storage.beinuomrfz = last;\r\n\t\t\t\t\t\t\t// cards[cards.length-1].storage.beinuomrfz = earliest;\r\n\t\t\t\t\t\t\tplayer\r\n\t\t\t\t\t\t\t\t.chooseCard(\"你可以将一张手牌视为你最先获得的牌\")\r\n\t\t\t\t\t\t\t\t.set(\"filterCard\", card => {\r\n\t\t\t\t\t\t\t\t\treturn card !== lib.skill.beinuomrfz.getCard(true);\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t.set(\"ai\", card => {\r\n\t\t\t\t\t\t\t\t\tlet earliest = lib.skill.beinuomrfz.getCard(true);\r\n\t\t\t\t\t\t\t\t\tlet player = get.player();\r\n\t\t\t\t\t\t\t\t\tif ([\"sha\", \"tao\"].includes(earliest.name)) return -1;\r\n\t\t\t\t\t\t\t\t\tif ([\"sha\", \"tao\"].includes(card.name)) return 10 + player.hp < 3 ? get.value(card) : 0;\r\n\t\t\t\t\t\t\t\t\treturn get.value(earliest) >= get.value(card) ? -1 : get.value(card);\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\tlet result = event._result;\r\n\t\t\t\t\t\t\tif (result.cards) {\r\n\t\t\t\t\t\t\t\tresult.cards[0].storage.beinuomrfz = lib.skill.beinuomrfz.getCard(true).storage.beinuomrfz - 1;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.then(() => {\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tlib.skill.beinuomrfz.subSkill.tip.content(event, trigger, player);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgroup: [\"beinuomrfz_tag\", \"beinuomrfz_tip\"],\r\n\t\t\tsubSkill: {\r\n\t\t\t\ttag: {\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\taudio: false,\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tplayer: \"gainAfter\",\r\n\t\t\t\t\t\tglobal: \"gameDrawAfter\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tif (!player.storage.beinuomrfz_tag) player.storage.beinuomrfz_tag = 0;\r\n\t\t\t\t\t\tlet cards = trigger.name === \"gain\" ? trigger.cards : player.getCards(\"h\");\r\n\t\t\t\t\t\tfor (let card of cards) {\r\n\t\t\t\t\t\t\tcard.storage.beinuomrfz = player.storage.beinuomrfz_tag;\r\n\t\t\t\t\t\t\tplayer.storage.beinuomrfz_tag++;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\ttip: {\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\taudio: false,\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tplayer: [\"gainAfter\", \"loseAfter\"],\r\n\t\t\t\t\t\tglobal: \"gameDrawAfter\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tlastDo: true,\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tfor (let card of player.getCards(\"h\").filter(card => card.storage && typeof card.storage.beinuomrfz === \"number\")) {\r\n\t\t\t\t\t\t\tcard.removeGaintag(\"beinuomrfz_last\");\r\n\t\t\t\t\t\t\tcard.removeGaintag(\"beinuomrfz_earliest\");\r\n\t\t\t\t\t\t\tif (card === lib.skill.beinuomrfz.getCard(false)) card.addGaintag(\"beinuomrfz_last\");\r\n\t\t\t\t\t\t\tif (card === lib.skill.beinuomrfz.getCard(true)) card.addGaintag(\"beinuomrfz_earliest\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\torder: 10,\r\n\t\t\t\tresult: {\r\n\t\t\t\t\tplayer: 1,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\t// 爱布拉娜 香蕉姐 死芒\r\n\t\tyizhamrfz: {\r\n\t\t\tinit() {\r\n\t\t\t\tlib.translate[\"yizhamrfz_tip1\"] = \"拼点\";\r\n\t\t\t\tlib.translate[\"yizhamrfz_tip2\"] = \"议事\";\r\n\t\t\t},\r\n\t\t\taudio: 2,\r\n\t\t\tenable: \"phaseUse\",\r\n\t\t\tusable: 1,\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\treturn game.hasPlayer(char => char !== player && char.countCards(\"h\") > 0 && player.canCompare(char)) && player.countCards(\"h\") > 0;\r\n\t\t\t},\r\n\t\t\tfilterTarget(card, player, target) {\r\n\t\t\t\treturn target !== player && target.countCards(\"h\") > 0 && player.canCompare(target);\r\n\t\t\t},\r\n\t\t\tselectTarget: [1, 2],\r\n\t\t\tmultitarget: true,\r\n\t\t\tmultiline: true,\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tlet { targets } = event;\r\n\t\t\t\tfunction aiChoose(char) {\r\n\t\t\t\t\tlet cards = char.getCards(\"h\");\r\n\t\t\t\t\tif (cards.length < 2) return cards;\r\n\t\t\t\t\tlet sortNumber = cards.sort((a, b) => {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\treturn get.number(b, char) - get.number(a, char);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tlet sortValue = cards.sort((a, b) => {\r\n\t\t\t\t\t\treturn get.value(b, char) - get.value(a, char);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tlet max = sortNumber[0];\r\n\t\t\t\t\tlet min = sortNumber[sortNumber.length - 1];\r\n\t\t\t\t\tif (player.countCards(\"h\", { color: \"red\" }) < 1) {\r\n\t\t\t\t\t\treturn [max, sortValue[sortValue.length - 1]];\r\n\t\t\t\t\t} else if (player.countCards(\"h\", { color: \"black\" }) < 1) {\r\n\t\t\t\t\t\treturn [min, sortValue[sortValue.length - 1]];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (Math.random() > 0.5) {\r\n\t\t\t\t\t\t\tlet black = cards.filter(card => get.color(card) === \"black\" && card !== max);\r\n\t\t\t\t\t\t\treturn [max, black.length > 0 ? black.randomGet() : cards.filter(card => card !== max).randomGet()];\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlet red = cards.filter(card => get.color(card) === \"red\" && card !== min);\r\n\t\t\t\t\t\t\treturn [min, red.length > 0 ? red.randomGet() : cards.filter(card => card !== min).randomGet()];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tlet cardMaps = [];\r\n\t\t\t\tfor (let target of [...targets, player]) {\r\n\t\t\t\t\tlet cardsCompare;\r\n\t\t\t\t\tconst result = await target\r\n\t\t\t\t\t\t.chooseCard(true)\r\n\t\t\t\t\t\t.set(\"prompt\", \"【刈诈】：请选择一张手牌进行拼点\")\r\n\t\t\t\t\t\t.set(\"type\", \"compare\")\r\n\t\t\t\t\t\t.set(\"ai\", card => {\r\n\t\t\t\t\t\t\tlet player = get.player();\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tlet result = get.event().aiChooseResult;\r\n\t\t\t\t\t\t\treturn result[0] === card;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.set(\"aiChooseResult\", aiChoose(target))\r\n\t\t\t\t\t\t.forResult();\r\n\t\t\t\t\tif (!result || !result.cards) return;\r\n\t\t\t\t\tif (result.skill) {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tcardsCompare = lib.skill[result.skill].onCompare(target)[0];\r\n\t\t\t\t\t} else cardsCompare = result.cards[0];\r\n\t\t\t\t\tconst { cards } = await target\r\n\t\t\t\t\t\t.chooseCard(true)\r\n\t\t\t\t\t\t.set(\"type\", \"debate\")\r\n\t\t\t\t\t\t.set(\"source\", player)\r\n\t\t\t\t\t\t.set(\"prompt\", \"【刈诈】：请选择一张手牌进行议事\")\r\n\t\t\t\t\t\t.set(\"filterCard\", (card, player, event) => {\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tlet banCard = get.event().banCard;\r\n\t\t\t\t\t\t\treturn card !== banCard;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.set(\"complexCard\", true)\r\n\t\t\t\t\t\t.set(\"ai\", card => {\r\n\t\t\t\t\t\t\tlet player = get.player();\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\tlet result = get.event().aiChooseResult;\r\n\t\t\t\t\t\t\treturn result[0] === card;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.set(\"aiChooseResult\", aiChoose(target))\r\n\t\t\t\t\t\t.set(\"banCard\", cardsCompare)\r\n\t\t\t\t\t\t.forResult();\r\n\t\t\t\t\tif (!cards) return;\r\n\t\t\t\t\tconst cardsDebate = cards[0];\r\n\r\n\t\t\t\t\tcardMaps.push([target, [cardsCompare, cardsDebate]]);\r\n\t\t\t\t}\r\n\t\t\t\tlet compareMaps = {};\r\n\t\t\t\tlet debateMaps = [];\r\n\t\t\t\tfor (let arr of cardMaps) {\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tcompareMaps[arr[0].playerid] = arr[1][0];\r\n\t\t\t\t\tif (arr[1] && arr[1][1]) debateMaps.push([arr[0], arr[1][1]]);\r\n\t\t\t\t}\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tlet targetCompare = targets.filter(target => Object.keys(compareMaps).includes(target.playerid));\r\n\t\t\t\tlet targetDebate = targets.filter(target => debateMaps.map(arr => arr[0]).includes(target));\r\n\t\t\t\tlet result1 = await player.chooseToCompare(targetCompare).set(\"fixedResult\", compareMaps).forResult();\r\n\t\t\t\tlet result2 = await player\r\n\t\t\t\t\t.chooseToDebate([...targetDebate, player])\r\n\t\t\t\t\t.set(\"fixedResult\", debateMaps)\r\n\t\t\t\t\t.forResult();\r\n\t\t\t\t[...targetDebate, player].forEach(target => target.removeGaintag(\"yizhamrfz_tip2\"));\r\n\t\t\t\tlet compareResult = {\r\n\t\t\t\t\twin: [],\r\n\t\t\t\t\tlose: [],\r\n\t\t\t\t};\r\n\t\t\t\tfor (let i = 0; i < result1.num1.length; i++) {\r\n\t\t\t\t\tif (result1.num1[i] > result1.num2[i]) {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tcompareResult.lose.add(targetCompare[i]);\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tcompareResult.win.add(player);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tcompareResult.lose.add(player);\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tcompareResult.win.add(targetCompare[i]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (result2.opinion === \"black\") {\r\n\t\t\t\t\tfor (let char of compareResult.lose) {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tif (!compareResult.win.includes(char)) await char.damage(player);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (result2.opinion === \"red\") {\r\n\t\t\t\t\tfor (let char of compareResult.win) {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tif (char.countDiscardableCards(player, \"he\"))\r\n\t\t\t\t\t\t\tawait player.discardPlayerCard(char, true, 2, \"he\").set(\"ai\", lib.card.guohe.ai.button);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst { targets: targetsx } = await player\r\n\t\t\t\t\t\t.chooseTarget()\r\n\t\t\t\t\t\t.set(\"prompt\", \"【刈诈】：你可以对任意名角色造成一点伤害\")\r\n\t\t\t\t\t\t.set(\"selectTarget\", [1, Infinity])\r\n\t\t\t\t\t\t.set(\"ai\", target => {\r\n\t\t\t\t\t\t\tlet player = get.player();\r\n\t\t\t\t\t\t\treturn get.damageEffect(target, player, player) > 0;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\t.forResult();\r\n\t\t\t\t\tif (targetsx) {\r\n\t\t\t\t\t\tfor (let char of targetsx) {\r\n\t\t\t\t\t\t\tchar.damage(player);\r\n\t\t\t\t\t\t\tplayer.line(char);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tplayer.draw(2);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\torder: 10,\r\n\t\t\t\tresult: {\r\n\t\t\t\t\tplayer: 1,\r\n\t\t\t\t\ttarget: -1,\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tkumianmrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\ttrigger: { player: \"phaseJieshuEnd\" },\r\n\t\t\tgetNum(player) {\r\n\t\t\t\tlet num = 0;\r\n\t\t\t\tlet cards = [];\r\n\t\t\t\tnum += player.getStat(\"damage\") || 0;\r\n\t\t\t\tfor (let char of game.players) {\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tchar.getHistory(\"lose\", evt => {\r\n\t\t\t\t\t\tif (evt.type === \"discard\" && evt.cards) {\r\n\t\t\t\t\t\t\tlet discards = get.discarded();\r\n\t\t\t\t\t\t\tlet result = evt.cards.filter(card => discards.includes(card));\r\n\t\t\t\t\t\t\tif (result.length > 0) cards.push(...result);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tif (cards.length > 0) num += new Set(cards.map(i => get.type2(i))).size;\r\n\t\t\t\treturn num;\r\n\t\t\t},\r\n\t\t\tfilter(event, player) {\r\n\t\t\t\tlet num = lib.skill.kumianmrfz.getNum(player);\r\n\t\t\t\treturn num > 0;\r\n\t\t\t},\r\n\t\t\tinit(player) {\r\n\t\t\t\tgame.broadcastAll(function () {\r\n\t\t\t\t\tlet skills = [\"new_rejianxiong\", \"shanzhuan\", \"olzaowang\"];\r\n\t\t\t\t\tskills.forEach(skill => {\r\n\t\t\t\t\t\tlet info = get.info(skill);\r\n\t\t\t\t\t\tif (!info.audioname2) info.audioname2 = {};\r\n\t\t\t\t\t\tinfo.audioname2[player.name] = \"kumianmrfz\";\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tderivation: [\"new_rejianxiong\", \"shanzhuan\", \"olzaowang\"],\r\n\t\t\tforced: true,\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tlet num = lib.skill.kumianmrfz.getNum(player);\r\n\t\t\t\tif (num > 0) {\r\n\t\t\t\t\tplayer.draw();\r\n\t\t\t\t}\r\n\t\t\t\tif (num > 1) player.addTempSkill(\"new_rejianxiong\", { player: \"phaseJieshuBegin\" });\r\n\t\t\t\tif (num > 2) player.addTempSkill(\"shanzhuan\", { player: \"phaseJieshuBegin\" });\r\n\t\t\t\tif (num > 3) player.addTempSkill(\"olzaowang\", { player: \"phaseJieshuBegin\" });\r\n\t\t\t},\r\n\t\t},\r\n\r\n\t\t// mon3tr m3\r\n\t\t// 想你了，牢猫\r\n\t\tshulimrfz: {\r\n\t\t\taudio: false,\r\n\t\t\tforced: true,\r\n\t\t\tsilent: true,\r\n\t\t\tmod: {\r\n\t\t\t\tcardUsable(card, player, num) {\r\n\t\t\t\t\tif (player.countCards(\"h\") >= game.roundNumber * 2 && [\"equip\", \"delay\"].includes(get.type(card))) return false;\r\n\t\t\t\t\tif (player.countCards(\"h\") >= game.roundNumber && get.type(card) === \"basic\" && typeof num === \"number\") return (num += 1);\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t\tronghuimrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\tenable: \"phaseUse\",\r\n\t\t\tusable: 1,\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tconst discardPlie = Array.from(ui.discardPile.childNodes);\r\n\t\t\t\tconst cards = player.getCards(\"h\");\r\n\t\t\t\tawait player.lose(cards);\r\n\t\t\t\tawait player.gain(discardPlie, \"gain2\");\r\n\r\n\t\t\t\tplayer.addTempSkill(\"ronghuimrfz_lose\", { player: \"phaseUseEnd\" });\r\n\t\t\t\tplayer\r\n\t\t\t\t\t.when({ player: \"phaseUseEnd\" })\r\n\t\t\t\t\t.step(async (event,trigger,player) =>{})\r\n\t\t\t\t\t.assign({\r\n\t\t\t\t\t\tmod: {\r\n\t\t\t\t\t\t\tcardUsable(card, player, num) {\r\n\t\t\t\t\t\t\t\tif (typeof num === \"number\") return num;\r\n\t\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t});\r\n\t\t\t\tplayer.when({ player: \"phaseDiscardBegin\" }).step(async (event, trigger, player) => {\r\n\t\t\t\t\tconst discardPlie = Array.from(ui.discardPile.childNodes);\r\n\t\t\t\t\tconst cards = player.getCards(\"h\");\r\n\t\t\t\t\tawait player.lose(cards);\r\n\t\t\t\t\tawait player.gain(discardPlie, \"gain2\");\r\n\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\tplayer.logSkill(\"ronghuimrfz\");\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tsubSkill: {\r\n\t\t\t\tlose: {\r\n\t\t\t\t\tsilent: true,\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\tlastDo: true,\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tplayer: \"loseAfter\",\r\n\t\t\t\t\t\tglobal: \"loseAsyncAfter\",\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfilter(event, player) {\r\n\t\t\t\t\t\tif (event.type !== \"use\") return false;\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tlet evt = event.getl(player);\r\n\t\t\t\t\t\treturn evt.cards2 && evt.cards2.some(card => get.position(card) === \"d\" && ![\"equip\", \"delay\"].includes(get.type(card)));\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\tlet cards2 = trigger.getl(player).cards2;\r\n\t\t\t\t\t\tcards2 = cards2.filter(card => get.position(card) === \"d\" && ![\"equip\", \"delay\"].includes(get.type(card)));\r\n\t\t\t\t\t\tfor (let card of cards2) {\r\n\t\t\t\t\t\t\tcard.fix();\r\n\t\t\t\t\t\t\tui.cardPile.appendChild(card);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tgame.log(player, `将`, `#y${get.translation(cards2)}`, `张牌置于了牌堆底`);\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\tai: {\r\n\t\t\t\tthreaten: 1.8,\r\n\t\t\t\torder: 3.4,\r\n\t\t\t\tresult: {\r\n\t\t\t\t\tplayer(player) {\r\n\t\t\t\t\t\tlet transferValue = function (cards) {\r\n\t\t\t\t\t\t\treturn cards.map(card => player.getUseValue(card)).reduce((acc, curr) => acc + curr, 0);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tlet filterCards = function (cards) {\r\n\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\treturn cards.filter(\r\n\t\t\t\t\t\t\t\tcard =>\r\n\t\t\t\t\t\t\t\t\tplayer.getCardUsable2(card) > 0 &&\r\n\t\t\t\t\t\t\t\t\t(get.type(card) === \"basic\" || (get.type(card) !== \"basic\" && player.countUsed(card) < 1))\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tlet cards = filterCards(player.getCards(\"h\"));\r\n\t\t\t\t\t\tlet discardPlie = filterCards(Array.from(ui.discardPile.childNodes));\r\n\t\t\t\t\t\treturn transferValue(cards) > transferValue(discardPlie) ? -1 : 1;\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t},\r\n};\r\n"],"names":["event","player","trigger","target","card","color","skill","skills","hs","moved","cards","i","targets","num","earliest","result","discardPlie"],"mappings":"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"}