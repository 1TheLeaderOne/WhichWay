{"version":3,"file":"especial1SJZX.js","sources":["../../../../../../../../packages/extension/WhichWay/src/character/packs/especial/especial1SJZX.js"],"sourcesContent":["import { lib, game, ui, get, ai, _status } from \"noname\";\r\n\r\n/**\r\n * 二星武将的第一部分\r\n */\r\nconst tmpSave = window.whichWaySave.tmpSave;\r\n\r\n/** @type {WhichWayCharacterPack} */\r\nexport default {\r\n\tcharacter: {\r\n\t},\r\n\tskill: {\r\n\t\t//friston3 弗里斯腾3\r\n\t\tshantanmrfz: {\r\n\t\t\taudio: 2,\r\n\t\t\ttrigger: { global: \"gainAfter\" },\r\n\t\t\tfilter: function (event, player) {\r\n\t\t\t\treturn event.player != player && !player.hasSkill(\"shantanmrfz_ban\");\r\n\t\t\t},\r\n\t\t\tprompt: \"【善谈】:是否摸一张牌？\",\r\n\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\tawait player.draw();\r\n\r\n\t\t\t\tif (player.isMaxHandcard(true)) {\r\n\t\t\t\t\tplayer.addTempSkill(\"shantanmrfz_ban\", { global: \"roundStart\" });\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgroup: \"shantanmrfz_give\",\r\n\t\t\tsubSkill: {\r\n\t\t\t\tgive: {\r\n\t\t\t\t\taudio: \"shantanmrfz\",\r\n\t\t\t\t\ttrigger: {\r\n\t\t\t\t\t\tglobal: [\"loseAfter\", \"loseAsyncAfter\"],\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfilter: function (event, player) {\r\n\t\t\t\t\t\tif (event.type != \"discard\") return false;\r\n\t\t\t\t\t\tif (player.countCards(\"he\") < 1) return false;\r\n\t\t\t\t\t\tif (player.hasSkill(\"shantanmrfz_used\")) return false;\r\n\t\t\t\t\t\treturn game.hasPlayer(current => {\r\n\t\t\t\t\t\t\tif (current == player) return false;\r\n\t\t\t\t\t\t\tvar evt = event.getl(current);\r\n\t\t\t\t\t\t\tif (!evt || !evt.cards2 || evt.cards2.filterInD(\"d\").length < 1) return false;\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcheck: function (event, player) {\r\n\t\t\t\t\t\treturn get.attitude(player, event.player) > 0;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tprompt: function (event, player) {\r\n\t\t\t\t\t\treturn \"【善谈】:你可以弃置一张牌令\" + get.translation(event.player) + \"获得其弃置的牌\";\r\n\t\t\t\t\t},\r\n\t\t\t\t\tasync content(event, trigger, player) {\r\n\t\t\t\t\t\tif (player.countCards(\"he\") <= 0) return;\r\n\t\t\t\t\t\tconst result = await player.chooseToDiscard(true, 1, \"he\", \"【善谈】:请弃置一张牌\").set(\"card\",card=>get.value(card) < 8).forResult();\r\n\r\n\t\t\t\t\t\tif (result.cards) {\r\n\t\t\t\t\t\t\tvar targets = [],\r\n\t\t\t\t\t\t\t\tcardsList = [];\r\n\t\t\t\t\t\t\tvar players = game.filterPlayer().sortBySeat(_status.currentPhase);\r\n\t\t\t\t\t\t\tfor (var current of players) {\r\n\t\t\t\t\t\t\t\tif (current == player) continue;\r\n\t\t\t\t\t\t\t\tvar cards = [];\r\n\t\t\t\t\t\t\t\tvar evt = trigger.getl(current);\r\n\t\t\t\t\t\t\t\tif (!evt || !evt.cards2) continue;\r\n\t\t\t\t\t\t\t\tvar cardsx = evt.cards2.filterInD(\"d\");\r\n\t\t\t\t\t\t\t\tcards.addArray(cardsx);\r\n\t\t\t\t\t\t\t\tif (cards.length) {\r\n\t\t\t\t\t\t\t\t\ttargets.push(current);\r\n\t\t\t\t\t\t\t\t\tcardsList.push(cards);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttargets[0].gain(cardsList[0], \"gain2\");\r\n\t\t\t\t\t\t\tplayer.addTempSkill(\"shantanmrfz_used\", { global: \"phaseEnd\" });\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\tused: {\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t},\r\n\t\t\t\tban: {\r\n\t\t\t\t\tmark: true,\r\n\t\t\t\t\tcharlotte: true,\r\n\t\t\t\t\tintro: {\r\n\t\t\t\t\t\tcontent: \"【善谈①】本轮失效\",\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t},\r\n\t},\r\n};\r\n"],"names":[],"mappings":";AAKgB,OAAO,aAAa;AAGpC,MAAA,gBAAe;AAAA,EACd,WAAW,CACZ;AAAA,EACC,OAAO;AAAA;AAAA,IAEN,aAAa;AAAA,MACZ,OAAO;AAAA,MACP,SAAS,EAAE,QAAQ,YAAW;AAAA,MAC9B,QAAQ,SAAU,OAAO,QAAQ;AAChC,eAAO,MAAM,UAAU,UAAU,CAAC,OAAO,SAAS,iBAAiB;AAAA,MACpE;AAAA,MACA,QAAQ;AAAA,MACR,MAAM,QAAQ,OAAO,SAAS,QAAQ;AACrC,cAAM,OAAO;AAEb,YAAI,OAAO,cAAc,IAAI,GAAG;AAC/B,iBAAO,aAAa,mBAAmB,EAAE,QAAQ,aAAY,CAAE;AAAA,QAChE;AAAA,MACD;AAAA,MACA,OAAO;AAAA,MACP,UAAU;AAAA,QACT,MAAM;AAAA,UACL,OAAO;AAAA,UACP,SAAS;AAAA,YACR,QAAQ,CAAC,aAAa,gBAAgB;AAAA,UAC5C;AAAA,UACK,QAAQ,SAAU,OAAO,QAAQ;AAChC,gBAAI,MAAM,QAAQ,UAAW,QAAO;AACpC,gBAAI,OAAO,WAAW,IAAI,IAAI,EAAG,QAAO;AACxC,gBAAI,OAAO,SAAS,kBAAkB,EAAG,QAAO;AAChD,mBAAO,KAAK,UAAU,aAAW;AAChC,kBAAI,WAAW,OAAQ,QAAO;AAC9B,kBAAI,MAAM,MAAM,KAAK,OAAO;AAC5B,kBAAI,CAAC,OAAO,CAAC,IAAI,UAAU,IAAI,OAAO,UAAU,GAAG,EAAE,SAAS,EAAG,QAAO;AACxE,qBAAO;AAAA,YACR,CAAC;AAAA,UACF;AAAA,UACA,OAAO,SAAU,OAAO,QAAQ;AAC/B,mBAAO,IAAI,SAAS,QAAQ,MAAM,MAAM,IAAI;AAAA,UAC7C;AAAA,UACA,QAAQ,SAAU,OAAO,QAAQ;AAChC,mBAAO,mBAAmB,IAAI,YAAY,MAAM,MAAM,IAAI;AAAA,UAC3D;AAAA,UACA,MAAM,QAAQ,OAAO,SAAS,QAAQ;AACrC,gBAAI,OAAO,WAAW,IAAI,KAAK,EAAG;AAClC,kBAAM,SAAS,MAAM,OAAO,gBAAgB,MAAM,GAAG,MAAM,aAAa,EAAE,IAAI,QAAO,UAAM,IAAI,MAAM,IAAI,IAAI,CAAC,EAAE;AAEhH,gBAAI,OAAO,OAAO;AACjB,kBAAI,UAAU,CAAA,GACb,YAAY,CAAA;AACb,kBAAI,UAAU,KAAK,aAAY,EAAG,WAAW,QAAQ,YAAY;AACjE,uBAAS,WAAW,SAAS;AAC5B,oBAAI,WAAW,OAAQ;AACvB,oBAAI,QAAQ,CAAA;AACZ,oBAAI,MAAM,QAAQ,KAAK,OAAO;AAC9B,oBAAI,CAAC,OAAO,CAAC,IAAI,OAAQ;AACzB,oBAAI,SAAS,IAAI,OAAO,UAAU,GAAG;AACrC,sBAAM,SAAS,MAAM;AACrB,oBAAI,MAAM,QAAQ;AACjB,0BAAQ,KAAK,OAAO;AACpB,4BAAU,KAAK,KAAK;AAAA,gBACrB;AAAA,cACD;AACA,sBAAQ,CAAC,EAAE,KAAK,UAAU,CAAC,GAAG,OAAO;AACrC,qBAAO,aAAa,oBAAoB,EAAE,QAAQ,WAAU,CAAE;AAAA,YAC/D;AAAA,UACD;AAAA,QACL;AAAA,QACI,MAAM;AAAA,UACL,WAAW;AAAA,QAChB;AAAA,QACI,KAAK;AAAA,UACJ,MAAM;AAAA,UACN,WAAW;AAAA,UACX,OAAO;AAAA,YACN,SAAS;AAAA,UACf;AAAA,QACA;AAAA,MACA;AAAA,IACA;AAAA,EACA;AACA;"}