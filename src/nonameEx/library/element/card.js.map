{"version":3,"file":"card.js","sources":["../../../../../../../../packages/extension/WhichWay/src/nonameEx/library/element/card.js"],"sourcesContent":["import { lib, game, ui, get, ai, _status } from \"noname\";\r\n\r\nexport class CardExt extends lib.element.Card {\r\n\tremovePromptSJZX(id){\r\n\t\tlet targets = this.querySelectorAll(\".promptSJZX\");\r\n\t\tif(!targets) return this;\r\n\t\telse if(typeof id !== \"string\") targets.forEach(i=>i.remove());\r\n\t\telse{\r\n\t\t\tfor(let target of targets){\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\tif(target.dataset.promptID === id) target.remove();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\r\n\taddPromptSJZX(str,id){\r\n\t\tlet wrapper = this.querySelector(\".promptSJZX-Wrapper\") || ui.create.div(\".promptSJZX-Wrapper\",this);\r\n\r\n\t\tlet prompts = Array.from(wrapper.querySelectorAll(\".promptSJZX\"));\r\n\r\n\t\tfor(let prompt of prompts){\r\n\t\t\t//@ts-ignore\r\n\t\t\tif(prompt.dataset.promptID === id){\r\n\t\t\t\tprompt.innerHTML = str;\r\n\t\t\t\treturn this;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlet info = ui.create.div(\".promptSJZX\",wrapper);\r\n        info.classList.add(\"promptCardSJZX\");\r\n        info.innerHTML = str;\r\n\t\tinfo.dataset.promptID = id || str;\r\n\t\treturn this;\r\n\t}\r\n\r\n\tisConnect() {\r\n\t\t//@ts-ignore\r\n\t\tgame.broadcastAll(() => {\r\n\t\t\t_status.sxrmConnectCards ??= [];\r\n\t\t});\r\n\t\treturn _status.sxrmConnectCards.includes(this);\r\n\t}\r\n\r\n\taddConnect() {\r\n        if(this.isConnect()) return this;\r\n\t\t//@ts-ignore\r\n\t\tgame.broadcastAll(connect => {\r\n\t\t\tconnect.addGaintag(\"visible_sxrm_connect_tag\");\r\n\t\t\t_status.sxrmConnectCards.add(connect);\r\n\t\t\t//@ts-ignore\r\n\t\t}, this);\r\n        //@ts-ignore\r\n\t\tconst owner = get.owner(this);\r\n\t\t\tif (owner?.isIn()) {\r\n\t\t\t\towner.markSkill(\"_sxrm_connect\");\r\n\t\t\t}\r\n\t\tthis.refreshMark();\r\n\t\treturn this;\r\n\t}\r\n\r\n\tremoveConnect() {\r\n\t\t_status.sxrmConnectCards ??= [];\r\n\t\t_status.sxrmConnectCards.remove(this);\r\n\t\t//@ts-ignore\r\n\t\tgame.broadcast(connectCards => {\r\n\t\t\t_status.sxrmConnectCards = connectCards;\r\n\t\t\t//@ts-ignore\r\n\t\t}, _status.sxrmConnectCards);\r\n\t\t//@ts-ignore\r\n\t\tgame.broadcastAll(card => {\r\n\t\t\tcard.removeGaintag(\"visible_sxrm_connect_tag\");\r\n\t\t\t//@ts-ignore\r\n\t\t}, this);\r\n\t\tthis.refreshMark();\r\n\t\treturn this;\r\n\t}\r\n\r\n\trefreshMark() {\r\n\t\t//@ts-ignore\r\n\t\tgame.filterPlayer(current => {\r\n            //@ts-ignore\r\n\t\t\tif (current.getCards(\"h\",card=>card.isConnect()).length) {\r\n\t\t\t\tcurrent.markSkill(\"_sxrm_connect\");\r\n\t\t\t} else {\r\n\t\t\t\tcurrent.unmarkSkill(\"_sxrm_connect\");\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}"],"names":[],"mappings":";AAEO,MAAM,gBAAgB,IAAI,QAAQ,KAAK;AAAA,EAC7C,iBAAiB,IAAG;AACnB,QAAI,UAAU,KAAK,iBAAiB,aAAa;AACjD,QAAG,CAAC,QAAS,QAAO;AAAA,aACZ,OAAO,OAAO,SAAU,SAAQ,QAAQ,OAAG,EAAE,OAAM,CAAE;AAAA,SACzD;AACH,eAAQ,UAAU,SAAQ;AAEzB,YAAG,OAAO,QAAQ,aAAa,GAAI,QAAO;MAC3C;AAAA,IACD;AACA,WAAO;AAAA,EACR;AAAA,EAEA,cAAc,KAAI,IAAG;AACpB,QAAI,UAAU,KAAK,cAAc,qBAAqB,KAAK,GAAG,OAAO,IAAI,uBAAsB,IAAI;AAEnG,QAAI,UAAU,MAAM,KAAK,QAAQ,iBAAiB,aAAa,CAAC;AAEhE,aAAQ,UAAU,SAAQ;AAEzB,UAAG,OAAO,QAAQ,aAAa,IAAG;AACjC,eAAO,YAAY;AACnB,eAAO;AAAA,MACR;AAAA,IACD;AAEA,QAAI,OAAO,GAAG,OAAO,IAAI,eAAc,OAAO;AACxC,SAAK,UAAU,IAAI,gBAAgB;AACnC,SAAK,YAAY;AACvB,SAAK,QAAQ,WAAW,MAAM;AAC9B,WAAO;AAAA,EACR;AAAA,EAEA,YAAY;AAEX,SAAK,aAAa,MAAM;AACvB,cAAQ,qBAAqB;IAC9B,CAAC;AACD,WAAO,QAAQ,iBAAiB,SAAS,IAAI;AAAA,EAC9C;AAAA,EAEA,aAAa;AACN,QAAG,KAAK,YAAa,QAAO;AAElC,SAAK,aAAa,aAAW;AAC5B,cAAQ,WAAW,0BAA0B;AAC7C,cAAQ,iBAAiB,IAAI,OAAO;AAAA,IAErC,GAAG,IAAI;AAEP,UAAM,QAAQ,IAAI,MAAM,IAAI;AAC3B,QAAI,OAAO,QAAQ;AAClB,YAAM,UAAU,eAAe;AAAA,IAChC;AACD,SAAK,YAAW;AAChB,WAAO;AAAA,EACR;AAAA,EAEA,gBAAgB;AACf,YAAQ,qBAAqB;AAC7B,YAAQ,iBAAiB,OAAO,IAAI;AAEpC,SAAK,UAAU,kBAAgB;AAC9B,cAAQ,mBAAmB;AAAA,IAE5B,GAAG,QAAQ,gBAAgB;AAE3B,SAAK,aAAa,UAAQ;AACzB,WAAK,cAAc,0BAA0B;AAAA,IAE9C,GAAG,IAAI;AACP,SAAK,YAAW;AAChB,WAAO;AAAA,EACR;AAAA,EAEA,cAAc;AAEb,SAAK,aAAa,aAAW;AAE5B,UAAI,QAAQ,SAAS,KAAI,UAAM,KAAK,UAAS,CAAE,EAAE,QAAQ;AACxD,gBAAQ,UAAU,eAAe;AAAA,MAClC,OAAO;AACN,gBAAQ,YAAY,eAAe;AAAA,MACpC;AAAA,IACD,CAAC;AAAA,EACF;AACD;"}