{"version":3,"file":"content.js","sources":["../../../../../../../../packages/extension/WhichWay/src/nonameEx/library/element/content.js"],"sourcesContent":["import { lib, game, ui, get, ai, _status } from \"noname\";\r\n\r\nexport const ContentExt = {\r\n\tchooseCardHand: [\r\n\t\t/**@type {ContentFuncByAll} */\r\n\t\tasync function (event, trigger, player) {\r\n\t\t\tif (event.directresult) {\r\n\t\t\t\tevent.result = {\r\n\t\t\t\t\tbuttons: [],\r\n\t\t\t\t\tcards: event.directresult.slice(0),\r\n\t\t\t\t\ttargets: [],\r\n\t\t\t\t\tconfirm: \"ok\",\r\n\t\t\t\t\tbool: true,\r\n\t\t\t\t\tlinks: [],\r\n\t\t\t\t};\r\n\t\t\t} else if (event.autochoose()) {\r\n\t\t\t\tevent.result = {\r\n\t\t\t\t\tbool: true,\r\n\t\t\t\t\tautochoose: true,\r\n\t\t\t\t\tcards: player.getCards(event.position),\r\n\t\t\t\t\tconfirm: \"ok\",\r\n\t\t\t\t\tbuttons: [],\r\n\t\t\t\t\ttargets: [],\r\n\t\t\t\t\tlinks: [],\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\tif (event.cards) {\r\n\t\t\t\t\tplayer.directgain(event.cards);\r\n                    const copy = event.filterCard;\r\n                    event.filterCard = function(card,player,target){\r\n                        return event.cards.includes(card) && copy.apply(this,arguments);\r\n                    }\r\n\t\t\t\t}\r\n\t\t\t\tif (event.isMine()) {\r\n\t\t\t\t\tgame.check();\r\n\t\t\t\t\tgame.pause();\r\n\t\t\t\t\tif (event.hsskill && !event.forced && _status.prehidden_skills.includes(event.hsskill)) {\r\n\t\t\t\t\t\tui.click.cancel();\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tui.create.cardChooseAll();\r\n\t\t\t\t\tif (event.prompt != false) {\r\n\t\t\t\t\t\tvar str;\r\n\t\t\t\t\t\tif (typeof event.prompt == \"string\") {\r\n\t\t\t\t\t\t\tstr = event.prompt;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tstr = \"请选择\";\r\n\t\t\t\t\t\t\tvar range = get.select(event.selectCard);\r\n\t\t\t\t\t\t\tif (range[0] == range[1]) {\r\n\t\t\t\t\t\t\t\tstr += get.cnNumber(range[0]);\r\n\t\t\t\t\t\t\t} else if (range[1] == Infinity) {\r\n\t\t\t\t\t\t\t\tstr += \"至少\" + get.cnNumber(range[0]);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tstr += get.cnNumber(range[0]) + \"至\" + get.cnNumber(range[1]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tstr += \"张\";\r\n\t\t\t\t\t\t\tif (event.position == \"h\" || event.position == undefined) {\r\n\t\t\t\t\t\t\t\tstr += \"手\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (event.position == \"e\") {\r\n\t\t\t\t\t\t\t\tstr += \"装备\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tstr += \"牌\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tevent.dialog = ui.create.dialog(str);\r\n\t\t\t\t\t\tif (event.prompt2) {\r\n\t\t\t\t\t\t\tevent.dialog.addText(event.prompt2, event.prompt2.length <= 20);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (Array.isArray(event.promptx)) {\r\n\t\t\t\t\t\t\tfor (var i = 0; i < event.promptx.length; i++) {\r\n\t\t\t\t\t\t\t\tevent.dialog.add(event.promptx[i]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (Array.isArray(event.selectCard)) {\r\n\t\t\t\t\t\t\tevent.promptbar = event.dialog.add(\"0/\" + get.numStr(event.selectCard[1], \"card\"));\r\n\t\t\t\t\t\t\tevent.custom.add.card = function () {\r\n\t\t\t\t\t\t\t\t//@ts-ignore\r\n\t\t\t\t\t\t\t\t_status.event.promptbar.innerHTML = ui.selected.cards.length + \"/\" + get.numStr(_status.event.selectCard[1], \"card\");\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (event.isOnline()) event.send();\r\n\t\t\t\t//@ts-ignore\r\n\t\t\t\telse event.result = \"ai\";\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync function (event, trigger, player) {\r\n\t\t\tif (event.result == \"ai\") {\r\n\t\t\t\tgame.check();\r\n\t\t\t\tif ((ai.basic.chooseCard(event.ai) || event.forced) && (!event.filterOk || event.filterOk())) {\r\n\t\t\t\t\tui.click.ok();\r\n\t\t\t\t} else if (event.skill) {\r\n\t\t\t\t\tvar skill = event.skill;\r\n\t\t\t\t\tui.click.cancel();\r\n\t\t\t\t\tevent._aiexclude.add(skill);\r\n\t\t\t\t\tevent.redo();\r\n\t\t\t\t\tgame.resume();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tui.click.cancel();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**@type {ContentFuncByAll} */\r\n\t\tasync function (event, trigger, player) {\r\n\t\t\tevent.resume();\r\n\t\t\tevent.cards.forEach(card => card.delete());\r\n\t\t\tif (event.cardChooseAll) {\r\n\t\t\t\tevent.cardChooseAll.close();\r\n\t\t\t}\r\n\t\t\tif (event.glow_result && event.result.cards && !event.directresult) {\r\n\t\t\t\tfor (var i = 0; i < event.result.cards.length; i++) {\r\n\t\t\t\t\tevent.result.cards[i].classList.add(\"glow\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (event.dialog) {\r\n\t\t\t\tevent.dialog.close();\r\n\t\t\t}\r\n\t\t},\r\n\t],\r\n};"],"names":["player"],"mappings":"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"}