{"version":3,"file":"utill.js","sources":["../../../../../packages/extension/WhichWay/src/utill.js"],"sourcesContent":["import { lib, game, ui, get, ai, _status } from \"noname\";\r\nimport { onSetDev, onExtension, whichWayHooksApi } from \"./hooks/index.js\";\r\n\r\nclass WhichWayUtil {\r\n\t/**\r\n\t * 获取随机数\r\n\t * @param {number} [length = 16] 随机数长度\r\n\t * @returns {string} 随机数字符串\r\n\t */\r\n\tgetRandomNumber(length = 16) {\r\n\t\tif (length <= 0) {\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\t\tconst digits = \"0123456789\";\r\n\t\tlet result = \"\";\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tconst randomIndex = Math.floor(Math.random() * digits.length);\r\n\t\t\tresult += digits[randomIndex];\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\t/**\r\n\t * 获取配置项\r\n\t * @param {string} key 配置项名称\r\n\t * @param {string} [ext=\"WhichWay\"] 扩展名称\r\n\t * @returns {any} 配置项值\r\n\t */\r\n\tconfig(key, ext = \"WhichWay\") {\r\n\t\treturn lib.config[`extension_${ext}_${key}`];\r\n\t}\r\n\r\n\t/**\r\n\t * 设置全局 CSS 变量的值。\r\n\t *\r\n\t * 此函数允许动态地修改文档根元素（`:root`）上的 CSS 变量，可用于实现主题切换、动态样式调整等功能。\r\n\t *\r\n\t * @param {string} name - 要设置的 CSS 变量名称（例如 `--main-color`）。\r\n\t * @param {string | number} value - 要赋予该 CSS 变量的值。可以是字符串形式的颜色、尺寸等，也可以是数字（会被自动转为字符串）。\r\n\t * @returns {undefined}\r\n\t */\r\n\tsetCSSVariable(name, value) {\r\n\t\tdocument.documentElement.style.setProperty(name, String(value));\r\n\t}\r\n\r\n\t/**\r\n\t * 将两个数值调整为符合指定比例的关系，并可选地设置最小值限制\r\n\t *\r\n\t * 该函数接收两个数值 a 和 b，以及一个目标比例字符串（如 \"16:9\"），\r\n\t * 并返回一个数组，包含调整后的两个数值，使它们符合指定的比例关系。\r\n\t * 调整原则是保持其中一个数值不变，调整另一个数值以满足比例。\r\n\t * 可以通过 minValues 参数设置返回值的最小限制。\r\n\t *\r\n\t * @param {number|string} a - 第一个数值或可转换为数值的字符串\r\n\t * @param {number|string} b - 第二个数值或可转换为数值的字符串\r\n\t * @param {string} [ratioString=\"16:9\"] - 目标比例字符串，格式为 \"A:B\"，其中 A 和 B 为正数\r\n\t * @param {number|number[]|string} [minValues] - 最小值限制：\r\n\t *   - 如果是数字，则同时限制 a 和 b 的最小值\r\n\t *   - 如果是数组 [minA, minB]，则分别限制 a 和 b 的最小值\r\n\t *   - 如果是字符串 \"minA|minB\" 格式，则分别解析为 a 和 b 的最小值\r\n\t * @returns {number[]} 包含两个调整后数值的数组 [adjustedA, adjustedB]\r\n\t * @throws {Error} 如果比例字符串格式不正确、输入值不是有效数字或 minValues 格式不正确时抛出错误\r\n\t */\r\n\tadjustToRatio(a, b, ratioString, minValues) {\r\n\t\tconst ratioStr = ratioString || \"16:9\";\r\n\r\n\t\t// 解析比例 A:B\r\n\t\tconst ratioMatch = ratioStr.trim().match(/^(\\d+(\\.\\d+)?):(\\d+(\\.\\d+)?)$/);\r\n\t\tif (!ratioMatch) {\r\n\t\t\tthrow new Error('Ratio must be in the format \"A:B\", where A and B are positive numbers (e.g., \"16:9\").');\r\n\t\t}\r\n\r\n\t\tconst A = parseFloat(ratioMatch[1]);\r\n\t\tconst B = parseFloat(ratioMatch[3]);\r\n\r\n\t\tif (isNaN(A) || isNaN(B) || A <= 0 || B <= 0) {\r\n\t\t\tthrow new Error(\"Ratio values must be positive numbers.\");\r\n\t\t}\r\n\r\n\t\tconst targetRatio = A / B; // 要求 a / b = A / B\r\n\r\n\t\t// 工具函数：判断是否为全数字字符串\r\n\t\tfunction isNumericString(str) {\r\n\t\t\treturn typeof str === \"string\" && /^-?\\d+(\\.\\d+)?$/.test(str.trim());\r\n\t\t}\r\n\r\n\t\t// 转换输入为数字\r\n\t\tlet numA = typeof a === \"string\" && isNumericString(a) ? Number(a) : a;\r\n\t\tlet numB = typeof b === \"string\" && isNumericString(b) ? Number(b) : b;\r\n\r\n\t\tif (typeof numA !== \"number\" || isNaN(numA) || typeof numB !== \"number\" || isNaN(numB)) {\r\n\t\t\tthrow new Error(\"Both inputs must be numbers or numeric strings.\");\r\n\t\t}\r\n\r\n\t\t// 解析 minValues → 得到 minA 和 minB\r\n\t\tlet minA = -Infinity;\r\n\t\tlet minB = -Infinity;\r\n\r\n\t\tif (minValues !== undefined) {\r\n\t\t\tif (typeof minValues === \"number\" && !isNaN(minValues)) {\r\n\t\t\t\tminA = minB = minValues;\r\n\t\t\t} else if (Array.isArray(minValues)) {\r\n\t\t\t\tif (minValues.length >= 1 && typeof minValues[0] === \"number\" && !isNaN(minValues[0])) {\r\n\t\t\t\t\tminA = minValues[0];\r\n\t\t\t\t\tminB = minValues.length >= 2 && typeof minValues[1] === \"number\" && !isNaN(minValues[1]) ? minValues[1] : minValues[0];\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow new Error(\"minValues array must contain valid numbers.\");\r\n\t\t\t\t}\r\n\t\t\t} else if (typeof minValues === \"string\") {\r\n\t\t\t\tconst parts = minValues\r\n\t\t\t\t\t.trim()\r\n\t\t\t\t\t.split(\"|\")\r\n\t\t\t\t\t.map(s => s.trim());\r\n\t\t\t\tconst nums = parts.map(s => (isNumericString(s) ? Number(s) : NaN));\r\n\t\t\t\tif (nums.every(n => !isNaN(n))) {\r\n\t\t\t\t\tif (nums.length === 1) {\r\n\t\t\t\t\t\tminA = minB = nums[0];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tminA = nums[0];\r\n\t\t\t\t\t\tminB = nums[1];\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow new Error('minValues string must be in the format \"minA|minB\" or \"value\", with numeric values.');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error('minValues must be a number, an array [a, b], or a string \"a|b\".');\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// ✅ 第一步：先对输入应用最小值限制（clamp）\r\n\t\tconst clampedA = Math.max(numA, minA);\r\n\t\tconst clampedB = Math.max(numB, minB);\r\n\r\n\t\t// ✅ 第二步：使用 clampedA 和 clampedB 来进行比例调整\r\n\t\tconst currentRatio = clampedA / clampedB;\r\n\t\tconst tolerance = 1e-6;\r\n\r\n\t\tlet resultA, resultB;\r\n\r\n\t\tif (Math.abs(currentRatio - targetRatio) < tolerance) {\r\n\t\t\tresultA = clampedA;\r\n\t\t\tresultB = clampedB;\r\n\t\t} else if (currentRatio > targetRatio) {\r\n\t\t\t// 太宽了（或太矮了）→ 增加 height 才能降低 ratio\r\n\t\t\tresultA = clampedA;\r\n\t\t\tresultB = clampedA / targetRatio; // 因为 a/b = targetRatio → b = a/targetRatio\r\n\t\t} else {\r\n\t\t\t// 太窄了（或太高了）→ 增加 width\r\n\t\t\tresultA = clampedB * targetRatio; // a = b * targetRatio\r\n\t\t\tresultB = clampedB;\r\n\t\t}\r\n\r\n\t\treturn [resultA, resultB];\r\n\t}\r\n\r\n\t/**\r\n\t * 将一个正数数组转换为保持比例的整数数组。\r\n\t *\r\n\t * 该函数首先将数组中的数值统一放大，使其全部变为整数（根据小数点后的最大位数进行放大），\r\n\t * 然后通过计算最大公约数（GCD），将所有数缩小到最简整数比例。\r\n\t *\r\n\t * @param {number[]} arr - 需要转换的正数数组，数组中的所有值必须大于 0。\r\n\t * @returns {number[]} 返回一个整数数组，表示与原数组保持比例的最简整数比。\r\n\t *\r\n\t * @throws {Error} 如果输入不是一个数组，或者数组中包含非正数（包括 0 或负数），则抛出错误。\r\n\t */\r\n\tscaleToIntegerRatio(arr) {\r\n\t\tif (!Array.isArray(arr) || arr.some(x => x <= 0)) {\r\n\t\t\tthrow new Error(\"数组必须只包含正数\");\r\n\t\t}\r\n\r\n\t\tconst maxDecimalPlaces = Math.max(\r\n\t\t\t...arr.map(x => {\r\n\t\t\t\tconst parts = x.toString().split(\".\");\r\n\t\t\t\treturn parts.length > 1 ? parts[1].length : 0;\r\n\t\t\t})\r\n\t\t);\r\n\r\n\t\tconst factor = Math.pow(10, maxDecimalPlaces);\r\n\t\tlet intArr = arr.map(x => Math.round(x * factor));\r\n\r\n\t\tconst gcd = (a, b) => {\r\n\t\t\twhile (b !== 0) {\r\n\t\t\t\tlet temp = b;\r\n\t\t\t\tb = a % b;\r\n\t\t\t\ta = temp;\r\n\t\t\t}\r\n\t\t\treturn a;\r\n\t\t};\r\n\r\n\t\tconst overallGcd = intArr.reduce((acc, val) => gcd(acc, val), intArr[0]);\r\n\r\n\t\treturn intArr.map(x => x / overallGcd);\r\n\t}\r\n\r\n\t/**\r\n\t * 将字符串中的颜色代码转为 HTML 标签，并用 `<span>` 包裹。\r\n\t * @param {string} str - 要处理的字符串\r\n\t * @returns {string} 处理后的字符串\r\n\t */\r\n\tcolorize = function (str) {\r\n\t\tconst colorMap = {\r\n\t\t\tr: \"red\",\r\n\t\t\tg: \"green\",\r\n\t\t\tb: \"blue\",\r\n\t\t\ty: \"yellow\",\r\n\t\t\tp: \"purple\",\r\n\t\t\to: \"orange\",\r\n\t\t\ts: \"#696969\",\r\n\t\t};\r\n\t\treturn str.replace(/#([a-zA-Z])([^#]*)#/g, (match, letter, content) => {\r\n\t\t\tconst color = colorMap[letter.toLowerCase()];\r\n\t\t\tif (color) {\r\n\t\t\t\treturn `<span style=\"color: ${color};\">${content}</span>`;\r\n\t\t\t} else {\r\n\t\t\t\treturn content;\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\t/**\r\n\t * 切换背景\r\n\t */\r\n\tsetBgI() {\r\n\t\tif (lib.config.ChangeBgI_mrfz) var bgI = lib.config.ChangeBgI_mrfz;\r\n\t\tif (bgI && typeof bgI === \"string\" && bgI != \"default\") {\r\n\t\t\t/**@ts-ignore */\r\n\t\t\tui.background.setBackgroundImage(window.whichWay.file.compilePath(\"img:background/\") + bgI + \".jpg\");\r\n\t\t} else {\r\n\t\t\t/**@ts-ignore */\r\n\t\t\tui.background.setBackgroundImage(\"image/background/\" + lib.config.image_background + \".jpg\");\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 在两个平行数组之间进行双向查找\r\n\t * @param {Array} arr1 - 第一个数组（如 index / whichWay）\r\n\t * @param {Array} arr2 - 第二个数组（如 name / arknight）\r\n\t * @param {string} query - 要查找的字符串\r\n\t * @returns {*} 找到的对应值，否则 undefined\r\n\t */\r\n\tbidirectionalLookup(arr1, arr2, query) {\r\n\t\tconst i = arr1.indexOf(query);\r\n\t\tif (i !== -1) return arr2[i];\r\n\t\tconst j = arr2.indexOf(query);\r\n\t\tif (j !== -1) return arr1[j];\r\n\t\treturn undefined;\r\n\t}\r\n\r\n\t/**\r\n\t * 获取角色的WhichWay配置\r\n\t * @param {string | Player} name 角色名或角色对象\r\n\t * @returns {WhichWayCharConfig | undefined} 角色的WhichWay配置\r\n\t */\r\n\tgetCharExtConfig(name) {\r\n\t\tconst char = typeof name === \"string\" ? get.character(name) : get.character(name.name);\r\n\t\tif (!char || !char.whichWay) return;\r\n\t\treturn char.whichWay;\r\n\t}\r\n\r\n\t/**\r\n\t * 在指定 DOM 元素上切换类名：如果包含 classA，则替换为 classB；如果包含 classB，则替换为 classA。\r\n\t *\r\n\t * @param {Element|Array<Element>} element - 要操作的 DOM 元素，或元素组成的数组\r\n\t * @param {string} classA - 第一个类名（原始类）\r\n\t * @param {string} classB - 第二个类名（目标类）\r\n\t *\r\n\t * @example\r\n\t * toggleClassBetween(element, 'active', 'inactive');\r\n\t */\r\n\ttoggleClass(element, classA, classB) {\r\n\t\tif (!element) throw new Error(\"element is null\");\r\n\r\n\t\tconst toggle = ele => {\r\n\t\t\tif (!ele.classList) return;\r\n\r\n\t\t\tconst hasA = ele.classList.contains(classA);\r\n\t\t\tconst hasB = ele.classList.contains(classB);\r\n\r\n\t\t\tif (hasA) {\r\n\t\t\t\tele.classList.remove(classA);\r\n\t\t\t\tele.classList.add(classB);\r\n\t\t\t} else if (hasB) {\r\n\t\t\t\tele.classList.remove(classB);\r\n\t\t\t\tele.classList.add(classA);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif (Array.isArray(element)) {\r\n\t\t\telement.forEach(ele => toggle(ele));\r\n\t\t} else {\r\n\t\t\ttoggle(element);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 保存配置项\r\n\t * @param {string} key 配置项名称\r\n\t * @param {any} value 配置项值\r\n\t * @param {string | null} [ext=\"WhichWay\"] 扩展名称,不想保存为扩展配置项时传入空字符串或非字符串\r\n\t */\r\n\tsaveConfig(key, value, ext = \"WhichWay\") {\r\n\t\tif (typeof ext === \"string\" && ext.length > 0) {\r\n\t\t\tlib.config[`extension_${ext}_${key}`] = value;\r\n\t\t\tgame.saveExtensionConfig(ext, key, value);\r\n\t\t} else {\r\n\t\t\tlib.config[key] = value;\r\n\t\t\tgame.saveConfig(key, value);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 关闭扩展\r\n\t * @param {string} [ext=\"WhichWay\"] 扩展名称,不填则关闭驶舰之向扩展\r\n\t */\r\n\tdisableExtension(ext = \"WhichWay\") {\r\n\t\tlib.config[`extension_${ext}_enable`] = false;\r\n\t\tthis.saveConfig(\"enable\", false, ext);\r\n\t}\r\n\r\n\t/**\r\n\t * 是否是开发者模式,如果是viteSever,则默认是开发者模式\r\n\t * @returns {boolean}\r\n\t */\r\n\tisDeveloperMode() {\r\n\t\tif (this.config(\"devMode\") !== true && this.isViteDevServer() && window.whichWaySave.autoEnableDevTip === false) {\r\n\t\t\tconsole.log(\"[WhichWayUtil] 由于是在viteSever环境下,开发者模式已自动开启\");\r\n\t\t\twindow.whichWaySave.autoEnableDevTip = true;\r\n\t\t}\r\n\t\treturn this.config(\"devMode\") || this.isViteDevServer();\r\n\t}\r\n\r\n\t/**\r\n\t * 是否是ViteServer开发环境\r\n\t * @returns {boolean}\r\n\t */\r\n\tisViteDevServer = () => document.querySelectorAll('script[type=\"module\"][src*=\"/@vite/\"]').length > 0;\r\n\r\n\t/**\r\n\t * 开启开发者模式相关设置,默认会自动检查是否开启了开发者模式,如果没开启则不会生效\r\n\t * @param {boolean} [forceEnable=false] 是否强制配置开发者模式设置\r\n\t *\r\n\t */\r\n\tasync developerSet(forceEnable = false) {\r\n\t\tif (!this.isDeveloperMode() && !forceEnable) return;\r\n\t\t//@ts-ignore\r\n\t\twindow.noname_shijianInterfaces?.showDebugButton?.();\r\n\t\tlib.cheat.i();\r\n\r\n\t\t//暴露被注册过的变量\r\n\t\tawait whichWayHooksApi.setDev();\r\n\t}\r\n\r\n\t/**\r\n\t * 执行一个函数并测量其加载/执行时间\r\n\t * @param {Function} fn - 要执行的函数（推荐使用箭头函数以避免 this 问题）\r\n\t * @param {boolean} [logTime=false] - 是否在控制台打印执行时间\r\n\t * @returns {Promise<{result: any, duration: number}>}\r\n\t */\r\n\tasync measureExecutionTime(fn, logTime = false) {\r\n\t\tif (typeof fn !== \"function\") {\r\n\t\t\tthrow new TypeError(\"First argument must be a function.\");\r\n\t\t}\r\n\r\n\t\tif (this.isDeveloperMode()) {\r\n\t\t\ttry {\r\n\t\t\t\tconst fnStr = Function.prototype.toString.call(fn).trim();\r\n\t\t\t\tif (fnStr.startsWith(\"function\") || fnStr.startsWith(\"async function\")) {\r\n\t\t\t\t\tconsole.warn(\"[measureExecutionTime] Detected a regular function. \" + \"Consider using an arrow function to avoid unexpected `this` binding.\");\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {}\r\n\t\t}\r\n\r\n\t\tconst start = Date.now();\r\n\t\tconst result = await fn();\r\n\t\tconst end = Date.now();\r\n\t\tconst duration = end - start;\r\n\r\n\t\tif (logTime) {\r\n\t\t\tconsole.log(`Function executed in ${duration} ms`);\r\n\t\t}\r\n\r\n\t\treturn { result, duration };\r\n\t}\r\n}\r\n\r\nexport const whichWayUtil = new WhichWayUtil();\r\n\r\nonSetDev({\r\n\tname: \"WhichWayUtil_dev\",\r\n\tfn: () => {\r\n\t\t//@ts-ignore\r\n\t\twindow.whichWayUtil = whichWayUtil;\r\n\t},\r\n\tpriority: 10000,\r\n});\r\n\r\n//由于util加载顺序问题,需要推迟再注册到全局对象\r\nonExtension({\r\n\tname: \"whichWayUtil_register\",\r\n\tfn: () => {\r\n\t\twindow.whichWay.register(\"util\", whichWayUtil);\r\n\t},\r\n});\r\n"],"names":[],"mappings":"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"}