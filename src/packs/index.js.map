{"version":3,"file":"index.js","sources":["../../../../../../packages/extension/WhichWay/src/packs/index.ts"],"sourcesContent":["import { lib, game, ui, get, ai, _status } from \"noname\";\r\nimport { whichWayFile } from \"../file.js\";\r\nimport { onContent, onSetDev } from \"../hooks/index.js\";\r\nimport { pendingRun } from \"./hooks.js\";\r\n\r\ndeclare type characterSort = [\r\n    \"epicSJZX\",\r\n    \"legendSJZX\",\r\n    \"especialSJZX\",\r\n    \"plotSJZX\",\r\n    \"specialSJZX\",\r\n    \"rareSJZX\",\r\n    \"mediocreSJZX\",\r\n    \"normalSJZX\"\r\n];\r\n\r\nclass WhichWayPackManager {\r\n    /**\r\n     * 初始化\r\n     */\r\n    async init(){\r\n        this.pendingRun = pendingRun;\r\n        //读取character和card的内容\r\n        await this.initCharacterPack();\r\n\r\n        // const cardPack = await whichWayFile.getFileTree(\"src:packs/card\");\r\n\r\n        onContent({\r\n            name:\"whichWayPackManager_init\",\r\n            fn:async () => {\r\n                for(const fn of this.pendingRun){\r\n                    await fn();\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    async initCharacterPack(){\r\n        const { files , folders } = await whichWayFile.getFileTree(\"src:packs/character\");\r\n        for(const file of files){\r\n            const name = whichWayFile.removeExt(file.name);\r\n            if(!name.endsWith(\"mrfz\")) continue;\r\n            await import(`./character/${name}.js`);\r\n        }\r\n\r\n        for(const folder of folders){\r\n            if(!folder.name.endsWith(\"mrfz\")) continue;\r\n            for(const file of folder.files){\r\n                if(file.name === \"index.js\"){\r\n                    await import(`./character/${folder.name}/index.js`);\r\n                } else if(file.name === \"index.ts\"){\r\n                    await import(`./character/${folder.name}/index.ts`);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    pendingRun:Function[] = [];\r\n}\r\n\r\nexport const whichWayPackManager = new WhichWayPackManager();\r\n\r\nwhichWayPackManager.init();\r\n\r\nwindow.whichWay.register(\"packManager\", whichWayPackManager);\r\n\r\nonSetDev({\r\n    name: \"whichWayPackManager_Dev\",\r\n    fn: () => {\r\n        //@ts-ignore\r\n        window.whichWayPackManager = whichWayPackManager;\r\n    }\r\n})"],"names":[],"mappings":";;;;AAgBA,MAAM,oBAAoB;AAAA;AAAA;AAAA;AAAA,EAItB,MAAM,OAAM;AACR,SAAK,aAAa;AAElB,UAAM,KAAK,kBAAA;AAIX,cAAU;AAAA,MACN,MAAK;AAAA,MACL,IAAG,YAAY;AACX,mBAAU,MAAM,KAAK,YAAW;AAC5B,gBAAM,GAAA;AAAA,QACV;AAAA,MACJ;AAAA,IAAA,CACH;AAAA,EACL;AAAA,EAEA,MAAM,oBAAmB;AACrB,UAAM,EAAE,OAAQ,QAAA,IAAY,MAAM,aAAa,YAAY,qBAAqB;AAChF,eAAU,QAAQ,OAAM;AACpB,YAAM,OAAO,aAAa,UAAU,KAAK,IAAI;AAC7C,UAAG,CAAC,KAAK,SAAS,MAAM,EAAG;AAC3B,YAAM,qCAAA,uBAAA,OAAA,CAAA,CAAA,GAAA,eAAA,IAAA,OAAA,CAAA;AAAA,IACV;AAEA,eAAU,UAAU,SAAQ;AACxB,UAAG,CAAC,OAAO,KAAK,SAAS,MAAM,EAAG;AAClC,iBAAU,QAAQ,OAAO,OAAM;AAC3B,YAAG,KAAK,SAAS,YAAW;AACxB,gBAAM,qCAAA,uBAAA,OAAA,EAAA,iCAAA,MAAA,OAAA,+BAAA,EAAA,CAAA,GAAA,eAAA,OAAA,IAAA,aAAA,CAAA;AAAA,QACV,WAAU,KAAK,SAAS,YAAW;AAC/B,gBAAM,qCAAA,uBAAA,OAAA,EAAA,GAAA,eAAA,OAAA,IAAA,aAAA,CAAA;AAAA,QACV;AAAA,MACJ;AAAA,IACJ;AAAA,EACJ;AAAA,EAEA,aAAwB,CAAA;AAC5B;AAEO,MAAM,sBAAsB,IAAI,oBAAA;AAEvC,oBAAoB,KAAA;AAEpB,OAAO,SAAS,SAAS,eAAe,mBAAmB;AAE3D,SAAS;AAAA,EACL,MAAM;AAAA,EACN,IAAI,MAAM;AAEN,WAAO,sBAAsB;AAAA,EACjC;AACJ,CAAC;"}